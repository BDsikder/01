<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BISNU IoT ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --light-color: #ecf0f1;
      --dark-color: #2c3e50;
      --success-color: #2ecc71;
      --warning-color: #f39c12;
      --info-color: #1abc9c;
      --energy-color: #9b59b6;
      --voltage-color: #e67e22;
      --current-color: #1abc9c;
      --power-color: #3498db;
      --background-image: url('https://images.unsplash.com/photo-1518770660439-4636190af475?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
      --card-bg: rgba(44, 62, 80, 0.8);
      --text-color: #ecf0f1;
      --nav-bg: rgba(44, 62, 80, 0.8);
      --login-bg: rgba(44, 62, 80, 0.9);
    }

    .light-theme {
      --primary-color: #3498db;
      --secondary-color: #2980b9;
      --accent-color: #e74c3c;
      --light-color: #f5f5f5;
      --dark-color: #ffffff;
      --success-color: #27ae60;
      --warning-color: #f39c12;
      --info-color: #16a085;
      --energy-color: #8e44ad;
      --voltage-color: #d35400;
      --current-color: #16a085;
      --power-color: #2980b9;
      --background-image: url('https://images.unsplash.com/photo-1508514177221-188b1cf16e9d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1352&q=80');
      --card-bg: rgba(255, 255, 255, 0.9);
      --text-color: #2c3e50;
      --nav-bg: rgba(255, 255, 255, 0.9);
      --login-bg: rgba(255, 255, 255, 0.95);
    }
    
    body {
      font-family: 'Titillium Web', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--background-image) no-repeat center center fixed;
      background-size: cover;
      color: var(--text-color);
      transition: all 0.5s ease;
    }
    
    /* ‡¶≤‡¶ï ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .login-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, rgba(44, 62, 80, 0.95) 0%, rgba(52, 152, 219, 0.9) 100%);
      backdrop-filter: blur(10px);
      z-index: 1000;
      flex-direction: column;
      overflow: hidden;
    }
    
    .login-particles {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    
    .particle {
      position: absolute;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 50%;
      animation: float 15s infinite linear;
    }
    
    @keyframes float {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(-1000px) rotate(720deg);
        opacity: 0;
      }
    }
    
    .login-logo-container {
      position: relative;
      width: 180px;
      height: 180px;
      margin-bottom: 20px;
      perspective: 1000px;
    }
    
    .login-logo {
      width: 100%;
      height: 100%;
      object-fit: contain;
      animation: rotate 20s linear infinite, pulse 4s ease-in-out infinite;
      filter: drop-shadow(0 0 15px rgba(52, 152, 219, 0.7));
    }
    
    .login-logo-ring {
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      border: 5px solid transparent;
      border-top-color: var(--secondary-color);
      border-radius: 50%;
      animation: spin 3s linear infinite;
      z-index: -1;
    }
    
    .login-logo-ring:nth-child(2) {
      border-top-color: var(--accent-color);
      animation-duration: 4s;
      animation-direction: reverse;
    }
    
    .login-logo-ring:nth-child(3) {
      border-top-color: var(--success-color);
      animation-duration: 5s;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .login-box {
      background: var(--login-bg);
      padding: 2.5rem;
      border-radius: 20px;
      width: 400px;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      text-align: center;
      border-top: 3px solid var(--secondary-color);
      animation: fadeIn 0.8s ease-in-out, slideUp 0.8s ease-in-out;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .login-box::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        to bottom right,
        transparent 45%,
        rgba(52, 152, 219, 0.3) 50%,
        transparent 55%
      );
      animation: shine 4s infinite;
      z-index: -1;
    }
    
    @keyframes shine {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideUp {
      from { transform: translateY(50px); }
      to { transform: translateY(0); }
    }

    @keyframes slideIn {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }
    
    .login-box h2 {
      margin-bottom: 1.5rem;
      color: var(--text-color);
      font-weight: 600;
      font-size: 1.8rem;
      text-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .input-group {
      margin-bottom: 1.5rem;
      position: relative;
    }
    
    .input-group input {
      width: 100%;
      padding: 15px 20px;
      border: none;
      border-radius: 50px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-color);
      font-size: 16px;
      border-left: 3px solid transparent;
      transition: all 0.3s ease;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
      backdrop-filter: blur(5px);
    }
    
    .input-group input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-left: 3px solid var(--secondary-color);
      box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
    }
    
    .input-group::after {
      content: 'üîí';
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0.5;
    }
    
    .login-btn {
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      width: 100%;
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
      position: relative;
      overflow: hidden;
    }
    
    .login-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(52, 152, 219, 0.6);
    }
    
    .login-btn:active {
      transform: translateY(1px);
    }
    
    .login-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }
    
    .login-btn:hover::before {
      left: 100%;
    }
    
    .error-message {
      color: var(--accent-color);
      margin-top: 1rem;
      font-size: 14px;
      height: 20px;
      animation: shake 0.5s ease-in-out;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-5px); }
      40%, 80% { transform: translateX(5px); }
    }
    
    .login-footer {
      margin-top: 20px;
      font-size: 14px;
      opacity: 0.7;
      color: var(--text-color);
      animation: fadeIn 2s ease-in-out;
    }
    
    /* ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    #app {
      display: none;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
    }
    
    .dashboard-title {
      font-size: 1.8rem;
      font-weight: 500;
      color: var(--text-color);
    }

    .header-logo {
      width: 60px;
      height: 60px;
      position: absolute;
      right: 0;
      top: 0;
      object-fit: contain;
      background: rgba(0, 0, 0, 0);
      border-radius: 50%;
      padding: 5px;
    }

    .header-controls {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-left: auto;
      padding-right: 60px;
    }
    
    .logout-btn {
      background: var(--accent-color);
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .logout-btn:hover {
      background: #c0392b;
      transform: translateY(-2px);
    }

    .theme-toggle {
      position: relative;
      width: 60px;
      height: 30px;
      background: var(--secondary-color);
      border-radius: 15px;
      cursor: pointer;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .theme-toggle input {
      display: none;
    }

    .theme-slider {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      transition: all 0.4s ease;
    }

    .theme-slider:before {
      content: "";
      position: absolute;
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: white;
      top: 2px;
      left: 2px;
      transition: all 0.4s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .theme-toggle input:checked + .theme-slider {
      background: var(--primary-color);
    }

    .theme-toggle input:checked + .theme-slider:before {
      transform: translateX(30px);
    }

    .theme-icon {
      position: absolute;
      color: white;
      font-size: 14px;
      top: 50%;
      transform: translateY(-50%);
    }

    .sun-icon {
      left: 7px;
    }

    .moon-icon {
      right: 7px;
    }
    
    .nav-tabs {
      display: flex;
      background: var(--nav-bg);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 2rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .nav-tab {
      flex: 1;
      text-align: center;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      color: var(--text-color);
    }
    
    .nav-tab:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .nav-tab.active {
      background: rgba(52, 152, 219, 0.2);
      border-bottom: 3px solid var(--secondary-color);
    }
    
    .device-page {
      display: none;
      animation: fadeIn 0.5s ease;
    }
    
    .device-page.active {
      display: block;
    }
    
    .device-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .device-card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border-left: 4px solid var(--secondary-color);
    }
    
    .device-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .card-title {
      font-size: 1rem;
      font-weight: 500;
      color: var(--text-color);
    }
    
    .card-status {
      padding: 4px 8px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      color: white;
    }
    
    .status-active {
      background: var(--success-color);
    }
    
    .status-inactive {
      background: var(--accent-color);
    }
    
    .status-warning {
      background: var(--warning-color);
    }
    
    .card-value {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 10px 0;
      text-align: center;
      color: var(--text-color);
    }
    
    .card-footer {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    
    .card-btn {
      padding: 6px 12px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      font-size: 12px;
      color: white;
    }
    
    .btn-on {
      background: var(--success-color);
    }
    
    .btn-off {
      background: var(--accent-color);
    }
    
    .btn-warning {
      background: var(--warning-color);
    }
    
    .btn-info {
      background: var(--info-color);
    }
    
    .device-status-summary {
      display: flex;
      justify-content: space-around;
      background: var(--card-bg);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    
    .status-item {
      text-align: center;
    }
    
    .status-count {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-color);
    }
    
    .status-label {
      font-size: 0.9rem;
      opacity: 0.8;
      color: var(--text-color);
    }
    
    .analytics-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .chart-container, .log-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      animation: slideIn 0.5s ease;
    }
    
    .section-title {
      font-size: 1.2rem;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--text-color);
    }
    
    .log-list {
      max-height: 300px;
      overflow-y: auto;
    }
    
    .log-item {
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.9rem;
    }
    
    .log-time {
      color: var(--secondary-color);
      font-size: 0.8rem;
    }
    
    .log-message {
      margin-top: 3px;
    }
    
    .log-warning {
      color: var(--warning-color);
    }
    
    .log-error {
      color: var(--accent-color);
    }
    
    .log-success {
      color: var(--success-color);
    }
    
    .log-info {
      color: var(--secondary-color);
    }

    /* ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .energy-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .energy-card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border-top: 4px solid var(--secondary-color);
      animation: fadeIn 0.6s ease-in-out;
    }

    .energy-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    .energy-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--text-color);
      display: flex;
      align-items: center;
    }

    .energy-value {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 10px 0;
      color: var(--text-color);
    }

    .energy-unit {
      font-size: 1rem;
      opacity: 0.8;
      margin-left: 5px;
    }

    .voltage-card { border-top-color: var(--voltage-color); }
    .current-card { border-top-color: var(--current-color); }
    .power-card { border-top-color: var(--power-color); }
    .energy-card-main { border-top-color: var(--energy-color); }
    .frequency-card { border-top-color: var(--info-color); }
    .power-factor-card { border-top-color: var(--warning-color); }
    .active-power-card { border-top-color: var(--success-color); }
    .reactive-power-card { border-top-color: var(--accent-color); }

    .energy-graphs {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .graph-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .graph-title {
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: var(--text-color);
    }

    /* ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .time-selection {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .time-btn {
      padding: 8px 15px;
      border: none;
      border-radius: 5px;
      background: var(--secondary-color);
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .time-btn:hover {
      background: var(--primary-color);
      transform: translateY(-2px);
    }

    .time-btn.active {
      background: var(--success-color);
      box-shadow: 0 0 0 2px var(--light-color);
    }

    .metric-selection {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .metric-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    .metric-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .metric-card.selected {
      border-left-color: var(--secondary-color);
      background: rgba(52, 152, 219, 0.2);
    }

    .metric-title {
      font-weight: 600;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .metric-icon {
      font-size: 1.2rem;
    }

    .metric-description {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .advanced-graph-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      margin-bottom: 30px;
      animation: fadeIn 0.6s ease;
    }

    .graph-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .graph-controls {
      display: flex;
      gap: 10px;
    }

    .graph-btn {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      background: var(--secondary-color);
      color: white;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
    }

    .graph-btn:hover {
      background: var(--primary-color);
    }

    .no-data-message {
      text-align: center;
      padding: 20px;
      color: var(--text-color);
      opacity: 0.7;
    }

    /* ‡¶™‡ßá‡¶á‡¶ú ‡ß≠ ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .notes-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      margin-bottom: 30px;
    }

    .note-title {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: var(--secondary-color);
      border-bottom: 2px solid var(--secondary-color);
      padding-bottom: 10px;
    }

    .note-subtitle {
      font-size: 1.2rem;
      margin: 20px 0 10px;
      color: var(--secondary-color);
    }

    .note-paragraph {
      margin-bottom: 15px;
      line-height: 1.6;
      text-align: justify;
    }

    .note-letter {
      background: rgba(52, 152, 219, 0.2);
      border-left: 4px solid var(--secondary-color);
      padding: 15px;
      margin: 15px 0;
      border-radius: 0 5px 5px 0;
    }

    .note-letter-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--secondary-color);
    }

    .note-letter-content {
      line-height: 1.5;
    }

    .note-images {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }

    .note-image {
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .note-image:hover {
      transform: scale(1.02);
    }

    .note-image img {
      width: 100%;
      height: auto;
      display: block;
    }

    .note-image-caption {
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 8px;
      text-align: center;
      font-size: 0.9rem;
    }

    /* ‡¶™‡ßá‡¶á‡¶ú ‡ßÆ ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ - ‡¶®‡ßã‡¶ü ‡¶ì ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü */
    .documents-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      margin-bottom: 30px;
    }

    .documents-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      border-bottom: 2px solid var(--secondary-color);
      padding-bottom: 10px;
    }

    .documents-title {
      font-size: 1.5rem;
      color: var(--secondary-color);
    }

    .documents-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .documents-tab {
      padding: 8px 15px;
      border-radius: 5px;
      background: var(--secondary-color);
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .documents-tab.active {
      background: var(--primary-color);
      box-shadow: 0 0 0 2px var(--light-color);
    }

    .documents-tab:hover {
      background: var(--primary-color);
    }

    .editor-container {
      margin-bottom: 30px;
    }

    .editor-toolbar {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }

    .editor-btn {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      background: var(--secondary-color);
      color: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .editor-btn:hover {
      background: var(--primary-color);
    }

    .editor-textarea {
      width: 100%;
      min-height: 200px;
      padding: 15px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-color);
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: inherit;
      font-size: 16px;
      resize: vertical;
      margin-bottom: 10px;
    }

    .editor-textarea:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
    }

    .documents-list {
      display: grid;
      gap: 15px;
    }

    .document-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }

    .document-item:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
    }

    .document-info {
      flex: 1;
    }

    .document-name {
      font-weight: 600;
      margin-bottom: 5px;
    }

    .document-date {
      font-size: 0.8rem;
      opacity: 0.7;
    }

    .document-actions {
      display: flex;
      gap: 10px;
    }

    .document-btn {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .document-btn.view {
      background: var(--info-color);
      color: white;
    }

    .document-btn.download {
      background: var(--success-color);
      color: white;
    }

    .document-btn.delete {
      background: var(--accent-color);
      color: white;
    }

    .document-btn:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    .file-upload-container {
      margin-top: 20px;
      padding: 20px;
      border: 2px dashed rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .file-upload-container:hover {
      border-color: var(--secondary-color);
      background: rgba(52, 152, 219, 0.1);
    }

    .file-upload-label {
      display: block;
      cursor: pointer;
      padding: 10px;
    }

    .file-upload-input {
      display: none;
    }

    .file-upload-icon {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--secondary-color);
    }

    .file-upload-text {
      margin-bottom: 10px;
    }

    /* ‡¶á‡¶Æ‡ßá‡¶ú ‡¶≠‡¶ø‡¶â‡ßü‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 2000;
      overflow: auto;
      animation: fadeIn 0.3s;
    }

    .modal-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
      padding: 20px;
    }

    .modal-image {
      max-width: 200%;
      max-height: 80vh;
      object-fit: contain;
      animation: zoomIn 0.3s;
    }

    .modal-caption {
      color: white;
      text-align: center;
      margin-top: 15px;
      font-size: 1.2rem;
    }

    .close-modal {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 35px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }

    .close-modal:hover {
      color: var(--secondary-color);
    }

    @keyframes zoomIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    @media (max-width: 1024px) {
      .analytics-section {
        grid-template-columns: 1fr;
      }
      
      .energy-graphs {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .login-box {
        width: 90%;
        padding: 1.5rem;
      }
      
      .login-logo-container {
        width: 120px;
        height: 120px;
      }
      
      .nav-tabs {
        flex-direction: column;
      }
      
      .device-cards, .energy-metrics {
        grid-template-columns: 1fr 1fr;
      }
      
      .device-status-summary {
        flex-direction: column;
        gap: 10px;
      }

      .dashboard-header {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
      }

      .header-controls {
        width: 100%;
        justify-content: space-between;
        padding-right: 0;
      }

      .header-logo {
        position: static;
        margin-left: auto;
      }

      .metric-selection {
        grid-template-columns: 1fr 1fr;
      }

      /* ‡¶™‡ßá‡¶á‡¶ú ‡ß≠ ‡¶∞‡ßá‡¶∏‡ßç‡¶™‡¶®‡ßç‡¶∏‡¶ø‡¶≠ */
      .note-images {
        grid-template-columns: 1fr;
      }

      /* ‡¶™‡ßá‡¶á‡¶ú ‡ßÆ ‡¶∞‡ßá‡¶∏‡ßç‡¶™‡¶®‡ßç‡¶∏‡¶ø‡¶≠ */
      .documents-tabs {
        flex-direction: column;
      }

      .document-item {
        flex-direction: column;
        align-items: flex-start;
      }

      .document-actions {
        margin-top: 10px;
        width: 100%;
        justify-content: flex-end;
      }

      .modal-image {
        max-width: 95%;
        max-height: 70vh;
      }
    }
    
    @media (max-width: 480px) {
      .device-cards, .energy-metrics, .metric-selection {
        grid-template-columns: 1fr;
      }

      .login-logo-container {
        width: 100px;
        height: 100px;
      }
      
      .login-box h2 {
        font-size: 1.5rem;
      }

      .modal-image {
        max-width: 100%;
        max-height: 60vh;
      }

      .modal-caption {
        font-size: 1rem;
      }

      /* ‡¶™‡ßá‡¶á‡¶ú ‡ßÆ ‡¶∞‡ßá‡¶∏‡ßç‡¶™‡¶®‡ßç‡¶∏‡¶ø‡¶≠ */
      .editor-toolbar {
        flex-wrap: wrap;
      }

      .document-actions {
        flex-wrap: wrap;
        justify-content: flex-start;
      }

      .document-btn {
        margin-bottom: 5px;
      }
    }
  </style>
</head>
<body>

<!-- ‡¶≤‡¶ï ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® -->
<div class="login-container" id="login">
  <div class="login-particles" id="particles"></div>
  
  <div class="login-logo-container">
    <img src="https://i.ibb.co/6n0H7X8/Bisnu.png" class="login-logo" alt="BISNU IoT Logo">
    <div class="login-logo-ring"></div>
    <div class="login-logo-ring"></div>
    <div class="login-logo-ring"></div>
  </div>
  
  <div class="login-box">
    <h2>BISNU IoT ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
    <div class="input-group">
      <input type="password" id="password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" autocomplete="off">
    </div>
    <button class="login-btn" onclick="checkPassword()">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <div class="error-message" id="error"></div>
    <div class="login-footer">
      ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
    </div>
  </div>
</div>

<!-- ‡¶Æ‡ßÇ‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® -->
<div id="app">
  <div class="dashboard-header">
    <h1 class="dashboard-title">IoT ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</h1>
    <img src="https://i.ibb.co/6n0H7X8/Bisnu.png" class="header-logo" alt="BISNU IoT Logo">
    <div class="header-controls">
      <label class="theme-toggle">
        <input type="checkbox" id="theme-toggle">
        <span class="theme-slider"></span>
        <span class="theme-icon sun-icon">‚òÄÔ∏è</span>
        <span class="theme-icon moon-icon">üåô</span>
      </label>
      <button class="logout-btn" onclick="logout()">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
    </div>
  </div>
  
  <div class="nav-tabs">
    <div class="nav-tab active" onclick="showPage(1)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß</div>
    <div class="nav-tab" onclick="showPage(2)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß®</div>
    <div class="nav-tab" onclick="showPage(3)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß©</div>
    <div class="nav-tab" onclick="showPage(4)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß™</div>
    <div class="nav-tab" onclick="showPage(5)">‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞</div>
    <div class="nav-tab" onclick="showPage(6)">‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶ó‡ßç‡¶∞‡¶æ‡¶´</div>
    <div class="nav-tab" onclick="showPage(7)">Diagram Note File</div>
    <div class="nav-tab" onclick="showPage(8)">‡¶®‡ßã‡¶ü ‡¶ì ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</div>
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page1" class="device-page active">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    <!-- ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® -->
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß® ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page2" class="device-page">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß® ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    <!-- ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® -->
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß© ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page3" class="device-page">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß© ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    <!-- ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® -->
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß™ ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page4" class="device-page">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß™ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    <!-- ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® -->
  </div>

  <!-- ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page5" class="device-page">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    <!-- ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® -->
  </div>

  <!-- ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page6" class="device-page">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    <!-- ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® -->
  </div>

  <!-- ‡¶™‡ßá‡¶á‡¶ú ‡ß≠: Diagram Note File -->
  <div id="page7" class="device-page">
    <!-- ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ Diagram Note File ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
    <!-- ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® -->
  </div>

  <!-- ‡¶™‡ßá‡¶á‡¶ú ‡ßÆ: ‡¶®‡ßã‡¶ü ‡¶ì ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü -->
  <div id="page8" class="device-page">
    <div class="documents-container">
      <div class="documents-header">
        <h2 class="documents-title">‡¶®‡ßã‡¶ü ‡¶ì ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</h2>
      </div>
      
      <div class="documents-tabs">
        <div class="documents-tab active" onclick="showDocumentTab('notes')">‡¶®‡ßã‡¶ü‡¶∏</div>
        <div class="documents-tab" onclick="showDocumentTab('files')">‡¶´‡¶æ‡¶á‡¶≤‡¶∏</div>
      </div>
      
      <!-- ‡¶®‡ßã‡¶ü ‡¶è‡¶°‡¶ø‡¶ü‡¶∞ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
      <div id="notes-tab" class="document-tab active">
        <div class="editor-container">
          <div class="editor-toolbar">
            <button class="editor-btn" onclick="saveNote()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <button class="editor-btn" onclick="clearEditor()">‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞</button>
          </div>
          <textarea id="note-editor" class="editor-textarea" placeholder="‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡ßã‡¶ü ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...">
# ‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡ßã‡¶ü

‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡¶ü‡¶ø IoT ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ‡•§ ‡¶®‡¶ø‡¶ö‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡ßü‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶≤‡ßã:

1. **‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶ø‡¶ü‡ßá‡¶ï‡¶ö‡¶æ‡¶∞**: 
   - ESP32 ‡¶Æ‡¶æ‡¶á‡¶ï‡ßç‡¶∞‡ßã‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤‡¶æ‡¶∞
   - Firebase ‡¶∞‡¶ø‡ßü‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏
   - ‡¶ì‡ßü‡ßá‡¶¨ ‡¶¨‡ßá‡¶ú‡¶° ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤

2. **‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ**:
   - ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶®‡¶ø‡¶®
   - ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ
   - ‡¶®‡¶ø‡ßü‡¶Æ‡¶ø‡¶§ ‡¶≤‡¶ó ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®

3. **‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü**:
   - ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ú‡¶®
   - ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü
   - ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶ø‡¶Ç

          </textarea>
        </div>
        
        <h3 class="note-subtitle">‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶®‡ßã‡¶ü‡¶∏</h3>
        <div class="documents-list" id="saved-notes">
          <!-- ‡¶®‡ßã‡¶ü ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶¨‡ßá -->
          <div class="document-item">
            <div class="document-info">
              <div class="document-name">‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡ßã‡¶ü</div>
              <div class="document-date">‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ: ‡ßß‡ß¶ ‡¶ú‡ßÅ‡¶®, ‡ß®‡ß¶‡ß®‡ß©</div>
            </div>
            <div class="document-actions">
              <button class="document-btn view" onclick="viewNote('note1')">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
              <button class="document-btn delete" onclick="deleteNote('note1')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
            </div>
          </div>
          
          <div class="document-item">
            <div class="document-info">
              <div class="document-name">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ‡¶ó‡¶æ‡¶á‡¶°</div>
              <div class="document-date">‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ: ‡ß®‡ß´ ‡¶Æ‡ßá, ‡ß®‡ß¶‡ß®‡ß©</div>
            </div>
            <div class="document-actions">
              <button class="document-btn view" onclick="viewNote('note2')">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
              <button class="document-btn delete" onclick="deleteNote('note2')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
      <div id="files-tab" class="document-tab">
        <div class="file-upload-container">
          <label class="file-upload-label">
            <input type="file" id="file-upload" class="file-upload-input" accept=".zip,.rar,.7zip" onchange="handleFileUpload(event)">
            <div class="file-upload-icon">üìÅ</div>
            <div class="file-upload-text">ZIP ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡ßç‡¶∞‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
            <div class="file-upload-hint">‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú: 10MB</div>
          </label>
        </div>
        
        <h3 class="note-subtitle">‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶´‡¶æ‡¶á‡¶≤‡¶∏</h3>
        <div class="documents-list" id="saved-files">
          <!-- ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶¨‡ßá -->
          <div class="document-item">
            <div class="document-info">
              <div class="document-name">project-backup-2023-06-01.zip</div>
              <div class="document-date">‡¶Ü‡¶™‡¶≤‡ßã‡¶°: ‡ßß ‡¶ú‡ßÅ‡¶®, ‡ß®‡ß¶‡ß®‡ß© | ‡¶∏‡¶æ‡¶á‡¶ú: 4.2MB</div>
            </div>
            <div class="document-actions">
              <button class="document-btn download" onclick="downloadFile('file1')">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</button>
              <button class="document-btn delete" onclick="deleteFile('file1')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
            </div>
          </div>
          
          <div class="document-item">
            <div class="document-info">
              <div class="document-name">circuit-diagrams.zip</div>
              <div class="document-date">‡¶Ü‡¶™‡¶≤‡ßã‡¶°: ‡ßß‡ß´ ‡¶Æ‡ßá, ‡ß®‡ß¶‡ß®‡ß© | ‡¶∏‡¶æ‡¶á‡¶ú: 2.8MB</div>
            </div>
            <div class="document-actions">
              <button class="document-btn download" onclick="downloadFile('file2')">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</button>
              <button class="document-btn delete" onclick="deleteFile('file2')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
            </div>
          </div>
          
          <div class="document-item">
            <div class="document-info">
              <div class="document-name">user-manuals.zip</div>
              <div class="document-date">‡¶Ü‡¶™‡¶≤‡ßã‡¶°: ‡ß´ ‡¶Æ‡ßá, ‡ß®‡ß¶‡ß®‡ß© | ‡¶∏‡¶æ‡¶á‡¶ú: 1.5MB</div>
            </div>
            <div class="document-actions">
              <button class="document-btn download" onclick="downloadFile('file3')">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</button>
              <button class="document-btn delete" onclick="deleteFile('file3')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ‡¶á‡¶Æ‡ßá‡¶ú ‡¶≠‡¶ø‡¶â‡ßü‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ -->
<div id="imageModal" class="image-modal">
  <span class="close-modal" onclick="closeImageModal()">&times;</span>
  <div class="modal-content">
    <img id="modalImage" class="modal-image" src="" alt="">
    <div id="modalCaption" class="modal-caption"></div>
  </div>
</div>

<!-- ‡¶®‡ßã‡¶ü ‡¶≠‡¶ø‡¶â‡ßü‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ -->
<div id="noteModal" class="image-modal">
  <span class="close-modal" onclick="closeNoteModal()">&times;</span>
  <div class="modal-content">
    <div id="noteModalContent" class="modal-caption" style="text-align: left; white-space: pre-wrap; padding: 20px; max-width: 800px; max-height: 80vh; overflow: auto;"></div>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

<script>
  // Firebase ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®
  const firebaseConfig = {
    apiKey: "AIzaSyATDfnefdyPAzBNKZY4VM5ja8K2-63PC-U",
    authDomain: "home-server-346b6.firebaseapp.com",
    databaseURL: "https://home-server-346b6-default-rtdb.firebaseio.com",
    projectId: "home-server-346b6",
    storageBucket: "home-server-346b6.appspot.com",
    messagingSenderId: "531234227336",
    appId: "1:531234227336:web:f57f700dd6baaed4358b3d",
    measurementId: "G-QDWVP34FSX"
  };

  // Firebase ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
  const storage = firebase.storage();

  // ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°
  const correctPassword = "123";

  // ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶ú‡ßá‡¶ï‡ßç‡¶ü
  const deviceCharts = {};
  let energyCharts = {};
  let advancedEnergyChart = null;
  let selectedMetric = 'voltage';
  let selectedTimeRange = 30; // minutes
  let historicalData = {};
  
  // ‡¶®‡ßã‡¶ü ‡¶ì ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤
  let notes = {};
  let files = {};
  let currentTab = 'notes';
  
  // ‡¶á‡¶Æ‡ßá‡¶ú ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function openImageModal(imageSrc, caption) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    const modalCaption = document.getElementById('modalCaption');
    
    modal.style.display = "flex";
    modalImg.src = imageSrc;
    modalCaption.innerHTML = caption;
    
    // ESC ‡¶ï‡ßÄ ‡¶¶‡¶ø‡ßü‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ
    document.addEventListener('keydown', function(event) {
      if (event.key === "Escape") {
        closeImageModal();
      }
    });
  }

  function closeImageModal() {
    document.getElementById('imageModal').style.display = "none";
    document.removeEventListener('keydown', function(event) {
      if (event.key === "Escape") {
        closeImageModal();
      }
    });
  }

  // ‡¶®‡ßã‡¶ü ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function openNoteModal(content) {
    const modal = document.getElementById('noteModal');
    const modalContent = document.getElementById('noteModalContent');
    
    modal.style.display = "flex";
    modalContent.textContent = content;
    
    // ESC ‡¶ï‡ßÄ ‡¶¶‡¶ø‡ßü‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ
    document.addEventListener('keydown', function(event) {
      if (event.key === "Escape") {
        closeNoteModal();
      }
    });
  }

  function closeNoteModal() {
    document.getElementById('noteModal').style.display = "none";
    document.removeEventListener('keydown', function(event) {
      if (event.key === "Escape") {
        closeNoteModal();
      }
    });
  }

  // ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡¶¨‡ßá
  window.onclick = function(event) {
    const imageModal = document.getElementById('imageModal');
    const noteModal = document.getElementById('noteModal');
    
    if (event.target === imageModal) {
      closeImageModal();
    }
    if (event.target === noteModal) {
      closeNoteModal();
    }
  }

  // ‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶ø‡¶ï‡¶≤ ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶§‡ßà‡¶∞‡¶ø
  function createParticles() {
    const particlesContainer = document.getElementById('particles');
    const particleCount = 30;
    
    for (let i = 0; i < particleCount; i++) {
      const particle = document.createElement('div');
      particle.classList.add('particle');
      
      // ‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶∏‡¶æ‡¶á‡¶ú
      const size = Math.random() * 10 + 5;
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      
      // ‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶™‡¶ú‡¶ø‡¶∂‡¶®
      particle.style.left = `${Math.random() * 100}%`;
      particle.style.top = `${Math.random() * 100}%`;
      
      // ‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶°‡ßá‡¶≤‡¶ø
      particle.style.animationDelay = `${Math.random() * 15}s`;
      particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
      
      // ‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ opacity
      particle.style.opacity = Math.random() * 0.5 + 0.1;
      
      particlesContainer.appendChild(particle);
    }
  }

  // ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function checkPassword() {
    const input = document.getElementById("password").value;
    if(input === correctPassword) {
      // ‡¶≤‡¶ó‡¶ø‡¶® ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶®
      document.getElementById("login").style.animation = "fadeOut 0.5s ease forwards";
      setTimeout(() => {
        document.getElementById("login").style.display = "none";
        document.getElementById("app").style.display = "block";
        loadDataRealtime();
        initializeCharts();
        loadThemePreference();
        initEnergyCharts();
        loadEnergyData();
        initAdvancedEnergyChart();
        loadHistoricalData();
        loadNotesAndFiles();
      }, 500);
    } else {
      document.getElementById("error").innerText = "‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°! ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®";
      // ‡¶∂‡ßá‡¶ï ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
      document.querySelector(".login-box").style.animation = "shake 0.5s ease-in-out";
      setTimeout(() => {
        document.querySelector(".login-box").style.animation = "";
      }, 500);
    }
  }

  // ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function logout() {
    // ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶®
    document.getElementById("app").style.animation = "fadeOut 0.5s ease forwards";
    setTimeout(() => {
      document.getElementById("login").style.display = "flex";
      document.getElementById("app").style.display = "none";
      document.getElementById("password").value = "";
      document.getElementById("error").innerText = "";
      document.getElementById("app").style.animation = "";
    }, 500);
  }

  // ‡¶™‡ßá‡¶á‡¶ú ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function showPage(pageNum) {
    // ‡¶∏‡¶¨ ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶•‡ßá‡¶ï‡ßá active ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶∞‡¶ø‡¶Æ‡ßÅ‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.classList.remove('active');
    });
    
    // ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§ ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨‡ßá active ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
    document.querySelectorAll('.nav-tab')[pageNum-1].classList.add('active');
    
    // ‡¶∏‡¶¨ ‡¶™‡ßá‡¶á‡¶ú ‡¶≤‡ßÅ‡¶ï‡¶ø‡¶Ø‡¶º‡ßá ‡¶¶‡¶ø‡¶®
    document.querySelectorAll('.device-page').forEach(page => {
      page.classList.remove('active');
    });
    
    // ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§ ‡¶™‡ßá‡¶á‡¶ú ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®
    document.getElementById('page'+pageNum).classList.add('active');

    // 6th page selected - refresh advanced chart
    if(pageNum === 6) {
      updateAdvancedChart();
    }
  }

  // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function controlDevice(device, load, state) {
    const timestamp = new Date().toISOString();
    const logMessage = `${device} ‡¶è‡¶∞ ${load} ${state === 1 ? '‡¶ö‡¶æ‡¶≤‡ßÅ' : state === 2 ? '‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ ‡¶Æ‡ßã‡¶°‡ßá' : '‡¶¨‡¶®‡ßç‡¶ß'} ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá`;
    
    database.ref('devices/' + device).update({
      [load]: state
    });
    
    // ‡¶≤‡¶ó ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
    addLogEntry(device, logMessage, state === 1 ? 'success' : state === 2 ? 'warning' : 'error');
    
    // ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
    updateChart(device);
  }

  // ‡¶≤‡¶ó ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function addLogEntry(device, message, type) {
    const timestamp = new Date().toLocaleString();
    const logElement = document.getElementById(`${device}-logs`);
    const logClass = `log-${type}`;
    
    const logItem = document.createElement('div');
    logItem.className = 'log-item';
    logItem.innerHTML = `
      <div class="log-time">${timestamp}</div>
      <div class="log-message ${logClass}">${message}</div>
    `;
    
    logElement.insertBefore(logItem, logElement.firstChild);
    
    // ‡¶∏‡¶∞‡ßç‡¶¨‡¶æ‡¶ß‡¶ø‡¶ï 50‡¶ü‡¶ø ‡¶≤‡¶ó ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®
    if(logElement.children.length > 50) {
      logElement.removeChild(logElement.lastChild);
    }
  }

  // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function initializeCharts() {
    for(let i = 1; i <= 4; i++) {
      const ctx = document.getElementById(`device${i}-chart`).getContext('2d');
      
      deviceCharts[`device${i}`] = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠', '‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ', '‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠'],
          datasets: [{
            data: [0, 0, 16],
            backgroundColor: [
              'rgba(46, 204, 113, 0.8)',
              'rgba(243, 156, 18, 0.8)',
              'rgba(231, 76, 60, 0.8)'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              labels: {
                color: 'var(--text-color)'
              }
            }
          }
        }
      });
    }
  }

  // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function updateChart(device) {
    const activeCount = parseInt(document.getElementById(`${device}-active-count`).textContent);
    const warningCount = parseInt(document.getElementById(`${device}-warning-count`).textContent);
    const inactiveCount = parseInt(document.getElementById(`${device}-inactive-count`).textContent);
    
    deviceCharts[device].data.datasets[0].data = [activeCount, warningCount, inactiveCount];
    deviceCharts[device].update();
  }

  // ‡¶•‡¶ø‡¶Æ ‡¶ü‡¶ó‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function toggleTheme() {
    const body = document.body;
    const themeToggle = document.getElementById('theme-toggle');
    
    if(themeToggle.checked) {
      body.classList.add('light-theme');
      localStorage.setItem('theme', 'light');
    } else {
      body.classList.remove('light-theme');
      localStorage.setItem('theme', 'dark');
    }
  }

  // ‡¶•‡¶ø‡¶Æ ‡¶™‡ßç‡¶∞‡¶ø‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function loadThemePreference() {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    const themeToggle = document.getElementById('theme-toggle');
    
    if(savedTheme === 'light') {
      document.body.classList.add('light-theme');
      themeToggle.checked = true;
    } else {
      document.body.classList.remove('light-theme');
      themeToggle.checked = false;
    }
    
    // ‡¶•‡¶ø‡¶Æ ‡¶ü‡¶ó‡¶≤ ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞
    themeToggle.addEventListener('change', toggleTheme);
  }

  // ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function initEnergyCharts() {
    // ‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü
    const voltageCtx = document.getElementById('voltage-chart').getContext('2d');
    energyCharts.voltageChart = new Chart(voltageCtx, {
      type: 'line',
      data: {
        labels: Array(12).fill(''),
        datasets: [{
          label: '‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú (V)',
          data: [],
          borderColor: 'rgba(230, 126, 34, 1)',
          backgroundColor: 'rgba(230, 126, 34, 0.1)',
          borderWidth: 2,
          tension: 0.4,
          fill: true
        }]
      },
      options: getChartOptions('‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° (V)')
    });

    // ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü
    const currentCtx = document.getElementById('current-chart').getContext('2d');
    energyCharts.currentChart = new Chart(currentCtx, {
      type: 'line',
      data: {
        labels: Array(12).fill(''),
        datasets: [{
          label: '‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü (A)',
          data: [],
          borderColor: 'rgba(26, 188, 156, 1)',
          backgroundColor: 'rgba(26, 188, 156, 0.1)',
          borderWidth: 2,
          tension: 0.4,
          fill: true
        }]
      },
      options: getChartOptions('‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° (A)')
    });

    // ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü
    const powerCtx = document.getElementById('power-chart').getContext('2d');
    energyCharts.powerChart = new Chart(powerCtx, {
      type: 'line',
      data: {
        labels: Array(12).fill(''),
        datasets: [{
          label: '‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ (W)',
          data: [],
          borderColor: 'rgba(52, 152, 219, 1)',
          backgroundColor: 'rgba(52, 152, 219, 0.1)',
          borderWidth: 2,
          tension: 0.4,
          fill: true
        }]
      },
      options: getChartOptions('‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° (W)')
    });

    // ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü
    const energyCtx = document.getElementById('energy-chart').getContext('2d');
    energyCharts.energyChart = new Chart(energyCtx, {
      type: 'bar',
      data: {
        labels: ['‡¶∏‡¶ï‡¶æ‡¶≤', '‡¶¶‡ßÅ‡¶™‡ßÅ‡¶∞', '‡¶¨‡¶ø‡¶ï‡¶æ‡¶≤', '‡¶∞‡¶æ‡¶§'],
        datasets: [{
          label: '‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø (kWh)',
          data: [0, 0, 0, 0],
          backgroundColor: 'rgba(155, 89, 182, 0.7)',
          borderColor: 'rgba(155, 89, 182, 1)',
          borderWidth: 1
        }]
      },
      options: getChartOptions('‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ï‡¶®‡¶ú‡¶æ‡¶Æ‡ßç‡¶™‡¶∂‡¶® (kWh)')
    });
  }

  function getChartOptions(title) {
    return {
      responsive: true,
      plugins: {
        legend: {
          labels: {
            color: 'var(--text-color)'
          }
        },
        title: {
          display: true,
          text: title,
          color: 'var(--text-color)',
          font: {
            size: 14
          }
        }
      },
      scales: {
        x: {
          grid: {
            color: 'rgba(255, 255, 255, 0.1)'
          },
          ticks: {
            color: 'var(--text-color)'
          }
        },
        y: {
          grid: {
            color: 'rgba(255, 255, 255, 0.1)'
          },
          ticks: {
            color: 'var(--text-color)'
          }
        }
      }
    };
  }

  // ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function updateEnergyData(data) {
    // ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    document.getElementById('voltage-value').textContent = data.voltage ? data.voltage.toFixed(2) + ' V' : '-- V';
    document.getElementById('current-value').textContent = data.current ? data.current.toFixed(2) + ' A' : '-- A';
    document.getElementById('power-value').textContent = data.power ? data.power.toFixed(2) + ' W' : '-- W';
    document.getElementById('energy-value').textContent = data.energy ? data.energy.toFixed(2) + ' kWh' : '-- kWh';
    document.getElementById('frequency-value').textContent = data.frequency ? data.frequency.toFixed(2) + ' Hz' : '-- Hz';
    document.getElementById('power-factor-value').textContent = data.powerFactor ? data.powerFactor.toFixed(2) : '--';
    document.getElementById('active-power-value').textContent = data.activePower ? data.activePower.toFixed(2) + ' W' : '-- W';
    document.getElementById('reactive-power-value').textContent = data.reactivePower ? data.reactivePower.toFixed(2) + ' VAR' : '-- VAR';

    // ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    updateEnergyChartData(energyCharts.voltageChart, data.voltage);
    updateEnergyChartData(energyCharts.currentChart, data.current);
    updateEnergyChartData(energyCharts.powerChart, data.power);
    
    // ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü (‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ)
    if(data.energy) {
      const now = new Date();
      const hours = now.getHours();
      let period = 0; // ‡¶∏‡¶ï‡¶æ‡¶≤
      if(hours >= 12 && hours < 16) period = 1; // ‡¶¶‡ßÅ‡¶™‡ßÅ‡¶∞
      else if(hours >= 16 && hours < 20) period = 2; // ‡¶¨‡¶ø‡¶ï‡¶æ‡¶≤
      else if(hours >= 20 || hours < 6) period = 3; // ‡¶∞‡¶æ‡¶§
      
      energyCharts.energyChart.data.datasets[0].data[period] = data.energy;
      energyCharts.energyChart.update();
    }

    // Store historical data
    const timestamp = new Date().getTime();
    if(!historicalData[timestamp]) {
      historicalData[timestamp] = data;
      
      // Keep only data within the selected time range
      const cutoffTime = timestamp - (selectedTimeRange * 60 * 1000);
      Object.keys(historicalData).forEach(key => {
        if(parseInt(key) < cutoffTime) {
          delete historicalData[key];
        }
      });
      
      updateAdvancedChart();
    }
  }

  function updateEnergyChartData(chart, newValue) {
    if(!newValue) return;
    
    chart.data.labels.push('');
    if(chart.data.labels.length > 12) {
      chart.data.labels.shift();
    }
    
    chart.data.datasets[0].data.push(newValue);
    if(chart.data.datasets[0].data.length > 12) {
      chart.data.datasets[0].data.shift();
    }
    
    chart.update();
  }

  // Firebase ‡¶•‡ßá‡¶ï‡ßá ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
  function loadEnergyData() {
    database.ref('energyMonitoring').on('value', (snapshot) => {
      const data = snapshot.val();
      if(data) {
        updateEnergyData(data);
      }
    });
  }

  // Firebase ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
  function loadDataRealtime() {
    // ‡ß™‡¶ü‡¶ø ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶°‡ßá‡¶ü‡¶æ ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç
    for(let deviceNum = 1; deviceNum <= 4; deviceNum++) {
      const devicePath = 'devices/device' + deviceNum;
      const deviceKey = 'device' + deviceNum;
      
      database.ref(devicePath).on('value', snapshot => {
        const data = snapshot.val();
        if(data) {
          let activeCount = 0;
          let inactiveCount = 0;
          let warningCount = 0;
          
          // ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® (16‡¶ü‡¶ø ‡¶≤‡ßã‡¶°)
          for(let loadNum = 1; loadNum <= 16; loadNum++) {
            const key = 'Load' + loadNum;
            const value = data[key] !== undefined ? data[key] : 0;
            const elementId = 'd' + deviceNum + '-load' + loadNum;
            const statusId = 'd' + deviceNum + '-load' + loadNum + '-status';
            
            // ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            const el = document.getElementById(elementId);
            if(el) el.innerText = value === 1 ? 'ON' : value === 2 ? 'WARN' : 'OFF';
            
            // ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            const statusEl = document.getElementById(statusId);
            if(statusEl) {
              if(value === 1) {
                statusEl.textContent = '‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠';
                statusEl.className = 'card-status status-active';
                activeCount++;
              } else if(value === 2) {
                statusEl.textContent = '‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ';
                statusEl.className = 'card-status status-warning';
                warningCount++;
              } else {
                statusEl.textContent = '‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠';
                statusEl.className = 'card-status status-inactive';
                inactiveCount++;
              }
            }
          }
          
          // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
          document.getElementById(`d${deviceNum}-active-count`).textContent = activeCount;
          document.getElementById(`d${deviceNum}-inactive-count`).textContent = inactiveCount;
          document.getElementById(`d${deviceNum}-warning-count`).textContent = warningCount;
          
          // ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
          if(deviceCharts[deviceKey]) {
            deviceCharts[deviceKey].data.datasets[0].data = [activeCount, warningCount, inactiveCount];
            deviceCharts[deviceKey].update();
          }
        }
      });
    }
  }

  // ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú
  function initAdvancedEnergyChart() {
    const ctx = document.getElementById('advanced-energy-chart').getContext('2d');
    
    advancedEnergyChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: '‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú (V)',
          data: [],
          borderColor: 'rgba(230, 126, 34, 1)',
          backgroundColor: 'rgba(230, 126, 34, 0.1)',
          borderWidth: 2,
          tension: 0.4,
          fill: true
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            labels: {
              color: 'var(--text-color)'
            }
          },
          tooltip: {
            mode: 'index',
            intersect: false,
          }
        },
        scales: {
          x: {
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'var(--text-color)'
            }
          },
          y: {
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'var(--text-color)'
            }
          }
        }
      }
    });
  }

  // ‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∞‡ßá‡¶û‡ßç‡¶ú ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®
  function changeTimeRange(minutes) {
    selectedTimeRange = minutes;
    
    // Update active button
    document.querySelectorAll('.time-btn').forEach(btn => {
      btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Update chart title
    document.getElementById('advanced-graph-title').textContent = 
      `${getMetricName(selectedMetric)} ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° (${getTimeRangeText(minutes)})`;
    
    // Filter historical data
    const cutoffTime = new Date().getTime() - (minutes * 60 * 1000);
    Object.keys(historicalData).forEach(key => {
      if(parseInt(key) < cutoffTime) {
        delete historicalData[key];
      }
    });
    
    updateAdvancedChart();
  }

  // ‡¶Æ‡ßá‡¶ü‡ßç‡¶∞‡¶ø‡¶ï ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®
  function selectMetric(metric) {
    selectedMetric = metric;
    
    // Update selected card
    document.querySelectorAll('.metric-card').forEach(card => {
      card.classList.remove('selected');
    });
    event.target.closest('.metric-card').classList.add('selected');
    
    // Update chart title
    document.getElementById('advanced-graph-title').textContent = 
      `${getMetricName(metric)} ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° (${getTimeRangeText(selectedTimeRange)})`;
    
    updateAdvancedChart();
  }

  // ‡¶Æ‡ßá‡¶ü‡ßç‡¶∞‡¶ø‡¶ï ‡¶®‡¶æ‡¶Æ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function getMetricName(metric) {
    const names = {
      'voltage': '‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú',
      'current': '‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü',
      'power': '‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞',
      'energy': '‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø',
      'frequency': '‡¶´‡ßç‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶∏‡¶ø',
      'powerFactor': '‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶´‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶∞',
      'activePower': '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞',
      'reactivePower': '‡¶∞‡¶ø‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞'
    };
    return names[metric] || metric;
  }

  // ‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∞‡ßá‡¶û‡ßç‡¶ú ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function getTimeRangeText(minutes) {
    if(minutes < 60) return `${minutes} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü`;
    if(minutes < 180) return `${Math.floor(minutes/60)} ‡¶ò‡¶®‡ßç‡¶ü‡¶æ`;
    return `${Math.floor(minutes/60)} ‡¶ò‡¶®‡ßç‡¶ü‡¶æ`;
  }

  // ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
  function updateAdvancedChart() {
    if(!advancedEnergyChart) return;
    
    const timestamps = Object.keys(historicalData).sort();
    const labels = [];
    const data = [];
    
    timestamps.forEach(timestamp => {
      const date = new Date(parseInt(timestamp));
      labels.push(date.toLocaleTimeString());
      data.push(historicalData[timestamp][selectedMetric]);
    });
    
    advancedEnergyChart.data.labels = labels;
    advancedEnergyChart.data.datasets[0].data = data;
    advancedEnergyChart.data.datasets[0].label = `${getMetricName(selectedMetric)} (${getUnit(selectedMetric)})`;
    advancedEnergyChart.update();
    
    // Show/hide no data message
    document.getElementById('no-data-message').style.display = 
      data.length === 0 ? 'block' : 'none';
  }

  // ‡¶á‡¶â‡¶®‡¶ø‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function getUnit(metric) {
    const units = {
      'voltage': 'V',
      'current': 'A',
      'power': 'W',
      'energy': 'kWh',
      'frequency': 'Hz',
      'powerFactor': '',
      'activePower': 'W',
      'reactivePower': 'VAR'
    };
    return units[metric] || '';
  }

  // ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø‡¶ï‡¶æ‡¶≤ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
  function loadHistoricalData() {
    database.ref('energyHistory').on('value', (snapshot) => {
      const data = snapshot.val();
      if(data) {
        historicalData = data;
        updateAdvancedChart();
      }
    });
  }

  // ‡¶ó‡ßç‡¶∞‡¶æ‡¶´ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
  function downloadGraphData() {
    const timestamps = Object.keys(historicalData).sort();
    let csvContent = "data:text/csv;charset=utf-8,";
    
    // Header
    csvContent += "‡¶∏‡¶Æ‡¶Ø‡¶º,‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú (V),‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü (A),‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ (W),‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø (kWh),‡¶´‡ßç‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶∏‡¶ø (Hz),‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶´‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶∞,‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ (W),‡¶∞‡¶ø‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ (VAR)\n";
    
    // Data
    timestamps.forEach(timestamp => {
      const date = new Date(parseInt(timestamp));
      const row = [
        date.toLocaleString(),
        historicalData[timestamp].voltage || '',
        historicalData[timestamp].current || '',
        historicalData[timestamp].power || '',
        historicalData[timestamp].energy || '',
        historicalData[timestamp].frequency || '',
        historicalData[timestamp].powerFactor || '',
        historicalData[timestamp].activePower || '',
        historicalData[timestamp].reactivePower || ''
      ];
      csvContent += row.join(",") + "\n";
    });
    
    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", `energy_data_${new Date().toLocaleDateString()}.csv`);
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }

  // ‡¶ó‡ßç‡¶∞‡¶æ‡¶´ ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü
  function printGraph() {
    const canvas = document.getElementById('advanced-energy-chart');
    const win = window.open('', 'Print Chart');
    win.document.write('<html><head><title>Print Chart</title></head><body>');
    win.document.write('<h1>' + document.getElementById('advanced-graph-title').textContent + '</h1>');
    win.document.write('<img src="' + canvas.toDataURL() + '"/>');
    win.document.write('</body></html>');
    win.document.close();
    win.focus();
    setTimeout(() => { win.print(); win.close(); }, 500);
  }

  // ‡¶®‡ßã‡¶ü ‡¶ì ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function showDocumentTab(tabName) {
    currentTab = tabName;
    
    // Hide all tabs
    document.querySelectorAll('.document-tab').forEach(tab => {
      tab.classList.remove('active');
    });
    
    // Show selected tab
    document.getElementById(`${tabName}-tab`).classList.add('active');
    
    // Update tab buttons
    document.querySelectorAll('.documents-tab').forEach(tab => {
      tab.classList.remove('active');
    });
    event.target.classList.add('active');
  }

  function saveNote() {
    const noteContent = document.getElementById('note-editor').value.trim();
    if(!noteContent) {
      alert('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶®‡ßã‡¶ü ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®');
      return;
    }
    
    // Extract title from first line
    const title = noteContent.split('\n')[0].replace(/^#\s*/, '') || '‡¶®‡¶§‡ßÅ‡¶® ‡¶®‡ßã‡¶ü';
    const timestamp = new Date().toLocaleString();
    const noteId = 'note-' + Date.now();
    
    // Create note object
    const note = {
      id: noteId,
      title: title,
      content: noteContent,
      date: timestamp,
      lastEdited: new Date().toISOString()
    };
    
    // Save to Firebase
    database.ref(`notes/${noteId}`).set(note)
      .then(() => {
        // Add to local notes object
        notes[noteId] = note;
        
        // Add to UI
        addNoteToUI(note);
        
        // Clear editor
        document.getElementById('note-editor').value = '';
        
        alert('‡¶®‡ßã‡¶ü ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
      })
      .catch(error => {
        console.error('Error saving note:', error);
        alert('‡¶®‡ßã‡¶ü ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
      });
  }

  function addNoteToUI(note) {
    const notesList = document.getElementById('saved-notes');
    
    const noteItem = document.createElement('div');
    noteItem.className = 'document-item';
    noteItem.innerHTML = `
      <div class="document-info">
        <div class="document-name">${note.title}</div>
        <div class="document-date">‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ: ${note.date}</div>
      </div>
      <div class="document-actions">
        <button class="document-btn view" onclick="viewNote('${note.id}')">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
        <button class="document-btn delete" onclick="deleteNote('${note.id}')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
      </div>
    `;
    
    notesList.insertBefore(noteItem, notesList.firstChild);
  }

  function viewNote(noteId) {
    const note = notes[noteId];
    if(note) {
      openNoteModal(note.content);
    } else {
      alert('‡¶®‡ßã‡¶ü ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø');
    }
  }

  function deleteNote(noteId) {
    if(confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶®‡ßã‡¶ü ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
      // Delete from Firebase
      database.ref(`notes/${noteId}`).remove()
        .then(() => {
          // Remove from local notes object
          delete notes[noteId];
          
          // Remove from UI
          const notesList = document.getElementById('saved-notes');
          const noteItems = notesList.querySelectorAll('.document-item');
          
          noteItems.forEach(item => {
            if(item.querySelector('.document-btn.delete').onclick.toString().includes(noteId)) {
              item.remove();
            }
          });
          
          alert('‡¶®‡ßã‡¶ü ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
        })
        .catch(error => {
          console.error('Error deleting note:', error);
          alert('‡¶®‡ßã‡¶ü ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
        });
    }
  }

  function clearEditor() {
    if(confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶°‡¶ø‡¶ü‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
      document.getElementById('note-editor').value = '';
    }
  }

  function handleFileUpload(event) {
    const file = event.target.files[0];
    if(!file) return;
    
    // Check file size (max 10MB)
    if(file.size > 10 * 1024 * 1024) {
      alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú 10MB ‡¶è‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ');
      return;
    }
    
    // Check file extension
    const validExtensions = ['.zip', '.rar', '.7zip'];
    const fileExt = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
    if(!validExtensions.includes(fileExt)) {
      alert('‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ZIP, RAR ‡¶¨‡¶æ 7ZIP ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá');
      return;
    }
    
    // Upload to Firebase Storage
    const storageRef = storage.ref(`files/${file.name}`);
    const uploadTask = storageRef.put(file);
    
    uploadTask.on('state_changed',
      (snapshot) => {
        // Progress monitoring can be added here
        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
        console.log('Upload is ' + progress + '% done');
      },
      (error) => {
        console.error('Upload error:', error);
        alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
      },
      () => {
        // Upload complete
        uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
          // Save file info to database
          const fileId = 'file-' + Date.now();
          const fileInfo = {
            id: fileId,
            name: file.name,
            size: (file.size / (1024 * 1024)).toFixed(2) + 'MB',
            url: downloadURL,
            uploadedAt: new Date().toLocaleString(),
            timestamp: new Date().toISOString()
          };
          
          database.ref(`files/${fileId}`).set(fileInfo)
            .then(() => {
              // Add to local files object
              files[fileId] = fileInfo;
              
              // Add to UI
              addFileToUI(fileInfo);
              
              // Clear file input
              event.target.value = '';
              
              alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
            })
            .catch(error => {
              console.error('Error saving file info:', error);
              alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
            });
        });
      }
    );
  }

  function addFileToUI(file) {
    const filesList = document.getElementById('saved-files');
    
    const fileItem = document.createElement('div');
    fileItem.className = 'document-item';
    fileItem.innerHTML = `
      <div class="document-info">
        <div class="document-name">${file.name}</div>
        <div class="document-date">‡¶Ü‡¶™‡¶≤‡ßã‡¶°: ${file.uploadedAt} | ‡¶∏‡¶æ‡¶á‡¶ú: ${file.size}</div>
      </div>
      <div class="document-actions">
        <button class="document-btn download" onclick="downloadFile('${file.id}')">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</button>
        <button class="document-btn delete" onclick="deleteFile('${file.id}')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
      </div>
    `;
    
    filesList.insertBefore(fileItem, filesList.firstChild);
  }

  function downloadFile(fileId) {
    const file = files[fileId];
    if(file) {
      const link = document.createElement('a');
      link.href = file.url;
      link.download = file.name;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    } else {
      alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø');
    }
  }

  function deleteFile(fileId) {
    if(confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
      const file = files[fileId];
      if(!file) return;
      
      // Delete from Firebase Storage
      const storageRef = storage.refFromURL(file.url);
      storageRef.delete()
        .then(() => {
          // Delete from database
          return database.ref(`files/${fileId}`).remove();
        })
        .then(() => {
          // Remove from local files object
          delete files[fileId];
          
          // Remove from UI
          const filesList = document.getElementById('saved-files');
          const fileItems = filesList.querySelectorAll('.document-item');
          
          fileItems.forEach(item => {
            if(item.querySelector('.document-btn.delete').onclick.toString().includes(fileId)) {
              item.remove();
            }
          });
          
          alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
        })
        .catch(error => {
          console.error('Error deleting file:', error);
          alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
        });
    }
  }

  function loadNotesAndFiles() {
    // Load notes
    database.ref('notes').on('value', (snapshot) => {
      const data = snapshot.val();
      if(data) {
        notes = data;
        const notesList = document.getElementById('saved-notes');
        notesList.innerHTML = '';
        
        Object.keys(notes).forEach(noteId => {
          addNoteToUI(notes[noteId]);
        });
      }
    });
    
    // Load files
    database.ref('files').on('value', (snapshot) => {
      const data = snapshot.val();
      if(data) {
        files = data;
        const filesList = document.getElementById('saved-files');
        filesList.innerHTML = '';
        
        Object.keys(files).forEach(fileId => {
          addFileToUI(files[fileId]);
        });
      }
    });
  }

  // ‡¶è‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡ßÄ ‡¶™‡ßç‡¶∞‡ßá‡¶∏ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶≤‡¶ó‡¶ø‡¶® ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞
  document.getElementById("password").addEventListener("keypress", function(event) {
    if (event.key === "Enter") {
      checkPassword();
    }
  });

  // ‡¶™‡ßá‡¶á‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®
  window.onload = function() {
    createParticles();
    loadThemePreference();
    
    // ‡¶®‡¶§‡ßÅ‡¶® CSS ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
      }
    `;
    document.head.appendChild(style);
  };
</script>
</body>
</html>