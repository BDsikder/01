<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BISNU IoT ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --light-color: #ecf0f1;
      --dark-color: #2c3e50;
      --success-color: #2ecc71;
      --warning-color: #f39c12;
      --info-color: #1abc9c;
      --energy-color: #9b59b6;
      --voltage-color: #e67e22;
      --current-color: #1abc9c;
      --power-color: #3498db;
      --background-image: url('ai-generated-7945689.jpg');
      --card-bg: rgba(44, 62, 80, 0.8);
      --text-color: #ecf0f1;
      --nav-bg: rgba(44, 62, 80, 0.8);
      --login-bg: rgba(44, 62, 80, 0.9);
    }

    .light-theme {
      --primary-color: #3498db;
      --secondary-color: #2980b9;
      --accent-color: #e74c3c;
      --light-color: #f5f5f5;
      --dark-color: #ffffff;
      --success-color: #27ae60;
      --warning-color: #f39c12;
      --info-color: #16a085;
      --energy-color: #8e44ad;
      --voltage-color: #d35400;
      --current-color: #16a085;
      --power-color: #2980b9;
      --background-image: url('mars-67522.jpg');
      --card-bg: rgba(255, 255, 255, 0.9);
      --text-color: #2c3e50;
      --nav-bg: rgba(255, 255, 255, 0.9);
      --login-bg: rgba(255, 255, 255, 0.95);
    }
    
    body {
      font-family: 'Titillium Web', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--background-image) no-repeat center center fixed;
      background-size: cover;
      color: var(--text-color);
      transition: all 0.5s ease;
    }
    
    /* ‡¶≤‡¶ï ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .login-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, rgba(44, 62, 80, 0.95) 0%, rgba(52, 152, 219, 0.9) 100%);
      backdrop-filter: blur(10px);
      z-index: 1000;
      flex-direction: column;
      overflow: hidden;
    }
    
    .login-particles {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    
    .particle {
      position: absolute;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 50%;
      animation: float 15s infinite linear;
    }
    
    @keyframes float {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(-1000px) rotate(720deg);
        opacity: 0;
      }
    }
    
    .login-logo-container {
      position: relative;
      width: 180px;
      height: 180px;
      margin-bottom: 20px;
      perspective: 1000px;
    }
    
    .login-logo {
      width: 100%;
      height: 100%;
      object-fit: contain;
      animation: rotate 20s linear infinite, pulse 4s ease-in-out infinite;
      filter: drop-shadow(0 0 15px rgba(52, 152, 219, 0.7));
    }
    
    .login-logo-ring {
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      border: 5px solid transparent;
      border-top-color: var(--secondary-color);
      border-radius: 50%;
      animation: spin 3s linear infinite;
      z-index: -1;
    }
    
    .login-logo-ring:nth-child(2) {
      border-top-color: var(--accent-color);
      animation-duration: 4s;
      animation-direction: reverse;
    }
    
    .login-logo-ring:nth-child(3) {
      border-top-color: var(--success-color);
      animation-duration: 5s;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .login-box {
      background: var(--login-bg);
      padding: 2.5rem;
      border-radius: 20px;
      width: 400px;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      text-align: center;
      border-top: 3px solid var(--secondary-color);
      animation: fadeIn 0.8s ease-in-out, slideUp 0.8s ease-in-out;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .login-box::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        to bottom right,
        transparent 45%,
        rgba(52, 152, 219, 0.3) 50%,
        transparent 55%
      );
      animation: shine 4s infinite;
      z-index: -1;
    }
    
    @keyframes shine {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideUp {
      from { transform: translateY(50px); }
      to { transform: translateY(0); }
    }

    @keyframes slideIn {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }
    
    .login-box h2 {
      margin-bottom: 1.5rem;
      color: var(--text-color);
      font-weight: 600;
      font-size: 1.8rem;
      text-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .input-group {
      margin-bottom: 1.5rem;
      position: relative;
    }
    
    .input-group input {
      width: 90%;
      padding: 15px 20px;
      border: none;
      border-radius: 50px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-color);
      font-size: 16px;
      border-left: 3px solid transparent;
      transition: all 0.3s ease;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
      backdrop-filter: blur(5px);
    }
    
    .input-group input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-left: 3px solid var(--secondary-color);
      box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
    }
    
    .input-group::after {
      content: 'üîí';
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0.5;
    }
    
    .login-btn {
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      width: 100%;
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
      position: relative;
      overflow: hidden;
    }
    
    .login-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(52, 152, 219, 0.6);
    }
    
    .login-btn:active {
      transform: translateY(1px);
    }
    
    .login-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }
    
    .login-btn:hover::before {
      left: 100%;
    }
    
    .error-message {
      color: var(--accent-color);
      margin-top: 1rem;
      font-size: 14px;
      height: 20px;
      animation: shake 0.5s ease-in-out;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-5px); }
      40%, 80% { transform: translateX(5px); }
    }
    
    .login-footer {
      margin-top: 20px;
      font-size: 14px;
      opacity: 0.7;
      color: var(--text-color);
      animation: fadeIn 2s ease-in-out;
    }
    
    /* ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    #app {
      display: none;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .dashboard-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
    }
    
    /* ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡ßã‡¶ó‡ßã ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ - ‡¶Æ‡ßÇ‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø */
    .app-logo-container {
      position: relative;
      width: 100px;
      height: 100px;
      margin-bottom: 15px;
      perspective: 1000px;
    }
    
    .app-logo {
      width: 100%;
      height: 100%;
      object-fit: contain;
      animation: rotate 20s linear infinite, pulse 4s ease-in-out infinite;
      filter: drop-shadow(0 0 15px rgba(52, 152, 219, 0.7));
    }
    
    .app-logo-ring {
      position: absolute;
      top: -5px;
      left: -5px;
      right: -5px;
      bottom: -5px;
      border: 3px solid transparent;
      border-top-color: var(--secondary-color);
      border-radius: 50%;
      animation: spin 3s linear infinite;
      z-index: -1;
    }
    
    .app-logo-ring:nth-child(2) {
      border-top-color: var(--accent-color);
      animation-duration: 4s;
      animation-direction: reverse;
    }
    
    .app-logo-ring:nth-child(3) {
      border-top-color: var(--success-color);
      animation-duration: 5s;
    }

    .dashboard-title {
      font-size: 1.8rem;
      font-weight: 500;
      color: var(--text-color);
      text-align: center;
    }

    .header-controls {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-top: 15px;
    }
    
    .logout-btn {
      background: var(--accent-color);
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .logout-btn:hover {
      background: #c0392b;
      transform: translateY(-2px);
    }

    .theme-toggle {
      position: relative;
      width: 60px;
      height: 30px;
      background: var(--secondary-color);
      border-radius: 15px;
      cursor: pointer;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .theme-toggle input {
      display: none;
    }

    .theme-slider {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      transition: all 0.4s ease;
    }

    .theme-slider:before {
      content: "";
      position: absolute;
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: white;
      top: 2px;
      left: 2px;
      transition: all 0.4s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .theme-toggle input:checked + .theme-slider {
      background: var(--primary-color);
    }

    .theme-toggle input:checked + .theme-slider:before {
      transform: translateX(30px);
    }

    .theme-icon {
      position: absolute;
      color: white;
      font-size: 14px;
      top: 50%;
      transform: translateY(-50%);
    }

    .sun-icon {
      left: 7px;
    }

    .moon-icon {
      right: 7px;
    }
    
    /* --- .nav-tabs ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡ß©‡¶°‡¶ø ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® --- */
    .nav-tabs {
      display: flex;
      background: var(--nav-bg);
      border-radius: 12px; /* ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∞‡ßá‡¶°‡¶ø‡ßü‡¶æ‡¶∏ ‡¶¨‡¶æ‡ßú‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá */
      overflow-x: auto;
      margin-bottom: 2rem;
      /* ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶∂‡ßç‡¶Ø‡¶æ‡¶°‡ßã ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡ß©‡¶°‡¶ø ‡¶è‡¶´‡ßá‡¶ï‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), inset 0 1px 1px rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1); /* ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
      transition: all 0.4s ease-in-out; /* ‡¶∏‡ßç‡¶Æ‡ßÅ‡¶• ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡¶ø‡¶∂‡¶® */
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .nav-tabs:hover {
      transform: translateY(-3px); /* ‡¶π‡ßã‡¶≠‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ü‡¶æ ‡¶â‡¶™‡¶∞‡ßá ‡¶â‡¶†‡¶¨‡ßá */
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4), inset 0 1px 1px rgba(255, 255, 255, 0.1);
    }

    .nav-tabs::-webkit-scrollbar {
        display: none;
    }
    /* --- .nav-tabs ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® ‡¶∂‡ßá‡¶∑ --- */
    
    .nav-tab {
      flex: 1 0 auto;
      text-align: center;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      color: var(--text-color);
      white-space: nowrap;
    }
    
    .nav-tab:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .nav-tab.active {
      background: rgba(52, 152, 219, 0.2);
      border-bottom: 3px solid var(--secondary-color);
    }
    
    .device-page {
      display: none;
      animation: fadeIn 0.5s ease;
    }
    
    .device-page.active {
      display: block;
    }
    
    .device-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .device-card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border-left: 4px solid var(--secondary-color);
    }
    
    .device-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .card-title {
      font-size: 1rem;
      font-weight: 500;
      color: var(--text-color);
    }
    
    .card-status {
      padding: 4px 8px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      color: white;
    }
    
    .status-active {
      background: var(--success-color);
    }
    
    .status-inactive {
      background: var(--accent-color);
    }
    
    .status-warning {
      background: var(--warning-color);
    }
    
    .card-value {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 10px 0;
      text-align: center;
      color: var(--text-color);
    }
    
    .card-footer {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    
    .card-btn {
      padding: 6px 12px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      font-size: 12px;
      color: white;
    }
    
    .btn-on {
      background: var(--success-color);
    }
    
    .btn-off {
      background: var(--accent-color);
    }
    
    .btn-warning {
      background: var(--warning-color);
    }
    
    .btn-info {
      background: var(--info-color);
    }
    
    .device-status-summary {
      display: flex;
      justify-content: space-around;
      background: var(--card-bg);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    
    .status-item {
      text-align: center;
    }
    
    .status-count {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-color);
    }
    
    .status-label {
      font-size: 0.9rem;
      opacity: 0.8;
      color: var(--text-color);
    }
    
    .analytics-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .chart-container, .log-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      animation: slideIn 0.5s ease;
    }
    
    .section-title {
      font-size: 1.2rem;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--text-color);
    }
    
    .log-list {
      max-height: 300px;
      overflow-y: auto;
    }
    
    .log-item {
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.9rem;
    }
    
    .log-time {
      color: var(--secondary-color);
      font-size: 0.8rem;
    }
    
    .log-message {
      margin-top: 3px;
    }
    
    .log-warning {
      color: var(--warning-color);
    }
    
    .log-error {
      color: var(--accent-color);
    }
    
    .log-success {
      color: var(--success-color);
    }
    
    .log-info {
      color: var(--secondary-color);
    }

    /* ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .energy-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .energy-card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border-top: 4px solid var(--secondary-color);
      animation: fadeIn 0.6s ease-in-out;
    }

    .energy-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    .energy-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--text-color);
      display: flex;
      align-items: center;
    }

    .energy-value {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 10px 0;
      color: var(--text-color);
    }

    .energy-unit {
      font-size: 1rem;
      opacity: 0.8;
      margin-left: 5px;
    }

    .voltage-card { border-top-color: var(--voltage-color); }
    .current-card { border-top-color: var(--current-color); }
    .power-card { border-top-color: var(--power-color); }
    .energy-card-main { border-top-color: var(--energy-color); }
    .frequency-card { border-top-color: var(--info-color); }
    .power-factor-card { border-top-color: var(--warning-color); }
    .active-power-card { border-top-color: var(--success-color); }
    .reactive-power-card { border-top-color: var(--accent-color); }
    /* ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .units-card { border-top-color: var(--info-color); }
    .cost-card { border-top-color: var(--success-color); }
    .timestamp-card { border-top-color: var(--warning-color); }


    .energy-graphs {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .graph-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .graph-title {
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: var(--text-color);
    }

    /* ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .time-selection {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .time-btn {
      padding: 8px 15px;
      border: none;
      border-radius: 5px;
      background: var(--secondary-color);
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .time-btn:hover {
      background: var(--primary-color);
      transform: translateY(-2px);
    }

    .time-btn.active {
      background: var(--success-color);
      box-shadow: 0 0 0 2px var(--light-color);
    }

    .metric-selection {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .metric-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    .metric-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .metric-card.selected {
      border-left-color: var(--secondary-color);
      background: rgba(52, 152, 219, 0.2);
    }

    .metric-title {
      font-weight: 600;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .metric-icon {
      font-size: 1.2rem;
    }

    .metric-description {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .advanced-graph-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      margin-bottom: 30px;
      animation: fadeIn 0.6s ease;
    }

    .graph-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .graph-controls {
      display: flex;
      gap: 10px;
    }

    .graph-btn {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      background: var(--secondary-color);
      color: white;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
    }

    .graph-btn:hover {
      background: var(--primary-color);
    }

    .no-data-message {
      text-align: center;
      padding: 20px;
      color: var(--text-color);
      opacity: 0.7;
    }

    /* ‡¶™‡ßá‡¶á‡¶ú ‡ß≠ ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .notes-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      margin-bottom: 30px;
    }

    .note-title {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: var(--secondary-color);
      border-bottom: 2px solid var(--secondary-color);
      padding-bottom: 10px;
    }

    .note-subtitle {
      font-size: 1.2rem;
      margin: 20px 0 10px;
      color: var(--secondary-color);
    }

    .note-paragraph {
      margin-bottom: 15px;
      line-height: 1.6;
      text-align: justify;
    }

    .note-letter {
      background: rgba(52, 152, 219, 0.2);
      border-left: 4px solid var(--secondary-color);
      padding: 15px;
      margin: 15px 0;
      border-radius: 0 5px 5px 0;
    }

    .note-letter-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--secondary-color);
    }

    .note-letter-content {
      line-height: 1.5;
    }

    .note-images {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }

    .note-image {
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .note-image:hover {
      transform: scale(1.02);
    }

    .note-image img {
      width: 100%;
      height: auto;
      display: block;
    }

    .note-image-caption {
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 8px;
      text-align: center;
      font-size: 0.9rem;
    }

    /* ‡¶á‡¶Æ‡ßá‡¶ú ‡¶≠‡¶ø‡¶â‡ßü‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 2000;
      overflow: auto;
      animation: fadeIn 0.3s;
    }

    .modal-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
      padding: 20px;
    }

    .modal-image {
      max-width: 200%;
      max-height: 80vh;
      object-fit: contain;
      animation: zoomIn 0.3s;
    }

    .modal-caption {
      color: white;
      text-align: center;
      margin-top: 15px;
      font-size: 1.2rem;
    }

    .close-modal {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 35px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }

    .close-modal:hover {
      color: var(--secondary-color);
    }

    @keyframes zoomIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    /* --- ‡¶™‡ßá‡¶á‡¶ú ‡ßÆ ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶° ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
    .control-section {
        background: var(--card-bg);
        border-radius: 10px;
        padding: 25px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        margin-bottom: 30px;
    }

    .control-section-title {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: var(--secondary-color);
        border-bottom: 2px solid var(--secondary-color);
        padding-bottom: 10px;
    }
    
    .toggle-switch-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); /* ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶æ‡¶á‡¶ú ‡¶¨‡¶æ‡ßú‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá */
        gap: 25px;
    }

    .toggle-switch-container {
        display: flex;
        flex-direction: column; /* ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶® ‡¶â‡¶≤‡¶Æ‡ßç‡¶¨‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã */
        background: rgba(0,0,0,0.2);
        padding: 15px;
        border-radius: 10px;
        border-left: 5px solid var(--primary-color);
        transition: all 0.3s ease;
        position: relative;
    }
    
    .toggle-switch-container:hover {
      background: rgba(0,0,0,0.3);
      border-left-color: var(--secondary-color);
    }
    
    .toggle-switch-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      margin-bottom: 10px;
    }

    .toggle-switch-label {
        font-size: 1rem;
        font-weight: 600; /* ‡¶´‡¶®‡ßç‡¶ü ‡¶Æ‡ßã‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
        color: var(--text-color);
    }

    .device-time-info {
      font-size: 0.75rem;
      opacity: 0.7;
      text-align: right;
    }

    .toggle-switch-body {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }

    .timer-btn {
      background-color: var(--info-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .timer-btn:hover {
      background-color: #16a085;
      transform: scale(1.05);
    }

    .timer-countdown {
      width: 100%;
      text-align: center;
      margin-top: 10px;
      font-size: 01.2rem;
      color: #000000;
      font-weight: 600;
      height: 20px;
}

    /* --- ‡ß©‡¶°‡¶ø ‡¶ü‡¶ó‡¶≤ ‡¶∏‡ßÅ‡¶á‡¶ö‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶â‡¶®‡ßç‡¶®‡¶§ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 70px; /* ‡¶∏‡¶æ‡¶á‡¶ú ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶®‡ßç‡¶Ø ‡¶¨‡ßú ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
        height: 38px;
    }

    .toggle-switch input { 
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #333; /* ‡¶Ö‡¶´ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡ßü ‡¶ó‡¶æ‡ßù ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶ó‡ßç‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° */
        transition: .4s;
        border-radius: 38px;
        box-shadow: inset 0 3px 5px rgba(0,0,0,0.5), 0 1px 1px rgba(255,255,255,0.1);
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 30px; /* ‡¶®‡¶¨ ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶á‡¶ú ‡¶¨‡ßú ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
        width: 30px;
        left: 4px;
        bottom: 4px;
        background: linear-gradient(to bottom, #fdfdfd, #c1c1c1);
        transition: .4s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* ‡¶¨‡¶æ‡¶â‡¶®‡ßç‡¶∏ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® */
        border-radius: 50%;
        box-shadow: 0 5px 10px rgba(0,0,0,0.4), inset 0 1px 1px rgba(255,255,255,0.7);
    }
    
    .slider:after {
      content: 'OFF';
      color: #aaa;
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 12px;
      font-weight: bold;
      transition: all 0.4s ease;
    }

    input:checked + .slider {
        background: linear-gradient(to right, #28a745, #2ecc71);
        box-shadow: inset 0 3px 5px rgba(0,0,0,0.3);
    }

    input:focus + .slider {
        box-shadow: 0 0 2px var(--success-color);
    }

    input:checked + .slider:before {
        transform: translateX(32px);
    }
    
    input:checked + .slider:after {
      content: 'ON';
      color: white;
      left: 15px;
      right: auto;
    }
    
    input:active + .slider:before {
      transform: scale(0.9);
    }
    
    input:checked:active + .slider:before {
      transform: translateX(32px) scale(0.9);
    }

    /* --- ‡¶∞‡¶ø‡¶≤‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
    .password-modal-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(8px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 3000;
      animation: fadeIn 0.3s ease-in-out;
    }

    .password-modal-box {
      background: var(--card-bg);
      padding: 30px 40px;
      border-radius: 20px;
      width: 420px;
      box-shadow: 0 15px 40px rgba(0,0,0,0.5), inset 0 2px 0 rgba(255,255,255,0.1);
      text-align: center;
      border-top: 5px solid var(--secondary-color);
      transform-style: preserve-3d;
      transform: rotateX(0deg);
      transition: transform 0.4s ease;
    }

    .password-modal-box:hover {
      transform: rotateX(5deg) translateY(-5px);
    }
    
    .password-modal-box h3 {
      color: var(--text-color);
      font-size: 1.6rem;
      margin-top: 0;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .password-modal-box p {
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 25px;
    }
    
    .password-input-group {
      position: relative;
      margin-bottom: 20px;
    }

    .password-input-group input {
      width: 100%;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.2);
      background: rgba(0,0,0,0.3);
      color: var(--text-color);
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .password-input-group input:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
    }
    
    .password-error-message {
      color: var(--accent-color);
      height: 20px;
      font-size: 0.9rem;
      margin-bottom: 10px;
    }

    .password-modal-buttons {
      display: flex;
      justify-content: space-between;
      gap: 15px;
    }
    
    .modal-btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    
    .modal-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.4);
    }
    
    .modal-btn.cancel-btn {
      background-color: var(--accent-color);
      color: white;
    }

    .modal-btn.confirm-btn {
      background-color: var(--success-color);
      color: white;
    }

    /* --- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
    .timer-modal-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(10, 20, 30, 0.7);
        backdrop-filter: blur(10px);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 4000;
        opacity: 0;
        transition: opacity 0.4s ease;
    }
    
    .timer-modal-container.show {
        opacity: 1;
    }

    .timer-modal-box {
        background: var(--card-bg);
        padding: 30px;
        border-radius: 15px;
        width: 500px;
        box-shadow: 0 20px 50px rgba(0,0,0,0.6);
        border-top: 5px solid var(--info-color);
        transform: scale(0.9);
        transition: transform 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
    }

    .timer-modal-container.show .timer-modal-box {
        transform: scale(1);
    }

    .timer-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        padding-bottom: 15px;
        margin-bottom: 20px;
    }

    .timer-modal-header h3 {
        margin: 0;
        font-size: 1.6rem;
        color: var(--info-color);
    }

    .timer-modal-close {
        font-size: 2rem;
        cursor: pointer;
        transition: transform 0.3s ease;
    }
    .timer-modal-close:hover {
        transform: rotate(90deg);
        color: var(--accent-color);
    }

    .timer-form-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .timer-form-row label {
        font-size: 1rem;
        font-weight: 500;
    }
    
    .timer-enabled-toggle {
      padding: 8px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    
    .timer-enabled-toggle.enabled {
      background: var(--success-color);
      color: white;
    }

    .timer-enabled-toggle.disabled {
      background: var(--accent-color);
      color: white;
    }
    
    .time-input-group {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .time-input-group input, .timer-form-row select {
      width: 60px;
      padding: 10px;
      text-align: center;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.2);
      color: var(--text-color);
      border-radius: 5px;
      font-size: 1rem;
    }
    .timer-form-row select {
        width: auto;
        flex-grow: 1;
    }

    /* --- ‡¶Æ‡¶ø‡¶°‡¶ø‡ßü‡¶æ ‡¶ï‡ßã‡ßü‡ßá‡¶∞‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶∞‡ßá‡¶∏‡ßç‡¶™‡¶®‡ßç‡¶∏‡¶ø‡¶≠ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® --- */
    @media (max-width: 1024px) {
      .analytics-section { grid-template-columns: 1fr; }
      .energy-graphs { grid-template-columns: 1fr; }
    }
    
    @media (max-width: 768px) {
      .login-box { width: 90%; padding: 1.5rem; }
      .login-logo-container { width: 120px; height: 120px; }
      .nav-tabs { flex-direction: row; }
      .device-cards, .energy-metrics { grid-template-columns: 1fr 1fr; }
      .device-status-summary { flex-direction: column; gap: 10px; }
      .dashboard-header { flex-direction: column; gap: 15px; align-items: flex-start; }
      .header-controls { width: 100%; justify-content: space-between; padding-right: 0; }
      .metric-selection { grid-template-columns: 1fr 1fr; }
      .password-modal-box { width: 90%; padding: 20px; }
      .note-images { grid-template-columns: 1fr; }
      .modal-image { max-width: 95%; max-height: 70vh; }
      .timer-modal-box { width: 90%; }
    }
    
    @media (max-width: 480px) {
      .device-cards, .energy-metrics, .metric-selection, .toggle-switch-grid { grid-template-columns: 1fr; }
      .login-logo-container { width: 100px; height: 100px; }
      .login-box h2 { font-size: 1.5rem; }
      .modal-image { max-width: 100%; max-height: 60vh; }
      .modal-caption { font-size: 1rem; }
      .timer-modal-box { padding: 20px; }
      .time-input-group { gap: 5px; }
      .time-input-group input { width: 50px; }
    }
  </style>
</head>
<body>

<!-- ‡¶≤‡¶ï ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® -->
<div class="login-container" id="login">
  <div class="login-particles" id="particles"></div>
  
  <div class="login-logo-container">
    <img src="Bisnu.png" class="login-logo" alt="BISNU IoT Logo">
    <div class="login-logo-ring"></div>
    <div class="login-logo-ring"></div>
    <div class="login-logo-ring"></div>
  </div>
  
  <div class="login-box">
    <h2>BISNU IoT ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
    <div class="input-group">
      <input type="password" id="password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" autocomplete="off">
    </div>
    <button class="login-btn" onclick="checkPassword()">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <div class="error-message" id="error"></div>
    <div class="login-footer">
      ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
    </div>
  </div>
</div>

<!-- ‡¶Æ‡ßÇ‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® -->
<div id="app">
  <div class="dashboard-header">
    <div class="app-logo-container">
      <img src="Bisnu.png" class="app-logo" alt="BISNU IoT Logo">
      <div class="app-logo-ring"></div>
      <div class="app-logo-ring"></div>
      <div class="app-logo-ring"></div>
    </div>
    <h1 class="dashboard-title">IoT ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</h1>
    <div class="header-controls">
      <label class="theme-toggle">
        <input type="checkbox" id="theme-toggle">
        <span class="theme-slider"></span>
        <span class="theme-icon sun-icon">‚òÄÔ∏è</span>
        <span class="theme-icon moon-icon">üåô</span>
      </label>
      <button class="logout-btn" onclick="logout()">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
    </div>
  </div>
  
  <div class="nav-tabs">
    <div class="nav-tab active" onclick="showPage(1)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß</div>
    <div class="nav-tab" onclick="showPage(2)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß®</div>
    <div class="nav-tab" onclick="showPage(3)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß©</div>
    <div class="nav-tab" onclick="showPage(4)">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß™</div>
    <div class="nav-tab" onclick="showPage(5)">‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞</div>
    <div class="nav-tab" onclick="showPage(6)">‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶ó‡ßç‡¶∞‡¶æ‡¶´</div>
    <div class="nav-tab" onclick="showPage(7)">Diagram Note File</div>
    <div class="nav-tab" onclick="showPage(8)">‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</div>
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page1" class="device-page active">
    <!-- ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
    <div class="device-status-summary" id="device1-summary">
      <div class="status-item"><div class="status-count" id="d1-active-count">0</div><div class="status-label">‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
      <div class="status-item"><div class="status-count" id="d1-inactive-count">0</div><div class="status-label">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
      <div class="status-item"><div class="status-count" id="d1-warning-count">0</div><div class="status-label">‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ</div></div>
      <div class="status-item"><div class="status-count">16</div><div class="status-label">‡¶Æ‡ßã‡¶ü ‡¶≤‡ßã‡¶°</div></div>
    </div>
    <div class="device-cards">
      <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶è‡¶∞ ‡ßß‡ß¨‡¶ü‡¶ø ‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶∞‡ßç‡¶° -->
      <script>
        for (let i = 1; i <= 16; i++) {
          document.write(`
            <div class="device-card">
              <div class="card-header"><span class="card-title">‡¶≤‡ßã‡¶° ${i}</span><span class="card-status status-inactive" id="d1-load${i}-status">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</span></div>
              <div class="card-value" id="d1-load${i}">--</div>
              <div class="card-footer">
                <button class="card-btn btn-on" onclick="controlDevice('device1', 'Load${i}', 1)">ON</button>
                <button class="card-btn btn-warning" onclick="controlDevice('device1', 'Load${i}', 2)">WARN</button>
                <button class="card-btn btn-off" onclick="controlDevice('device1', 'Load${i}', 0)">OFF</button>
              </div>
            </div>
          `);
        }
      </script>
    </div>
    <div class="analytics-section">
      <div class="chart-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ó‡ßç‡¶∞‡¶æ‡¶´</h3><canvas id="device1-chart"></canvas></div>
      <div class="log-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶≤‡¶ó</h3><div class="log-list" id="device1-logs"></div></div>
    </div>
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß® ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page2" class="device-page">
    <!-- ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
    <div class="device-status-summary" id="device2-summary">
        <div class="status-item"><div class="status-count" id="d2-active-count">0</div><div class="status-label">‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
        <div class="status-item"><div class="status-count" id="d2-inactive-count">0</div><div class="status-label">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
        <div class="status-item"><div class="status-count" id="d2-warning-count">0</div><div class="status-label">‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ</div></div>
        <div class="status-item"><div class="status-count">16</div><div class="status-label">‡¶Æ‡ßã‡¶ü ‡¶≤‡ßã‡¶°</div></div>
    </div>
    <div class="device-cards">
        <script>
            for (let i = 1; i <= 16; i++) {
                document.write(`
                <div class="device-card">
                    <div class="card-header"><span class="card-title">‡¶≤‡ßã‡¶° ${i}</span><span class="card-status status-inactive" id="d2-load${i}-status">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</span></div>
                    <div class="card-value" id="d2-load${i}">--</div>
                    <div class="card-footer">
                    <button class="card-btn btn-on" onclick="controlDevice('device2', 'Load${i}', 1)">ON</button>
                    <button class="card-btn btn-warning" onclick="controlDevice('device2', 'Load${i}', 2)">WARN</button>
                    <button class="card-btn btn-off" onclick="controlDevice('device2', 'Load${i}', 0)">OFF</button>
                    </div>
                </div>
                `);
            }
        </script>
    </div>
    <div class="analytics-section">
        <div class="chart-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß® ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ó‡ßç‡¶∞‡¶æ‡¶´</h3><canvas id="device2-chart"></canvas></div>
        <div class="log-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß® ‡¶≤‡¶ó</h3><div class="log-list" id="device2-logs"></div></div>
    </div>
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß© ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page3" class="device-page">
    <!-- ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
     <div class="device-status-summary" id="device3-summary">
        <div class="status-item"><div class="status-count" id="d3-active-count">0</div><div class="status-label">‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
        <div class="status-item"><div class="status-count" id="d3-inactive-count">0</div><div class="status-label">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
        <div class="status-item"><div class="status-count" id="d3-warning-count">0</div><div class="status-label">‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ</div></div>
        <div class="status-item"><div class="status-count">16</div><div class="status-label">‡¶Æ‡ßã‡¶ü ‡¶≤‡ßã‡¶°</div></div>
    </div>
    <div class="device-cards">
        <script>
            for (let i = 1; i <= 16; i++) {
                document.write(`
                <div class="device-card">
                    <div class="card-header"><span class="card-title">‡¶≤‡ßã‡¶° ${i}</span><span class="card-status status-inactive" id="d3-load${i}-status">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</span></div>
                    <div class="card-value" id="d3-load${i}">--</div>
                    <div class="card-footer">
                    <button class="card-btn btn-on" onclick="controlDevice('device3', 'Load${i}', 1)">ON</button>
                    <button class="card-btn btn-warning" onclick="controlDevice('device3', 'Load${i}', 2)">WARN</button>
                    <button class="card-btn btn-off" onclick="controlDevice('device3', 'Load${i}', 0)">OFF</button>
                    </div>
                </div>
                `);
            }
        </script>
    </div>
    <div class="analytics-section">
        <div class="chart-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß© ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ó‡ßç‡¶∞‡¶æ‡¶´</h3><canvas id="device3-chart"></canvas></div>
        <div class="log-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß© ‡¶≤‡¶ó</h3><div class="log-list" id="device3-logs"></div></div>
    </div>
  </div>

  <!-- ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß™ ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page4" class="device-page">
    <!-- ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
    <div class="device-status-summary" id="device4-summary">
        <div class="status-item"><div class="status-count" id="d4-active-count">0</div><div class="status-label">‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
        <div class="status-item"><div class="status-count" id="d4-inactive-count">0</div><div class="status-label">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</div></div>
        <div class="status-item"><div class="status-count" id="d4-warning-count">0</div><div class="status-label">‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ</div></div>
        <div class="status-item"><div class="status-count">16</div><div class="status-label">‡¶Æ‡ßã‡¶ü ‡¶≤‡ßã‡¶°</div></div>
    </div>
    <div class="device-cards">
        <script>
            for (let i = 1; i <= 16; i++) {
                document.write(`
                <div class="device-card">
                    <div class="card-header"><span class="card-title">‡¶≤‡ßã‡¶° ${i}</span><span class="card-status status-inactive" id="d4-load${i}-status">‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠</span></div>
                    <div class="card-value" id="d4-load${i}">--</div>
                    <div class="card-footer">
                    <button class="card-btn btn-on" onclick="controlDevice('device4', 'Load${i}', 1)">ON</button>
                    <button class="card-btn btn-warning" onclick="controlDevice('device4', 'Load${i}', 2)">WARN</button>
                    <button class="card-btn btn-off" onclick="controlDevice('device4', 'Load${i}', 0)">OFF</button>
                    </div>
                </div>
                `);
            }
        </script>
    </div>
    <div class="analytics-section">
        <div class="chart-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß™ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ó‡ßç‡¶∞‡¶æ‡¶´</h3><canvas id="device4-chart"></canvas></div>
        <div class="log-container"><h3 class="section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß™ ‡¶≤‡¶ó</h3><div class="log-list" id="device4-logs"></div></div>
    </div>
  </div>

  <!-- ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page5" class="device-page">
    <!-- ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
    <div class="energy-metrics">
      <div class="energy-card voltage-card"><div class="energy-title">‚ö° ‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú</div><div class="energy-value" id="voltage-value">-- <span class="energy-unit">V</span></div><div class="card-footer"><div class="status-label">‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú</div></div></div>
      <div class="energy-card current-card"><div class="energy-title">üîå ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü</div><div class="energy-value" id="current-value">-- <span class="energy-unit">A</span></div><div class="card-footer"><div class="status-label">‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü</div></div></div>
      <div class="energy-card power-card"><div class="energy-title">üí° ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div><div class="energy-value" id="power-value">-- <span class="energy-unit">W</span></div><div class="card-footer"><div class="status-label">‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div></div></div>
      <div class="energy-card energy-card-main"><div class="energy-title">üîã ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø</div><div class="energy-value" id="energy-value">-- <span class="energy-unit">kWh</span></div><div class="card-footer"><div class="status-label">‡¶Æ‡ßã‡¶ü ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞</div></div></div>
      <div class="energy-card frequency-card"><div class="energy-title">‚è±Ô∏è ‡¶´‡ßç‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶∏‡¶ø</div><div class="energy-value" id="frequency-value">-- <span class="energy-unit">Hz</span></div><div class="card-footer"><div class="status-label">‡¶≤‡¶æ‡¶á‡¶® ‡¶´‡ßç‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶∏‡¶ø</div></div></div>
      <div class="energy-card power-factor-card"><div class="energy-title">üìä ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶´‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶∞</div><div class="energy-value" id="power-factor-value">-- <span class="energy-unit"></span></div><div class="card-footer"><div class="status-label">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶´‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶∞</div></div></div>
      <div class="energy-card active-power-card"><div class="energy-title">üîÜ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div><div class="energy-value" id="active-power-value">-- <span class="energy-unit">W</span></div><div class="card-footer"><div class="status-label">‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div></div></div>
      <div class="energy-card reactive-power-card"><div class="energy-title">üåÄ ‡¶∞‡¶ø‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div><div class="energy-value" id="reactive-power-value">-- <span class="energy-unit">VAR</span></div><div class="card-footer"><div class="status-label">‡¶∞‡¶ø‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div></div></div>
      <div class="energy-card units-card"><div class="energy-title">‚úîÔ∏è ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶á‡¶â‡¶®‡¶ø‡¶ü</div><div class="energy-value" id="units-value">-- <span class="energy-unit">Units</span></div><div class="card-footer"><div class="status-label">‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶á‡¶â‡¶®‡¶ø‡¶ü</div></div></div>
      <div class="energy-card cost-card"><div class="energy-title">üí∞ ‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶ñ‡¶∞‡¶ö</div><div class="energy-value" id="daily-cost-value">-- <span class="energy-unit">BDT</span></div><div class="card-footer"><div class="status-label">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶®‡ßÅ‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï ‡¶ñ‡¶∞‡¶ö</div></div></div>
      <div class="energy-card timestamp-card"><div class="energy-title">üïí ‡¶ü‡¶æ‡¶á‡¶Æ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™</div><div class="energy-value" id="timestamp-value">--</div><div class="card-footer"><div class="status-label">‡¶∂‡ßá‡¶∑ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶∏‡¶Æ‡ßü</div></div></div>
    </div>
    <div class="energy-graphs">
      <div class="graph-container"><h3 class="graph-title">‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°</h3><canvas id="voltage-chart"></canvas></div>
      <div class="graph-container"><h3 class="graph-title">‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°</h3><canvas id="current-chart"></canvas></div>
      <div class="graph-container"><h3 class="graph-title">‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°</h3><canvas id="power-chart"></canvas></div>
      <div class="graph-container"><h3 class="graph-title">‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ï‡¶®‡¶ú‡¶æ‡¶Æ‡ßç‡¶™‡¶∂‡¶®</h3><canvas id="energy-chart"></canvas></div>
    </div>
  </div>

  <!-- ‡¶è‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç ‡¶™‡ßá‡¶á‡¶ú -->
  <div id="page6" class="device-page">
    <!-- ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
    <div class="time-selection">
      <button class="time-btn active" onclick="changeTimeRange(30)">‡ß©‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</button><button class="time-btn" onclick="changeTimeRange(60)">‡ßß ‡¶ò‡¶®‡ßç‡¶ü‡¶æ</button><button class="time-btn" onclick="changeTimeRange(180)">‡ß© ‡¶ò‡¶®‡ßç‡¶ü‡¶æ</button><button class="time-btn" onclick="changeTimeRange(360)">‡ß¨ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ</button><button class="time-btn" onclick="changeTimeRange(720)">‡ßß‡ß® ‡¶ò‡¶®‡ßç‡¶ü‡¶æ</button>
    </div>
    <div class="metric-selection">
      <div class="metric-card selected" onclick="selectMetric('voltage')"><div class="metric-title"><span class="metric-icon">‚ö°</span> ‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú</div><div class="metric-description">‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶™‡¶∞‡ßç‡¶Ø‡¶¨‡ßá‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</div></div>
      <div class="metric-card" onclick="selectMetric('current')"><div class="metric-title"><span class="metric-icon">üîå</span> ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü</div><div class="metric-description">‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶¨‡¶æ‡¶π ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</div></div>
      <div class="metric-card" onclick="selectMetric('power')"><div class="metric-title"><span class="metric-icon">üí°</span> ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div><div class="metric-description">‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</div></div>
      <div class="metric-card" onclick="selectMetric('energy')"><div class="metric-title"><span class="metric-icon">üîã</span> ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø</div><div class="metric-description">‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</div></div>
      <div class="metric-card" onclick="selectMetric('frequency')"><div class="metric-title"><span class="metric-icon">‚è±Ô∏è</span> ‡¶´‡ßç‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶∏‡¶ø</div><div class="metric-description">‡¶´‡ßç‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶∏‡¶ø‡¶∞ ‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø‡¶∂‡ßÄ‡¶≤‡¶§‡¶æ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</div></div>
      <div class="metric-card" onclick="selectMetric('powerFactor')"><div class="metric-title"><span class="metric-icon">üìä</span> ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶´‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶∞</div><div class="metric-description">‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶´‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶® ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</div></div>
      <div class="metric-card" onclick="selectMetric('activePower')"><div class="metric-title"><span class="metric-icon">üîÜ</span> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div><div class="metric-description">‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</div></div>
      <div class="metric-card" onclick="selectMetric('reactivePower')"><div class="metric-title"><span class="metric-icon">üåÄ</span> ‡¶∞‡¶ø‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞</div><div class="metric-description">‡¶∞‡¶ø‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°</div></div>
    </div>
    <div class="advanced-graph-container">
      <div class="graph-header"><h3 class="graph-title" id="advanced-graph-title">‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° (‡ß©‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü)</h3><div class="graph-controls"><button class="graph-btn" onclick="downloadGraphData()">‡¶°‡¶æ‡¶ü‡¶æ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</button><button class="graph-btn" onclick="printGraph()">‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü</button></div></div>
      <canvas id="advanced-energy-chart"></canvas>
      <div class="no-data-message" id="no-data-message" style="display: none;">‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∞‡ßá‡¶û‡ßç‡¶ú‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</div>
    </div>
  </div>

  <!-- ‡¶™‡ßá‡¶á‡¶ú ‡ß≠: Diagram Note File -->
  <div id="page7" class="device-page">
    <!-- ‡¶è‡¶á ‡¶™‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ -->
     <div class="notes-container">
      <h2 class="note-title">Diagram Note File</h2>
      <p class="note-paragraph">‡¶è‡¶á ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ‡¶ü‡¶ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡ßã‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶°‡¶ï‡ßÅ‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∂‡¶® ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶¨‡ßá‡•§ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ, ‡¶®‡ßã‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶¨‡ßá‡¶® ‡¶Ø‡¶æ ‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶ï‡ßç‡¶∑‡¶£‡¶æ‡¶¨‡ßá‡¶ï‡ßç‡¶∑‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º‡•§</p>
      <div class="note-letter"><div class="note-letter-title">‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡ßã‡¶ü #1</div><div class="note-letter-content">‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶ü ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡¶ü‡¶ø ‡¶®‡¶ø‡¶ö‡ßá ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶ï‡¶Æ‡ßç‡¶™‡ßã‡¶®‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶ü ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶ï‡ßã‡¶® ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶π‡¶≤‡ßá ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ü‡¶ø‡¶Æ ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶®‡•§</div></div>
      <div class="note-images">
        <div class="note-image" onclick="openImageModal('electrical-single-line-diagram-4.jpg', '‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶ü ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ')"><img src="electrical-single-line-diagram-4.jpg" alt="‡¶∏‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶ü ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ"><div class="note-image-caption">‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ï‡¶ø‡¶ü ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ</div></div>
        <div class="note-image" onclick="openImageModal('6005990.jpg', '‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶´‡ßç‡¶≤‡ßã ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü')"><img src="6005990.jpg" alt="‡¶´‡ßç‡¶≤‡ßã ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü"><div class="note-image-caption">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶´‡ßç‡¶≤‡ßã ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü</div></div>
      </div>
      <h3 class="note-subtitle">‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶¨‡ßà‡¶∂‡¶ø‡¶∑‡ßç‡¶ü‡ßç‡¶Ø</h3>
      <p class="note-paragraph">1. ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞‡¶ø‡¶Ç<br>2. ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ï‡¶®‡¶ú‡¶æ‡¶Æ‡ßç‡¶™‡¶∂‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç<br>3. ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶∏‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ<br>4. ‡¶°‡ßá‡¶ü‡¶æ ‡¶≠‡¶ø‡¶ú‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®<br>5. ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</p>
      <div class="note-letter"><div class="note-letter-title">‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡ßã‡¶ü #2</div><div class="note-letter-content">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Æ‡ßá‡¶®‡ßá ‡¶ö‡¶≤‡ßÅ‡¶®:<br>- ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶®‡¶ø‡¶®<br>- ‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡¶∂‡¶® ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ<br>- ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶ü‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ü‡¶≤‡ßã‡¶ö‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®<br>- ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶°‡¶ï‡ßÅ‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</div></div>
      <h3 class="note-subtitle">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶ø‡¶ü‡ßá‡¶ï‡¶ö‡¶æ‡¶∞</h3>
      <p class="note-paragraph">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ‡¶ü‡¶ø ‡¶§‡¶ø‡¶®‡¶ü‡¶ø ‡¶Æ‡ßÇ‡¶≤ ‡¶Ö‡¶Ç‡¶∂ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ó‡¶†‡¶ø‡¶§:<br>1. IoT ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ - ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ï‡¶æ‡¶≤‡ßá‡¶ï‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï‡¶ö‡ßÅ‡¶Ø‡¶º‡ßá‡¶∂‡¶®<br>2. ‡¶ï‡ßç‡¶≤‡¶æ‡¶â‡¶° ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ - ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú<br>3. ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶´‡ßá‡¶∏ - ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</p>
      <div class="note-images"><div class="note-image" onclick="openImageModal('https://i.ibb.co/5KJZ0Lm/system-architecture.jpg', '‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶ø‡¶ü‡ßá‡¶ï‡¶ö‡¶æ‡¶∞ ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ')"><img src="https://i.ibb.co/5KJZ0Lm/system-architecture.jpg" alt="‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶ø‡¶ü‡ßá‡¶ï‡¶ö‡¶æ‡¶∞"><div class="note-image-caption">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶ø‡¶ü‡ßá‡¶ï‡¶ö‡¶æ‡¶∞ ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ</div></div></div>
      <h3 class="note-subtitle">‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá‡¶∞ ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶® ‡¶™‡¶∞‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶®‡¶æ</h3>
      <p class="note-paragraph">- ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ú‡¶®<br>- AI-‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶Ö‡¶™‡ßç‡¶ü‡¶ø‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®<br>- ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü<br>- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ<br>- ‡¶•‡¶æ‡¶∞‡ßç‡¶°-‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶ø ‡¶á‡¶®‡ßç‡¶ü‡¶ø‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶®</p>
    </div>
  </div>
  
  <!-- ‡¶™‡ßá‡¶á‡¶ú ‡ßÆ: ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶° ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ -->
  <div id="page8" class="device-page">
    <div class="control-section">
      <h2 class="control-section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤</h2>
      <div class="toggle-switch-grid">
        <!-- ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¶‡¶ø‡ßü‡ßá ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ßß ‡¶è‡¶∞ ‡ßÆ‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≤‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá -->
        <script>
            for(let i = 1; i <= 8; i++) {
                document.write(`
                    <div class="toggle-switch-container">
                        <div class="toggle-switch-header">
                            <span class="toggle-switch-label">‡¶∞‡¶ø‡¶≤‡ßá ${i}</span>
                            <div class="device-time-info">
                                <span id="d1-relay${i}-date">--/--/----</span> <span id="d1-relay${i}-time">--:--:--</span>
                            </div>
                        </div>
                        <div class="toggle-switch-body">
                            <button class="timer-btn" onclick="openTimerModal('relay${i}')">‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞</button>
                            <label class="toggle-switch">
                                <input type="checkbox" id="d1-relay${i}-toggle" onchange="promptForRelayPassword('device1', 'relay${i}', this)">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="timer-countdown" id="timer-countdown-relay${i}"></div>
                    </div>
                `);
            }
        </script>
      </div>
    </div>

    <div class="control-section">
      <h2 class="control-section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß® ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤</h2>
      <div class="toggle-switch-grid">
        <!-- ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¶‡¶ø‡ßü‡ßá ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß® ‡¶è‡¶∞ ‡ß´‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≤‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá -->
        <script>
            for(let i = 1; i <= 5; i++) {
                document.write(`
                    <div class="toggle-switch-container">
                        <div class="toggle-switch-header">
                           <span class="toggle-switch-label">‡¶∞‡¶ø‡¶≤‡ßá ${i}</span>
                           <div class="device-time-info">
                                <span id="d2-relay${i}-date">--/--/----</span> <span id="d2-relay${i}-time">--:--:--</span>
                            </div>
                        </div>
                        <div class="toggle-switch-body">
                            <button class="timer-btn" onclick="openTimerModal('relay${i+8}')">‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞</button> <!-- ‡¶®‡ßã‡¶ü: ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
                            <label class="toggle-switch">
                                <input type="checkbox" id="d2-relay${i}-toggle" onchange="promptForRelayPassword('device2', 'relay${i}', this)">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="timer-countdown" id="timer-countdown-relay${i+8}"></div>
                    </div>
                `);
            }
        </script>
      </div>
    </div>

    <div class="control-section">
      <h2 class="control-section-title">‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß© ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤</h2>
      <div class="toggle-switch-grid">
        <!-- ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¶‡¶ø‡ßü‡ßá ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡ß© ‡¶è‡¶∞ ‡ßß‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≤‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá -->
         <script>
            for(let i = 1; i <= 1; i++) {
                document.write(`
                    <div class="toggle-switch-container">
                        <div class="toggle-switch-header">
                           <span class="toggle-switch-label">‡¶∞‡¶ø‡¶≤‡ßá ${i}</span>
                           <div class="device-time-info">
                                <span id="d3-relay${i}-date">--/--/----</span> <span id="d3-relay${i}-time">--:--:--</span>
                            </div>
                        </div>
                        <div class="toggle-switch-body">
                            <button class="timer-btn" onclick="openTimerModal('relay${i+13}')">‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞</button> <!-- ‡¶®‡ßã‡¶ü: ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
                            <label class="toggle-switch">
                                <input type="checkbox" id="d3-relay${i}-toggle" onchange="promptForRelayPassword('device3', 'relay${i}', this)">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="timer-countdown" id="timer-countdown-relay${i+13}"></div>
                    </div>
                `);
            }
        </script>
      </div>
    </div>
  </div>
</div>

<!-- ‡¶á‡¶Æ‡ßá‡¶ú ‡¶≠‡¶ø‡¶â‡ßü‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ -->
<div id="imageModal" class="image-modal">
  <span class="close-modal" onclick="closeImageModal()">&times;</span>
  <div class="modal-content"><img id="modalImage" class="modal-image" src="" alt=""><div id="modalCaption" class="modal-caption"></div></div>
</div>

<!-- ‡¶∞‡¶ø‡¶≤‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ -->
<div id="relayPasswordModal" class="password-modal-container">
  <div class="password-modal-box">
    <h3>‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶∂‡¶® ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
    <p>‡¶è‡¶á ‡¶∞‡¶ø‡¶≤‡ßá‡¶ü‡¶ø ‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®‡•§</p>
    <div class="password-input-group"><input type="password" id="relayPasswordInput" placeholder="‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" autocomplete="off"></div>
    <div class="password-error-message" id="relayPasswordError"></div>
    <div class="password-modal-buttons"><button class="modal-btn cancel-btn" onclick="cancelRelayOperation()">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button><button class="modal-btn confirm-btn" onclick="verifyAndOperateRelay()">‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div>
  </div>
</div>

<!-- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ -->
<div id="timerModal" class="timer-modal-container">
    <div class="timer-modal-box">
        <div class="timer-modal-header">
            <h3 id="timer-modal-title">‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™</h3>
            <span class="timer-modal-close" onclick="closeTimerModal()">&times;</span>
        </div>
        <div class="timer-modal-body">
            <input type="hidden" id="timer-id-input">
            
            <div class="timer-form-row">
                <label>‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</label>
                <button id="timer-enabled-btn" class="timer-enabled-toggle" onclick="toggleTimerEnabled()">‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡ßü</button>
            </div>
            
            <div class="timer-form-row">
                <label>‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶∏‡¶Æ‡ßü (HH:MM:SS)</label>
                <div class="time-input-group">
                    <input type="number" id="timer-online-h" min="0" max="23" placeholder="HH">
                    <span>:</span>
                    <input type="number" id="timer-online-m" min="0" max="59" placeholder="MM">
                    <span>:</span>
                    <input type="number" id="timer-online-s" min="0" max="59" placeholder="SS">
                </div>
            </div>
            
            <div class="timer-form-row">
                <label>‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶∏‡¶Æ‡ßü (HH:MM:SS)</label>
                <div class="time-input-group">
                    <input type="number" id="timer-offline-h" min="0" max="23" placeholder="HH">
                    <span>:</span>
                    <input type="number" id="timer-offline-m" min="0" max="59" placeholder="MM">
                    <span>:</span>
                    <input type="number" id="timer-offline-s" min="0" max="59" placeholder="SS">
                </div>
            </div>

            <div class="timer-form-row">
                <label for="timer-relay-select">‡¶ï‡ßã‡¶® ‡¶∞‡¶ø‡¶≤‡ßá?</label>
                <select id="timer-relay-select">
                    <script>
                        for(let i = 1; i <= 8; i++) {
                            document.write(`<option value="relay${i}">‡¶∞‡¶ø‡¶≤‡ßá ${i}</option>`);
                        }
                    </script>
                </select>
            </div>
            
            <div class="password-input-group" style="margin-top: 25px;">
                <input type="password" id="timerOperatingPassword" placeholder="‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®" autocomplete="off">
            </div>
            <div class="password-error-message" id="timerPasswordError"></div>

            <div class="password-modal-buttons">
                <button class="modal-btn cancel-btn" onclick="closeTimerModal()">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                <button class="modal-btn confirm-btn" onclick="saveTimerSettings()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div>
</div>


<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>



<script>
  // Firebase ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®
  const firebaseConfig = {
    apiKey: "AIzaSyATDfnefdyPAzBNKZY4VM5ja8K2-63PC-U",
    authDomain: "home-server-346b6.firebaseapp.com",
    databaseURL: "https://home-server-346b6-default-rtdb.firebaseio.com",
    projectId: "home-server-346b6",
    storageBucket: "home-server-346b6.firebasestorage.app",
    messagingSenderId: "531234227336",
    appId: "1:531234227336:web:f57f700dd6baaed4358b3d",
    measurementId: "G-QDWVP34FSX"
  };

  // Firebase ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  // ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°
  const correctPassword = "#u n*S*ibg u@";
  // ‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°
  const correctOperatingPassword = "123";

  // ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤
  const deviceCharts = {};
  let energyCharts = {};
  let advancedEnergyChart = null;
  let selectedMetric = 'voltage';
  let selectedTimeRange = 30; // ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü
  let historicalData = {};
  let relayOperationContext = null;
  let timersData = {}; // ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ ‡¶π‡¶¨‡ßá

  // ‡¶á‡¶Æ‡ßá‡¶ú ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function openImageModal(imageSrc, caption) {
    const modal = document.getElementById('imageModal');
    modal.style.display = "flex";
    document.getElementById('modalImage').src = imageSrc;
    document.getElementById('modalCaption').innerHTML = caption;
  }
  function closeImageModal() {
    document.getElementById('imageModal').style.display = "none";
  }
  window.onclick = (event) => {
    if (event.target === document.getElementById('imageModal')) closeImageModal();
  };

  // ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶ø‡¶ï‡¶≤ ‡¶§‡ßà‡¶∞‡¶ø
  function createParticles() {
    const particlesContainer = document.getElementById('particles');
    if(particlesContainer.children.length > 0) return;
    for (let i = 0; i < 30; i++) {
      const particle = document.createElement('div');
      particle.classList.add('particle');
      const size = Math.random() * 10 + 5;
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      particle.style.left = `${Math.random() * 100}%`;
      particle.style.top = `${Math.random() * 100}%`;
      particle.style.animationDelay = `${Math.random() * 15}s`;
      particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
      particle.style.opacity = Math.random() * 0.5 + 0.1;
      particlesContainer.appendChild(particle);
    }
  }

  // ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function checkPassword() {
    if (document.getElementById("password").value === correctPassword) {
      document.getElementById("login").style.display = "none";
      document.getElementById("app").style.display = "block";
      initializeApp();
    } else {
      document.getElementById("error").innerText = "‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°!";
      document.querySelector(".login-box").style.animation = "shake 0.5s ease-in-out";
      setTimeout(() => { document.querySelector(".login-box").style.animation = ""; }, 500);
    }
  }
  
  // ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function initializeApp() {
      loadDataRealtime();
      initializeCharts();
      loadThemePreference();
      initEnergyCharts();
      loadEnergyData();
      initAdvancedEnergyChart();
      loadHistoricalData();
      loadRelayStates(); 
      loadTimerData(); // ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
      startCountdownUpdater(); // ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  }

  // ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function logout() {
    document.getElementById("app").style.display = "none";
    document.getElementById("login").style.display = "flex";
    document.getElementById("password").value = "";
    document.getElementById("error").innerText = "";
  }

  // ‡¶™‡ßá‡¶á‡¶ú ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function showPage(pageNum) {
    document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.nav-tab')[pageNum-1].classList.add('active');
    document.querySelectorAll('.device-page').forEach(page => page.classList.remove('active'));
    document.getElementById('page'+pageNum).classList.add('active');
    if(pageNum === 6) updateAdvancedChart();
  }
  
  // ‡¶∞‡¶ø‡¶≤‡ßá ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶™‡¶∞)
  function controlRelay(device, relay, element) {
    const state = element.checked;
    database.ref(`devices/${device}/${relay}`).set(state);
    addLogEntry(device, `${relay} ${state ? '‡¶ö‡¶æ‡¶≤‡ßÅ' : '‡¶¨‡¶®‡ßç‡¶ß'} ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá`, state ? 'success' : 'error');
  }

  // ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ ‡ßß-‡ß™)
  function controlDevice(device, load, state) {
    database.ref(`devices/${device}/${load}`).set(state);
    const stateText = state === 1 ? '‡¶ö‡¶æ‡¶≤‡ßÅ' : state === 2 ? '‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ ‡¶Æ‡ßã‡¶°‡ßá' : '‡¶¨‡¶®‡ßç‡¶ß';
    const logType = state === 1 ? 'success' : state === 2 ? 'warning' : 'error';
    addLogEntry(device, `${load} ${stateText} ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá`, logType);
  }

  // ‡¶≤‡¶ó ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function addLogEntry(device, message, type) {
    const logList = document.getElementById(`${device}-logs`);
    if (!logList) return;
    const logItem = document.createElement('div');
    logItem.className = 'log-item';
    logItem.innerHTML = `<div class="log-time">${new Date().toLocaleString('bn-BD')}</div><div class="log-message log-${type}">${message}</div>`;
    logList.prepend(logItem);
    if (logList.children.length > 50) logList.removeChild(logList.lastChild);
  }

  // ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
  function initializeCharts() {
    for(let i = 1; i <= 4; i++) {
      const ctx = document.getElementById(`device${i}-chart`).getContext('2d');
      deviceCharts[`device${i}`] = new Chart(ctx, {
        type: 'doughnut', data: { labels: ['‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠', '‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ', '‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠'], datasets: [{ data: [0, 0, 16], backgroundColor: ['#2ecc71', '#f39c12', '#e74c3c'], borderWidth: 1 }] },
        options: { responsive: true, plugins: { legend: { labels: { color: 'var(--text-color)' } } } }
      });
    }
  }
  function updateChart(device, counts) {
    if(deviceCharts[device]) {
      deviceCharts[device].data.datasets[0].data = [counts.active, counts.warning, counts.inactive];
      deviceCharts[device].update();
    }
  }

  // ‡¶•‡¶ø‡¶Æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü
  function loadThemePreference() {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    const themeToggle = document.getElementById('theme-toggle');
    document.body.classList.toggle('light-theme', savedTheme === 'light');
    themeToggle.checked = (savedTheme === 'light');
    themeToggle.addEventListener('change', () => {
        document.body.classList.toggle('light-theme');
        localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
    });
  }

  // ‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§)
  function initEnergyCharts() { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function getChartOptions(title) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function updateEnergyData(data) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function updateEnergyChartData(chart, newValue) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function loadEnergyData() { database.ref('energymonitoring').on('value', (snapshot) => { const data = snapshot.val(); if(data) updateEnergyData(data); }); }
  function initAdvancedEnergyChart() { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function changeTimeRange(minutes) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function selectMetric(metric) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function getMetricName(metric) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function getTimeRangeText(minutes) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function updateAdvancedChart() { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function getUnit(metric) { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function loadHistoricalData() { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function downloadGraphData() { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  function printGraph() { /* ... ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶ï‡ßã‡¶° ... */ }
  
  // ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶°‡¶æ‡¶∞
  function loadDataRealtime() {
    for(let i = 1; i <= 4; i++) {
        const device = `device${i}`;
        database.ref(`devices/${device}`).on('value', snapshot => {
            const data = snapshot.val();
            if(!data) return;

            // ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ ‡ßß-‡ß™ ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            let counts = { active: 0, inactive: 0, warning: 0 };
            for(let j = 1; j <= 16; j++) {
                const load = `Load${j}`;
                const val = data[load] || 0;
                const statusEl = document.getElementById(`d${i}-load${j}-status`);
                if(statusEl) {
                    if (val === 1) { counts.active++; statusEl.className = 'card-status status-active'; statusEl.textContent = '‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠'; }
                    else if (val === 2) { counts.warning++; statusEl.className = 'card-status status-warning'; statusEl.textContent = '‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ'; }
                    else { counts.inactive++; statusEl.className = 'card-status status-inactive'; statusEl.textContent = '‡¶á‡¶®‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠'; }
                }
                const valueEl = document.getElementById(`d${i}-load${j}`);
                if (valueEl) valueEl.textContent = val === 1 ? 'ON' : val === 2 ? 'WARN' : 'OFF';
            }
            document.getElementById(`d${i}-active-count`).textContent = counts.active;
            document.getElementById(`d${i}-warning-count`).textContent = counts.warning;
            document.getElementById(`d${i}-inactive-count`).textContent = counts.inactive;
            updateChart(device, counts);
            
            // ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ ‡ßÆ ‡¶è‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ì ‡¶∏‡¶Æ‡ßü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            if (data.currentDate && data.currentTime) {
                const relaysCount = i === 1 ? 8 : i === 2 ? 5 : i === 3 ? 1 : 0;
                for (let j = 1; j <= relaysCount; j++) {
                    const dateEl = document.getElementById(`d${i}-relay${j}-date`);
                    const timeEl = document.getElementById(`d${i}-relay${j}-time`);
                    if(dateEl) dateEl.innerText = data.currentDate;
                    if(timeEl) timeEl.innerText = data.currentTime;
                }
            }
        });
    }
  }

  // ‡¶ü‡¶ó‡¶≤ ‡¶∏‡ßÅ‡¶á‡¶ö‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function loadRelayStates() {
    const devices = { device1: 8, device2: 5, device3: 1 };
    for (const device in devices) {
        for(let i = 1; i <= devices[device]; i++) {
            database.ref(`${device}/relay${i}`).on('value', snapshot => {
                const toggle = document.getElementById(`${device.replace('device', 'd')}-relay${i}-toggle`);
                if(toggle) toggle.checked = !!snapshot.val();
            });
        }
    }
  }

  // --- ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ø‡¶§ ‡¶∏‡¶ï‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---

  // Firebase ‡¶•‡ßá‡¶ï‡ßá ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç `timersData` ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤‡ßá ‡¶∞‡¶æ‡¶ñ‡ßá
  function loadTimerData() {
      database.ref('timers').on('value', snapshot => {
          timersData = snapshot.val() || {};
      });
  }
  
  // ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶™‡¶™-‡¶Ü‡¶™ ‡¶¨‡¶æ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶ñ‡ßã‡¶≤‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function openTimerModal(timerId) {
    const modal = document.getElementById('timerModal');
    const timer = timersData[timerId] || {}; // ‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶Ö‡¶¨‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®

    document.getElementById('timer-id-input').value = timerId;
    document.getElementById('timer-modal-title').innerText = `‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™: ${timerId}`;
    
    // enabled ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
    const enabledBtn = document.getElementById('timer-enabled-btn');
    if (timer.enabled) {
        enabledBtn.textContent = '‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡ßü';
        enabledBtn.className = 'timer-enabled-toggle enabled';
    } else {
        enabledBtn.textContent = '‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡ßü';
        enabledBtn.className = 'timer-enabled-toggle disabled';
    }

    // ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶∏‡¶Æ‡ßü ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
    const onlineTime = (timer.online || "00:00:00").split(':');
    const offlineTime = (timer.offline || "00:00:00").split(':');
    document.getElementById('timer-online-h').value = onlineTime[0] || '00';
    document.getElementById('timer-online-m').value = onlineTime[1] || '00';
    document.getElementById('timer-online-s').value = onlineTime[2] || '00';
    document.getElementById('timer-offline-h').value = offlineTime[0] || '00';
    document.getElementById('timer-offline-m').value = offlineTime[1] || '00';
    document.getElementById('timer-offline-s').value = offlineTime[2] || '00';
    
    // ‡¶∞‡¶ø‡¶≤‡ßá ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡¶∂‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
    document.getElementById('timer-relay-select').value = timer.relay || 'relay1';
    
    // ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
    document.getElementById('timerOperatingPassword').value = '';
    document.getElementById('timerPasswordError').innerText = '';

    modal.style.display = 'flex';
    setTimeout(() => modal.classList.add('show'), 10); // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
  }

  // ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function closeTimerModal() {
    const modal = document.getElementById('timerModal');
    modal.classList.remove('show');
    setTimeout(() => modal.style.display = 'none', 400); // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶∂‡ßá‡¶∑ ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶™‡¶∞
  }

  // ‡¶Æ‡ßã‡¶°‡¶æ‡¶≤‡ßá‡¶∞ ‡¶≠‡ßá‡¶§‡¶∞ 'enabled' ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ü‡¶ó‡¶≤ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function toggleTimerEnabled() {
    const enabledBtn = document.getElementById('timer-enabled-btn');
    if (enabledBtn.classList.contains('enabled')) {
        enabledBtn.textContent = '‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡ßü';
        enabledBtn.className = 'timer-enabled-toggle disabled';
    } else {
        enabledBtn.textContent = '‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡ßü';
        enabledBtn.className = 'timer-enabled-toggle enabled';
    }
  }

  // ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ Firebase-‡¶è ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function saveTimerSettings() {
    const password = document.getElementById('timerOperatingPassword').value;
    if (password !== correctOperatingPassword) {
        document.getElementById('timerPasswordError').innerText = '‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°!';
        return;
    }

    const timerId = document.getElementById('timer-id-input').value;
    const isEnabled = document.getElementById('timer-enabled-btn').classList.contains('enabled');
    
    // ‡¶∏‡¶Æ‡ßü ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶π‡ßá‡¶≤‡ßç‡¶™‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    const formatTime = (h, m, s) => `${h.padStart(2, '0')}:${m.padStart(2, '0')}:${s.padStart(2, '0')}`;
    
    const onlineH = document.getElementById('timer-online-h').value || '0';
    const onlineM = document.getElementById('timer-online-m').value || '0';
    const onlineS = document.getElementById('timer-online-s').value || '0';
    const offlineH = document.getElementById('timer-offline-h').value || '0';
    const offlineM = document.getElementById('timer-offline-m').value || '0';
    const offlineS = document.getElementById('timer-offline-s').value || '0';

    const newTimerData = {
        enabled: isEnabled,
        online: formatTime(onlineH, onlineM, onlineS),
        offline: formatTime(offlineH, offlineM, offlineS),
        relay: document.getElementById('timer-relay-select').value
    };

    database.ref(`timers/${timerId}`).set(newTimerData)
        .then(() => {
            closeTimerModal();
        })
        .catch(error => {
            document.getElementById('timerPasswordError').innerText = '‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!';
            console.error(error);
        });
  }
  
  // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
  function startCountdownUpdater() {
      setInterval(() => {
          const now = new Date();
          const currentTimeInSeconds = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
          
          Object.keys(timersData).forEach(timerId => {
              const timer = timersData[timerId];
              const countdownEl = document.getElementById(`timer-countdown-${timerId}`);
              if (!countdownEl) return;

              if (!timer.enabled) {
                  countdownEl.innerText = '';
                  return;
              }

              const parseTime = (timeStr) => {
                  const [h, m, s] = (timeStr || "0:0:0").split(':').map(Number);
                  return h * 3600 + m * 60 + s;
              };

              const onlineSeconds = parseTime(timer.online);
              const offlineSeconds = parseTime(timer.offline);

              let nextEventTime, eventName;
              
              if (currentTimeInSeconds < onlineSeconds) {
                  nextEventTime = onlineSeconds;
                  eventName = '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶π‡¶§‡ßá';
              } else if (currentTimeInSeconds < offlineSeconds) {
                  nextEventTime = offlineSeconds;
                  eventName = '‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶π‡¶§‡ßá';
              } else {
                  // ‡¥Ö‡¥ü‡µÅ‡¥§‡µç‡¥§ ‡¥¶‡¥ø‡¥µ‡¥∏‡¥§‡µç‡¥§‡µÜ ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¥∏‡¥Æ‡¥Ø‡¥Ç
                  nextEventTime = onlineSeconds + 24 * 3600;
                  eventName = '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶π‡¶§‡ßá';
              }

              let remainingSeconds = nextEventTime - currentTimeInSeconds;
              
              const h = Math.floor(remainingSeconds / 3600);
              remainingSeconds %= 3600;
              const m = Math.floor(remainingSeconds / 60);
              const s = remainingSeconds % 60;
              
              countdownEl.innerText = `${eventName}: ${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
          });
      }, 1000);
  }


  // --- ‡¶∞‡¶ø‡¶≤‡ßá ‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---
  function promptForRelayPassword(device, relay, element) {
    const currentState = !element.checked;
    element.checked = currentState;
    relayOperationContext = { device, relay, element, targetState: !currentState };
    document.getElementById('relayPasswordModal').style.display = 'flex';
    document.getElementById('relayPasswordInput').focus();
    document.getElementById('relayPasswordError').innerText = '';
  }
  function verifyAndOperateRelay() {
    if (document.getElementById('relayPasswordInput').value === correctOperatingPassword) {
      if (relayOperationContext) {
        const { device, relay, element, targetState } = relayOperationContext;
        element.checked = targetState;
        controlRelay(device, relay, element);
        closeRelayModal();
      }
    } else {
      document.getElementById('relayPasswordError').innerText = '‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°!';
    }
    document.getElementById('relayPasswordInput').value = '';
  }
  function cancelRelayOperation() { closeRelayModal(); }
  function closeRelayModal() {
    document.getElementById('relayPasswordModal').style.display = 'none';
    relayOperationContext = null;
  }

  // ‡¶è‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡ßÄ ‡¶™‡ßç‡¶∞‡ßá‡¶∏ ‡¶ï‡¶∞‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü
  document.getElementById("password").addEventListener("keypress", (e) => { if(e.key === "Enter") checkPassword(); });
  document.getElementById("relayPasswordInput").addEventListener("keypress", (e) => { if(e.key === "Enter") verifyAndOperateRelay(); });
  
  // ‡¶Ø‡¶ñ‡¶® ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá
  window.onload = function() {
    createParticles();
  };
  
  // --- ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã ---
  // (initEnergyCharts, getChartOptions, ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø)
  function initEnergyCharts() {
    const chartsToInit = { 'voltageChart': 'voltage-chart', 'currentChart': 'current-chart', 'powerChart': 'power-chart', 'energyChart': 'energy-chart' };
    Object.keys(chartsToInit).forEach(key => { if (energyCharts[key]) energyCharts[key].destroy(); });
    energyCharts.voltageChart = new Chart(document.getElementById('voltage-chart').getContext('2d'), { type: 'line', data: { labels:[], datasets: [{ label: '‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú (V)', data: [], borderColor: 'rgba(230, 126, 34, 1)', tension: 0.4, fill: true }] }, options: getChartOptions() });
    energyCharts.currentChart = new Chart(document.getElementById('current-chart').getContext('2d'), { type: 'line', data: { labels:[], datasets: [{ label: '‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü (A)', data: [], borderColor: 'rgba(26, 188, 156, 1)', tension: 0.4, fill: true }] }, options: getChartOptions() });
    energyCharts.powerChart = new Chart(document.getElementById('power-chart').getContext('2d'), { type: 'line', data: { labels:[], datasets: [{ label: '‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ (W)', data: [], borderColor: 'rgba(52, 152, 219, 1)', tension: 0.4, fill: true }] }, options: getChartOptions() });
    energyCharts.energyChart = new Chart(document.getElementById('energy-chart').getContext('2d'), { type: 'bar', data: { labels: ['‡¶∏‡¶ï‡¶æ‡¶≤', '‡¶¶‡ßÅ‡¶™‡ßÅ‡¶∞', '‡¶¨‡¶ø‡¶ï‡¶æ‡¶≤', '‡¶∞‡¶æ‡¶§'], datasets: [{ label: '‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø (kWh)', data: [0,0,0,0], backgroundColor: 'rgba(155, 89, 182, 0.7)' }] }, options: getChartOptions() });
  }
  function getChartOptions() { return { responsive: true, plugins: { legend: { labels: { color: 'var(--text-color)' } } }, scales: { x: { ticks: { color: 'var(--text-color)' } }, y: { ticks: { color: 'var(--text-color)' } } } }; }
  function updateEnergyData(data) {
    document.getElementById('voltage-value').textContent = `${(data.voltage || 0).toFixed(2)} V`;
    document.getElementById('current-value').textContent = `${(data.current || 0).toFixed(2)} A`;
    document.getElementById('power-value').textContent = `${(data.power || 0).toFixed(2)} W`;
    document.getElementById('energy-value').textContent = `${(data.energy || 0).toFixed(2)} kWh`;
    document.getElementById('frequency-value').textContent = `${(data.frequency || 0).toFixed(2)} Hz`;
    document.getElementById('power-factor-value').textContent = (data.powerFactor || 0).toFixed(2);
    document.getElementById('active-power-value').textContent = `${(data.activePower || 0).toFixed(2)} W`;
    document.getElementById('reactive-power-value').textContent = `${(data.reactivePower || 0).toFixed(2)} VAR`;
    document.getElementById('units-value').textContent = `${(data.units || 0).toFixed(2)} Units`;
    document.getElementById('daily-cost-value').textContent = `${(data.dailyCost || 0).toFixed(2)} BDT`;
    if (data.timestamp) document.getElementById('timestamp-value').textContent = new Date(data.timestamp * 1000).toLocaleString('bn-BD');
    updateEnergyChartData(energyCharts.voltageChart, data.voltage);
    updateEnergyChartData(energyCharts.currentChart, data.current);
    updateEnergyChartData(energyCharts.powerChart, data.power);
  }
  function updateEnergyChartData(chart, newValue) {
    if(!chart || newValue === undefined) return;
    chart.data.labels.push(new Date().toLocaleTimeString('bn-BD'));
    chart.data.datasets[0].data.push(newValue);
    if(chart.data.labels.length > 15) { chart.data.labels.shift(); chart.data.datasets[0].data.shift(); }
    chart.update();
  }
  function initAdvancedEnergyChart() { if (advancedEnergyChart) advancedEnergyChart.destroy(); advancedEnergyChart = new Chart(document.getElementById('advanced-energy-chart').getContext('2d'), { type: 'line', data: { labels: [], datasets: [{ data: [], tension: 0.4 }] }, options: getChartOptions() }); }
  function changeTimeRange(minutes) { selectedTimeRange = minutes; updateAdvancedChart(); }
  function selectMetric(metric) { selectedMetric = metric; updateAdvancedChart(); }
  function getMetricName(m) { return {voltage:'‡¶≠‡ßã‡¶≤‡ßç‡¶ü‡ßá‡¶ú', current:'‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü', power:'‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞', energy:'‡¶è‡¶®‡¶æ‡¶∞‡ßç‡¶ú‡¶ø'}[m] || m; }
  function updateAdvancedChart() { /* ‡¶°‡ßá‡¶ü‡¶æ ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞‡¶ø‡¶Ç ‡¶ì ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */ }

</script>
</body>
</html>

