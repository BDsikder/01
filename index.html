<!-- {{{{{{{v15.6.3 index.html}}}}}}}
 


অবশ্যই, আমি আপনার অনুরোধটি বুঝতে পেরেছি। লগইন বক্সে পাসওয়ার্ড ভুল হলে যে ভাইব্রেশন বা শেক (shake) অ্যানিমেশনটি হয়, সেটি একটি গুরুত্বপূর্ণ ভিজ্যুয়াল ফিডব্যাক এবং এটিকে অবশ্যই রাখতে হবে।

আমি নিশ্চিত করছি যে চূড়ান্ত কোডে এই অ্যানিমেশনটি সঠিকভাবে কাজ করবে। যখনই কোনো ব্যবহারকারী ভুল পাসওয়ার্ড দেবে, লগইন বক্সটি কেঁপে উঠবে এবং একটি ত্রুটি বার্তা দেখাবে।

আপনাকে কোনো কোডিং করতে হবে না। শুধু নিচের সম্পূর্ণ কোডটি কপি করে আপনার `index.html` ফাইলে পেস্ট করলেই আপনার প্রকল্পটি এই বৈশিষ্ট্যসহ সম্পূর্ণরূপে কাজ করবে।

### আপনার প্রকল্পের জন্য চূড়ান্ত এবং পরিবর্তিত HTML কোড:

```html -->


<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BISNU IoT ডিভাইস কন্ট্রোল প্যানেল</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    /* --- CSS ভ্যারিয়েবল সংজ্ঞা --- */
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --light-color: #ecf0f1;
      --dark-color: #2c3e50;
      --success-color: #2ecc71;
      --warning-color: #f39c12;
      --info-color: #1abc9c;
      --energy-color: #9b59b6;
      --voltage-color: #e67e22;
      --current-color: #1abc9c;
      --power-color: #3498db;
      --background-btn-color: #8e44ad; /* নতুন ব্যাকগ্রাউন্ড বাটনের জন্য রঙ */
      /* কার্ড এবং নেভিগেশনের জন্য গ্লাস-এর মতো এফেক্ট */
      --card-bg: rgba(44, 62, 80, 0.65);
      --nav-bg: rgba(44, 62, 80, 0.5);
      --login-bg: rgba(13, 29, 47, 0.9);
      --text-color: #ecf0f1;
    }

    /* --- লাইট থিম ভ্যারিয়েবল --- */
    .light-theme {
      --primary-color: #3498db;
      --secondary-color: #2980b9;
      --accent-color: #e74c3c;
      --light-color: #f5f5f5;
      --dark-color: #ffffff;
      --success-color: #27ae60;
      --warning-color: #f39c12;
      --info-color: #16a085;
      --energy-color: #8e44ad;
      --voltage-color: #d35400;
      --current-color: #16a085;
      --power-color: #2980b9;
      --card-bg: rgba(255, 255, 255, 0.7);
      --text-color: #2c3e50;
      --nav-bg: rgba(255, 255, 255, 0.6);
      --login-bg: rgba(255, 255, 255, 0.85);
    }
    
    /* --- বেসিক বডি স্টাইল এবং ডাইনামিক ব্যাকগ্রাউন্ড --- */
    body {
      font-family: 'Titillium Web', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      color: var(--text-color);
      transition: background-color 0.5s ease;
      overflow-x: hidden; /* সাইড স্ক্রলিং প্রতিরোধ */
    }

    /* অ্যাপ্লিকেশনের মূল ব্যাকগ্রাউন্ডের জন্য একটি আলাদা লেয়ার তৈরি করা হয়েছে */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      z-index: -1;
      background-size: cover;
      background-position: center;
      transition: background-image 1s ease-in-out, opacity 1s ease-in-out; /* মসৃণ ট্রানজিশন */
      background-color: #111827; /* ইমেজ লোড হওয়ার আগে ফলব্যাক রঙ */
    }

    /* --- ব্যাকগ্রাউন্ড অ্যানিমেশন এবং ইমেজ ক্লাস --- */
    @keyframes colorfulBackground {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    /* ডিফল্ট অ্যানিমেটেড ব্যাকগ্রাউন্ড */
    body.bg-0::before {
      background-image: none;
      background-color: transparent;
      background: linear-gradient(135deg, #1f2937, #111827, #374151, #4f46e5, #7c3aed);
      background-size: 500% 500%;
      animation: colorfulBackground 25s ease infinite;
    }

    /* ১০টি ভিন্ন ব্যাকগ্রাউন্ড ইমেজের জন্য ক্লাস */
    body.bg-1::before { background-image: url('ai-generated-7945689.jpg'); }
    body.bg-2::before { background-image: url('dark-laptop-mountaintop-view-c5xvh55o47yp0axu.jpg'); }
    body.bg-3::before { background-image: url('mars-67522.jpg'); }
    body.bg-4::before { background-image: url('20250729_170502.jpg'); }
    body.bg-5::before { background-image: url('pier-7831868.jpg'); }
    body.bg-6::before { background-image: url('keyboard-7913431.jpg'); }
    body.bg-7::before { background-image: url('power-lines-1868352.jpg'); }
    body.bg-8::before { background-image: url('solar-8244680.jpg'); }
    body.bg-9::before { background-image: url('sunrise-1959227.jpg'); }
    body.bg-10::before { background-image: url('trees-407256.jpg'); }
    
    /* --- লগইন স্ক্রিনের স্টাইল --- */
    .login-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      flex-direction: column;
      overflow: hidden;
      background-color: #111827;
    }
    
    /* লগইন স্ক্রিনের জন্য একটি নির্দিষ্ট ব্যাকগ্রাউন্ড ইমেজ লেয়ার */
    .login-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('green-smooth-wooden-textured-background.jpg');
      background-size: cover;
      background-position: center;
      filter: blur(5px) brightness(0.6);
      z-index: -1;
    }
    
    .login-particles {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: -1;
    }
    
    .particle {
      position: absolute;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 50%;
      animation: float 15s infinite linear;
    }
    
    @keyframes float {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(-1000px) rotate(720deg); opacity: 0; }
    }
    
    /* --- লোগো কন্টেইনার স্টাইল --- */
    .login-logo-container {
      position: relative;
      width: 180px;
      height: 180px;
      margin-bottom: 30px;
      perspective: 1000px;
    }
    .login-logo {
      width: 100%;
      height: 100%;
      object-fit: contain;
      animation: 20000ms linear -221.503ms infinite normal none running rotate, 0s ease-in-out infinite normal none running pulse;
      filter: drop-shadow(0 0 15px rgba(52, 152, 219, 0.7));
    }
    
    /* লোগোর চারপাশের রিং অ্যানিমেশন */
    .login-logo-ring {
      position: absolute;
      top: -10px; left: -10px; right: -10px; bottom: -10px;
      border: 5px solid transparent;
      border-top-color: var(--secondary-color);
      border-radius: 50%;
      animation: spin 3s linear infinite;
      z-index: -1;
    }
    .login-logo-ring:nth-child(2) {
      border-top-color: var(--accent-color);
      animation-duration: 4s;
      animation-direction: reverse;
    }
    .login-logo-ring:nth-child(3) {
      border-top-color: var(--success-color);
      animation-duration: 5s;
    }
    
    /* অ্যানিমেশন কীফ্রেম */
    @keyframes rotate-logo { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

    /* --- RGB বর্ডারসহ লগইন বক্স --- */
    .login-box {
      font-weight: 200;
      position: relative;
      width: 520px;
      padding: 4px;
      border-radius: 22px;
      box-shadow: 4px 7px 20px 1px rgb(0 0 0);
      animation: fadeIn 0.8s ease-in-out, slideUp 0.8s ease-in-out;
      overflow: hidden;
      background: #00000000;
      backdrop-filter: blur(15px);
    }

    /* লগইন বক্সের RGB বর্ডার অ্যানিমেশন */
    .login-box::before {
      content: '';
      position: absolute;
      top: -60%;
      left: -50%;
      width: 200%;
      height: 260%;
      z-index: 1;
      background: conic-gradient(from 180deg at 50% 50%, #ff00d4, #0000ff, #00ffff, #00ff00, #ffff00, #ff8c00, #ff0000, #ff00d4);
      animation: rotate-rgb 3s linear infinite;
    }

    /* বক্সের ভেতরের কন্টেন্টকে RGB বর্ডার থেকে আলাদা করার জন্য একটি স্তর */
    .login-box-inner {
      background: rgb(0 0 0);
      border-radius: 18px;
      padding: 2.5rem;
      position: relative;
      z-index: 2;
      text-align: center;
    }
    
    /* বিভিন্ন অ্যানিমেশন */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(50px); } to { transform: translateY(0); } }
    @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
    @keyframes rotate-rgb { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    
    .login-box h2 {
      margin-top: 0;
      margin-bottom: 1.5rem;
      color: var(--text-color);
      font-weight: 600;
      font-size: 1.8rem;
      text-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .input-group {
      margin-bottom: 1.5rem;
      position: relative;
    }
    
    .input-group input {
      width: 88%;
      padding: 15px 20px;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 50px;
      background: rgba(0, 0, 0, 0.2);
      color: var(--text-color);
      font-size: 16px;
      transition: all 0.3s ease;
    }
    .input-group input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-left: 3px solid #ff0000;
      box-shadow: 3px 3px 10px rgb(255 0 0 / 88%);
    }
    
    /* লগইন বাটনের উন্নত ডিজাইন */
    .login-btn {
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      width: 100%;
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
      position: relative;
      overflow: hidden;
    }

    .login-btn:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 10px 25px rgba(223, 0, 0, 0.6);
    }
    .login-btn:active {
      transform: translateY(0) scale(1);
    }
    
    .error-message {
      color: var(--accent-color);
      margin-top: 1rem;
      font-size: 14px;
      height: 20px;
      text-shadow: 0 0 5px var(--accent-color);
    }
    
    /* --- ★★★ লগইন বক্সের ভাইব্রেশন অ্যানিমেশন ★★★ --- */
    /* ভুল পাসওয়ার্ড দিলে এই কীফ্রেমটি ব্যবহৃত হবে */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-5px); }
      40%, 80% { transform: translateX(5px); }
    }
    
    /* জাভাস্ক্রিপ্ট থেকে এই ক্লাসটি যোগ করা হবে */
    .shake-animation {
        animation: shake 0.5s ease-in-out;
    }
    
    /* --- মূল অ্যাপ্লিকেশন স্টাইল --- */
    #app {
      display: none;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .dashboard-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 2rem;
      padding: 1rem;
      background: var(--card-bg);
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
      animation: fadeIn 1s ease-in-out;
    }
    
    .app-logo-container {
      position: relative;
      width: 100px;
      height: 100px;
      margin-bottom: 15px;
    }
    .app-logo {
      width: 100%;
      height: 100%;
      object-fit: contain;
      animation: 20000ms linear -221.503ms infinite normal none running rotate, 0s ease-in-out infinite normal none running pulse;
      filter: drop-shadow(0 0 15px rgba(52, 152, 219, 0.7));
    }
    .app-logo-ring {
      position: absolute;
      top: -5px; left: -5px; right: -5px; bottom: -5px;
      border: 3px solid transparent;
      border-top-color: var(--secondary-color);
      border-radius: 50%;
      animation: spin 3s linear infinite;
    }
    .app-logo-ring:nth-child(2) { border-top-color: var(--accent-color); animation-duration: 4s; animation-direction: reverse; }
    .app-logo-ring:nth-child(3) { border-top-color: var(--success-color); animation-duration: 5s; }

    @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    .dashboard-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-color);
      text-align: center;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }

    .header-controls {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-top: 15px;
    }
    
    /* --- সকল বাটনের জন্য একটি সাধারণ ক্লাস এবং উন্নত ডিজাইন --- */
    .pro-btn {
      color: white;
      border: none;
      padding: 10px 22px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .pro-btn:hover {
      transform: translateY(-3px) scale(1.03);
      box-shadow: 0 7px 20px rgba(0,0,0,0.3);
    }
    .pro-btn:active {
      transform: translateY(0) scale(1);
    }

    /* বিভিন্ন বাটনের জন্য রঙ */
    .logout-btn { background: linear-gradient(135deg, #e74c3c, #c0392b); }
    .background-btn { background: linear-gradient(135deg, var(--background-btn-color), #6c3483); }
    .btn-on { background: linear-gradient(135deg, #2ecc71, #27ae60); }
    .btn-off { background: linear-gradient(135deg, #e74c3c, #c0392b); }
    .btn-warning { background: linear-gradient(135deg, #f39c12, #e67e22); }
    .btn-info { background: linear-gradient(135deg, #1abc9c, #16a085); }
    .timer-btn { background: linear-gradient(135deg, var(--info-color), #2980b9); }
    .modal-btn.cancel-btn { background: linear-gradient(135deg, #e74c3c, #c0392b); }
    .modal-btn.confirm-btn { background: linear-gradient(135deg, #2ecc71, #27ae60); }
    
    /* --- থিম টগল সুইচের নতুন ডিজাইন --- */
    .theme-toggle {
      position: relative;
      width: 70px;
      height: 34px;
      border-radius: 17px;
      cursor: pointer;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
    }
    .theme-toggle input { display: none; }
    .theme-slider {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      transition: all 0.4s ease;
    }
    .theme-slider:before {
      content: "";
      position: absolute;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: white;
      top: 3px;
      left: 3px;
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .theme-toggle input:checked + .theme-slider:before {
      transform: translateX(36px);
      background: #2c3e50;
    }
    .theme-icon {
      position: absolute;
      font-size: 16px;
      top: 50%;
      transform: translateY(-50%);
      transition: opacity 0.3s ease;
    }
    .sun-icon { left: 9px; opacity: 1; }
    .moon-icon { right: 9px; opacity: 1; }
    .theme-toggle input:checked ~ .sun-icon { opacity: 0; }
    .theme-toggle input:not(:checked) ~ .moon-icon { opacity: 0; }

    /* --- নেভিগেশন ট্যাবের জন্য নতুন গ্লাস ডিজাইন --- */
    .nav-tabs {
      display: flex;
      background: var(--nav-bg);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      overflow-x: auto;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
      border: 1px solid rgba(255, 255, 255, 0.18);
      padding: 5px;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .nav-tabs::-webkit-scrollbar { display: none; }
    
    .nav-tab {
      flex: 1 0 auto;
      text-align: center;
      padding: 12px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      border-radius: 10px;
      color: var(--text-color);
      white-space: nowrap;
      border: 2px solid transparent;
    }
    
    .nav-tab:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .nav-tab.active {
      background: var(--secondary-color);
      box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
      color: white;
      transform: scale(1.05);
    }
    
    /* --- ডিভাইস পেইজ অ্যানিমেশন --- */
    .device-page {
      display: none;
      animation: fadeIn 0.7s ease;
    }
    .device-page.active { display: block; }
    
    /* --- কার্ডের জন্য উন্নত ডিজাইন --- */
    .device-card, .energy-card, .chart-container, .log-container, .notes-container, .control-section, .advanced-graph-container {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        border: 1px solid rgba(255, 255, 255, 0.18);
        transition: all 0.4s ease;
    }
    .device-card:hover, .energy-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
    }
    
    .device-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .card-header {
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }
    .card-value { font-size: 1.8rem; }
    .card-footer {
      display: flex;
      justify-content: space-around;
      margin-top: 15px;
    }
    .card-btn {
        padding: 8px 15px;
        font-size: 13px;
    }
    
    .device-status-summary {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
      border: 1px solid rgba(255, 255, 255, 0.18);
    }
    
    .status-count { font-size: 1.8rem; }

    /* --- সেকশন টাইটেল ডিজাইন --- */
    .section-title, .note-title, .control-section-title {
        font-size: 1.6rem;
        margin-bottom: 20px;
        padding-bottom: 10px;
        color: var(--secondary-color);
        border-bottom: 2px solid var(--secondary-color);
        text-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
    }

    /* --- অ্যানালিটিক্স সেকশন --- */
    .analytics-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    /* --- এনার্জি মনিটরিং স্টাইল --- */
    .energy-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .energy-card {
        border-top: 4px solid var(--secondary-color);
    }

    /* --- ৩ডি টগল সুইচের উন্নত স্টাইল --- */
    .toggle-switch-container {
        display: flex;
        flex-direction: column;
        background: rgba(0,0,0,0.3);
        padding: 20px;
        border-radius: 15px;
        border-left: 5px solid var(--primary-color);
        transition: all 0.3s ease;
        box-shadow: inset 0 2px 8px rgba(0,0,0,0.4);
    }
    .toggle-switch-container:hover {
        background: rgba(0,0,0,0.4);
        border-left-color: var(--secondary-color);
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0,0,0,0.3), inset 0 2px 8px rgba(0,0,0,0.4);
    }

    .toggle-switch-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 25px;
    }

   .timer-status {
    font-size: 01.5rem;
    color: #3dff00;
    text-shadow: 0 0 5px #a01616;
    font-weight: 500;
    text-align: center;
    padding: 5px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 5px;
    min-height: 20px;
    }

    /* --- মোডাল বক্সের উন্নত ডিজাইন --- */
    .password-modal-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(10px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 3000;
      animation: fadeIn 0.4s ease-in-out;
    }
   .password-modal-box, .timer-modal-box {
     background: rgb(30 28 28 / 58%);
     backdrop-filter: blur(15px);
     padding: 30px 40px;
     border-radius: 20px;
     width: 450px;
     box-shadow: 0px 0 16px 2px rgb(219 19 255);
     border: 3px solid rgb(169 20 20);
     text-align: center;
     border-top: 5px solid #3a2e70;
    animation: slideUp 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
    }
    .timer-modal-box {
      border-top-color: #b90000;
      width: 480px;
      }
    
    .password-input-group input {
      width: 92%;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.2);
      background: rgba(0,0,0,0.3);
      color: var(--text-color);
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .password-modal-buttons {
        gap: 20px;
    }
    .modal-btn {
        flex: 1;
        padding: 12px 20px;
    }

    /* মিডিয়া কোয়েরি */
    @media (max-width: 1024px) {
      .analytics-section, .energy-graphs { grid-template-columns: 1fr; }
    }
    @media (max-width: 768px) {
      .login-box { width: 90%; padding: 4px; }
      .login-box-inner { padding: 1.5rem; }
      .nav-tabs { flex-direction: row; }
      .device-cards, .energy-metrics { grid-template-columns: 1fr 1fr; }
      .device-status-summary { grid-template-columns: 1fr 1fr; gap: 20px; }
      .dashboard-header { flex-direction: column; gap: 15px; align-items: center; }
      .header-controls { width: auto; flex-wrap: wrap; justify-content: center; }
      .password-modal-box, .timer-modal-box { 
        width: 70%; 
        padding: 17px; }
    }
    @media (max-width: 480px) {
      .device-cards, .energy-metrics, .toggle-switch-grid, .device-status-summary { grid-template-columns: 1fr; }
      .login-box h2 { font-size: 1.5rem; }
    }
      
/* অন্যান্য স্টাইল */
.login-footer {
    margin-top: 20px;
    font-size: 14px;
    opacity: 0.7;
    color: var(--text-color);
    animation: fadeIn 2s ease-in-out;
}
.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
.card-title {
    font-size: 1rem;
    font-weight: 500;
    color: var(--text-color);
}
.card-status {
    padding: 4px 8px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    color: white;
}
.status-active {
    background: var(--success-color);
}
.status-inactive {
    background: var(--accent-color);
}
.status-warning {
    background: var(--warning-color);
}
.card-value {
    margin: 10px 0;
    text-align: center;
    color: var(--text-color);
}
.status-item {
    text-align: center;
}
.status-label {
    font-size: 0.9rem;
    opacity: 0.8;
    color: var(--text-color);
}
.log-list {
    max-height: 300px;
    overflow-y: auto;
}
.log-item {
    padding: 8px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    font-size: 0.9rem;
}
.log-time {
    color: var(--secondary-color);
    font-size: 0.8rem;
}
.log-message {
    margin-top: 3px;
}
.log-warning {
    color: var(--warning-color);
}
.log-error {
    color: var(--accent-color);
}
.log-success {
    color: var(--success-color);
}
.log-info {
    color: var(--secondary-color);
}
.energy-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--text-color);
    display: flex;
    align-items: center;
}
.energy-value {
    font-size: 1.8rem;
    font-weight: 700;
    margin: 10px 0;
    color: var(--text-color);
}
.energy-unit {
    font-size: 1rem;
    opacity: 0.8;
    margin-left: 5px;
}
.voltage-card {
    border-top-color: var(--voltage-color);
}
.current-card {
    border-top-color: var(--current-color);
}
.power-card {
    border-top-color: var(--power-color);
}
.energy-card-main {
    border-top-color: var(--energy-color);
}
.frequency-card {
    border-top-color: var(--info-color);
}
.power-factor-card {
    border-top-color: var(--warning-color);
}
.active-power-card {
    border-top-color: var(--success-color);
}
.reactive-power-card {
    border-top-color: var(--accent-color);
}
.units-card {
    border-top-color: var(--info-color);
}
.cost-card {
    border-top-color: var(--success-color);
}
.timestamp-card {
    border-top-color: var(--warning-color);
}
.energy-graphs {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
    gap: 20px;
    margin-top: 30px;
}
.graph-title {
    font-size: 1.2rem;
    margin-bottom: 15px;
    color: var(--text-color);
}
.time-selection {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}
.time-btn {
    padding: 8px 15px;
    border: none;
    border-radius: 5px;
    background: var(--secondary-color);
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 14px;
}
.time-btn:hover {
    background: var(--primary-color);
    transform: translateY(-2px);
}
.time-btn.active {
    background: var(--success-color);
    box-shadow: 0 0 0 2px var(--light-color);
}
.metric-selection {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}
.metric-card {
    background: var(--card-bg);
    border-radius: 8px;
    padding: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    border-left: 4px solid transparent;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
}
.metric-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}
.metric-card.selected {
    border-left-color: var(--secondary-color);
    background: rgba(52, 152, 219, 0.2);
}
.metric-title {
    font-weight: 600;
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    gap: 8px;
}
.metric-icon {
    font-size: 1.2rem;
}
.metric-description {
    font-size: 0.8rem;
    opacity: 0.8;
}
.graph-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}
.graph-controls {
    display: flex;
    gap: 10px;
}
.graph-btn {
    padding: 5px 10px;
    border: none;
    border-radius: 4px;
    background: var(--secondary-color);
    color: white;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.3s ease;
}
.graph-btn:hover {
    background: var(--primary-color);
}
.no-data-message {
    text-align: center;
    padding: 20px;
    color: var(--text-color);
    opacity: 0.7;
}
.note-subtitle {
    font-size: 1.2rem;
    margin: 20px 0 10px;
    color: var(--secondary-color);
}
.note-paragraph {
    margin-bottom: 15px;
    line-height: 1.6;
    text-align: justify;
}
.note-letter {
    background: rgba(52, 152, 219, 0.2);
    border-left: 4px solid var(--secondary-color);
    padding: 15px;
    margin: 15px 0;
    border-radius: 0 5px 5px 0;
}
.note-letter-title {
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--secondary-color);
}
.note-letter-content {
    line-height: 1.5;
}
.note-images {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin: 25px 0;
}
.note-image {
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s ease;
    cursor: pointer;
}
.note-image:hover {
    transform: scale(1.02);
}
.note-image img {
    width: 100%;
    height: auto;
    display: block;
}
.note-image-caption {
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px;
    text-align: center;
    font-size: 0.9rem;
}
.image-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    overflow: auto;
    animation: fadeIn 0.3s;
}
.modal-content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100%;
    padding: 20px;
}
.modal-image {
    max-width: 200%;
    max-height: 80vh;
    object-fit: contain;
    animation: zoomIn 0.3s;
}
.modal-caption {
    color: white;
    text-align: center;
    margin-top: 15px;
    font-size: 1.2rem;
}
.close-modal {
    position: absolute;
    top: 20px;
    right: 30px;
    color: white;
    font-size: 35px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
}
.close-modal:hover {
    color: var(--secondary-color);
}
@keyframes zoomIn {
    from {
        transform: scale(0.8);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}
.toggle-switch-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    margin-bottom: 10px;
}
.toggle-switch-label {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-color);
}
.device-time-info {
    font-size: 0.8rem;
    opacity: 0.8;
    text-align: right;
}
.device-time-info span {
    display: block;
}
.toggle-switch-body {
    width: 100%;
    margin-bottom: 15px;
    min-height: 20px;
}
.toggle-switch-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
}
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 70px;
    height: 38px;
}
.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}
.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #333;
    transition: .4s;
    border-radius: 38px;
    box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.5), 0 1px 1px rgba(255, 255, 255, 0.1);
}
.slider:before {
    position: absolute;
    content: "";
    height: 30px;
    width: 30px;
    left: 4px;
    bottom: 4px;
    background: linear-gradient(to bottom, #fdfdfd, #c1c1c1);
    transition: .4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    border-radius: 50%;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4), inset 0 1px 1px rgba(255, 255, 255, 0.7);
}
.slider:after {
    content: 'OFF';
    color: #aaa;
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 12px;
    font-weight: bold;
    transition: all 0.4s ease;
}
input:checked+.slider {
    background: linear-gradient(to right, #28a745, #2ecc71);
    box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.3);
}
input:focus+.slider {
    box-shadow: 0 0 2px var(--success-color);
}
input:checked+.slider:before {
    transform: translateX(32px);
}
input:checked+.slider:after {
    content: 'ON';
    color: white;
    left: 15px;
    right: auto;
}
input:active+.slider:before {
    transform: scale(0.9);
}
input:checked:active+.slider:before {
    transform: translateX(32px) scale(0.9);
}
.password-modal-box h3 {
    color: var(--text-color);
    font-size: 1.6rem;
    margin-top: 0;
    margin-bottom: 10px;
    font-weight: 600;
}
.password-modal-box p {
    color: var(--text-color);
    opacity: 0.8;
    margin-bottom: 25px;
}
.password-input-group {
    position: relative;
    margin-bottom: 20px;
}
.password-input-group input:focus {
    outline: none;
    border-color: var(--secondary-color);
    box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
}
.password-error-message {
    color: var(--accent-color);
    height: 20px;
    font-size: 0.9rem;
    margin-bottom: 10px;
}
.password-modal-buttons {
    display: flex;
    justify-content: space-between;
}
.timer-modal-box h3 {
    font-size: 1.8rem;
    color: var(--text-color);
    margin-bottom: 20px;
    text-align: center;
}
.timer-form {
    display: flex;
    flex-direction: column;
    gap: 18px;
    margin-bottom: 20px;
}
.timer-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(0, 0, 0, 0.15);
    padding: 10px 15px;
    border-radius: 8px;
}
.timer-row label {
    font-weight: 500;
    font-size: 1rem;
}
#timer-enabled-btn.enabled {
    background-color: var(--success-color);
}
#timer-enabled-btn.disabled {
    background-color: var(--accent-color);
}
.timer-time-input,
.timer-select {
    background-color: rgba(0, 0, 0, 0.3);
    color: var(--text-color);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 5px;
    padding: 8px;
    font-size: 1rem;
    width: 180px;
}
.timer-note {
    font-size: 0.9rem;
    text-align: center;
    opacity: 0.8;
    margin-bottom: 15px;
}
.modal-btn {
    flex: .90;
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 5px 4px 6px 4px rgba(0, 0, 0, 0.3);
}
  </style>
</head>
<body class="bg-0"> <!-- ডিফল্ট ব্যাকগ্রাউন্ড ক্লাস -->

<!-- লক স্ক্রিন -->
<div class="login-container" id="login">
  <div class="login-particles" id="particles"></div>
  
  <div class="login-logo-container">
    <img src="Bisnu.png" class="login-logo" alt="BISNU IoT Logo">
    <div class="login-logo-ring"></div>
    <div class="login-logo-ring"></div>
    <div class="login-logo-ring"></div>
  </div>
  
  <div class="login-box">
    <div class="login-box-inner">
      <h2>BISNU IoT কন্ট্রোল প্যানেল</h2>
      <div class="input-group">
        <input type="password" id="password" placeholder="পাসওয়ার্ড লিখুন" autocomplete="off">
      </div>
      <button class="login-btn" onclick="checkPassword()">লগইন করুন</button>
      <div class="error-message" id="error"></div>
      <div class="login-footer">
        শুধুমাত্র অনুমোদিত ব্যবহারকারীদের জন্য
      </div>
    </div>
  </div>
</div>

<!-- মূল অ্যাপ্লিকেশন -->
<div id="app">
  <header class="dashboard-header">
    <div class="app-logo-container">
      <img src="Bisnu.png" class="app-logo" alt="BISNU IoT Logo">
      <div class="app-logo-ring"></div>
      <div class="app-logo-ring"></div>
      <div class="app-logo-ring"></div>
    </div>
    
    <h1 class="dashboard-title">IoT ডিভাইস মনিটরিং সিস্টেম</h1>
    
    <div class="header-controls">
      <label class="theme-toggle">
        <input type="checkbox" id="theme-toggle">
        <span class="theme-slider"></span>
        <span class="theme-icon sun-icon">☀️</span>
        <span class="theme-icon moon-icon">🌙</span>
      </label>
      <button class="pro-btn background-btn" onclick="changeBackground()">🖼️ ব্যাকগ্রাউন্ড</button>
      <button class="pro-btn logout-btn" onclick="logout()">লগআউট</button>
    </div>
  </header>
  
  <nav class="nav-tabs">
    <div class="nav-tab active" onclick="showPage(1)">ডিভাইস ১</div>
    <div class="nav-tab" onclick="showPage(2)">ডিভাইস ২</div>
    <div class="nav-tab" onclick="showPage(3)">ডিভাইস ৩</div>
    <div class="nav-tab" onclick="showPage(4)">ডিভাইস ৪</div>
    <div class="nav-tab" onclick="showPage(5)">এনার্জি মনিটর</div>
    <div class="nav-tab" onclick="showPage(6)">এডভান্সড গ্রাফ</div>
    <div class="nav-tab" onclick="showPage(7)">Diagram Note File</div>
    <div class="nav-tab" onclick="showPage(8)">কন্ট্রোল প্যানেল</div>
  </nav>

  <!-- ডিভাইস ১ পেইজ -->
  <main id="page1" class="device-page active">
    <section class="device-status-summary" id="device1-summary">
      <div class="status-item">
        <div class="status-count" id="d1-active-count">0</div>
        <div class="status-label">এক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d1-inactive-count">0</div>
        <div class="status-label">ইনএক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d1-warning-count">0</div>
        <div class="status-label">সতর্কতা</div>
      </div>
      <div class="status-item">
        <div class="status-count">16</div>
        <div class="status-label">মোট লোড</div>
      </div>
    </section>
    
    <section class="device-cards">
      <!-- ডিভাইস ১ এর ১৬টি লোডের জন্য কার্ড -->
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 1</span>
          <span class="card-status status-inactive" id="d1-load1-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load1">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load1', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load1', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load1', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 2</span>
          <span class="card-status status-inactive" id="d1-load2-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load2">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load2', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load2', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load2', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 3</span>
          <span class="card-status status-inactive" id="d1-load3-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load3">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load3', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load3', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load3', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 4</span>
          <span class="card-status status-inactive" id="d1-load4-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load4">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load4', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load4', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load4', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 5</span>
          <span class="card-status status-inactive" id="d1-load5-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load5">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load5', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load5', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load5', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 6</span>
          <span class="card-status status-inactive" id="d1-load6-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load6">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load6', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load6', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load6', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 7</span>
          <span class="card-status status-inactive" id="d1-load7-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load7">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load7', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load7', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load7', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 8</span>
          <span class="card-status status-inactive" id="d1-load8-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load8">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load8', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load8', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load8', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 9</span>
          <span class="card-status status-inactive" id="d1-load9-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load9">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load9', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load9', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load9', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 10</span>
          <span class="card-status status-inactive" id="d1-load10-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load10">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load10', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load10', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load10', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 11</span>
          <span class="card-status status-inactive" id="d1-load11-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load11">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load11', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load11', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load11', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 12</span>
          <span class="card-status status-inactive" id="d1-load12-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load12">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load12', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load12', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load12', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 13</span>
          <span class="card-status status-inactive" id="d1-load13-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load13">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load13', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load13', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load13', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 14</span>
          <span class="card-status status-inactive" id="d1-load14-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load14">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load14', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load14', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load14', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 15</span>
          <span class="card-status status-inactive" id="d1-load15-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load15">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load15', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load15', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load15', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 16</span>
          <span class="card-status status-inactive" id="d1-load16-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d1-load16">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device1', 'Load16', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device1', 'Load16', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device1', 'Load16', 0)">OFF</button>
        </div>
      </div>
    </section>

    <!-- এনালিটিক্স সেকশন -->
    <section class="analytics-section">
      <div class="chart-container">
        <h3 class="section-title">ডিভাইস ১ স্ট্যাটাস গ্রাফ</h3>
        <canvas id="device1-chart"></canvas>
      </div>
      
      <div class="log-container">
        <h3 class="section-title">ডিভাইস ১ লগ</h3>
        <div class="log-list" id="device1-logs">
          <!-- লগ আইটেমগুলো এখানে যোগ হবে -->
        </div>
      </div>
    </section>
  </main>

  <!-- ডিভাইস ২ পেইজ -->
  <main id="page2" class="device-page">
    <section class="device-status-summary" id="device2-summary">
      <div class="status-item">
        <div class="status-count" id="d2-active-count">0</div>
        <div class="status-label">এক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d2-inactive-count">0</div>
        <div class="status-label">ইনএক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d2-warning-count">0</div>
        <div class="status-label">সতর্কতা</div>
      </div>
      <div class="status-item">
        <div class="status-count">16</div>
        <div class="status-label">মোট লোড</div>
      </div>
    </section>
    
    <section class="device-cards">
      <!-- ডিভাইস ২ এর ১৬টি লোডের জন্য কার্ড -->
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 1</span>
          <span class="card-status status-inactive" id="d2-load1-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load1">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load1', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load1', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load1', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 2</span>
          <span class="card-status status-inactive" id="d2-load2-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load2">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load2', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load2', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load2', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 3</span>
          <span class="card-status status-inactive" id="d2-load3-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load3">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load3', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load3', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load3', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 4</span>
          <span class="card-status status-inactive" id="d2-load4-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load4">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load4', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load4', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load4', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 5</span>
          <span class="card-status status-inactive" id="d2-load5-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load5">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load5', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load5', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load5', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 6</span>
          <span class="card-status status-inactive" id="d2-load6-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load6">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load6', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load6', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load6', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 7</span>
          <span class="card-status status-inactive" id="d2-load7-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load7">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load7', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load7', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load7', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 8</span>
          <span class="card-status status-inactive" id="d2-load8-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load8">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load8', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load8', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load8', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 9</span>
          <span class="card-status status-inactive" id="d2-load9-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load9">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load9', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load9', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load9', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 10</span>
          <span class="card-status status-inactive" id="d2-load10-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load10">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load10', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load10', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load10', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 11</span>
          <span class="card-status status-inactive" id="d2-load11-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load11">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load11', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load11', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load11', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 12</span>
          <span class="card-status status-inactive" id="d2-load12-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load12">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load12', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load12', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load12', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 13</span>
          <span class="card-status status-inactive" id="d2-load13-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load13">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load13', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load13', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load13', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 14</span>
          <span class="card-status status-inactive" id="d2-load14-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load14">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load14', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load14', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load14', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 15</span>
          <span class="card-status status-inactive" id="d2-load15-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load15">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load15', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load15', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load15', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 16</span>
          <span class="card-status status-inactive" id="d2-load16-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d2-load16">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device2', 'Load16', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device2', 'Load16', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device2', 'Load16', 0)">OFF</button>
        </div>
      </div>
    </section>

    <!-- এনালিটিক্স সেকশন -->
    <section class="analytics-section">
      <div class="chart-container">
        <h3 class="section-title">ডিভাইস ২ স্ট্যাটাস গ্রাফ</h3>
        <canvas id="device2-chart"></canvas>
      </div>
      
      <div class="log-container">
        <h3 class="section-title">ডিভাইস ২ লগ</h3>
        <div class="log-list" id="device2-logs">
          <!-- লগ আইটেমগুলো এখানে যোগ হবে -->
        </div>
      </div>
    </section>
  </main>

  <!-- ডিভাইস ৩ পেইজ -->
  <main id="page3" class="device-page">
    <section class="device-status-summary" id="device3-summary">
      <div class="status-item">
        <div class="status-count" id="d3-active-count">0</div>
        <div class="status-label">এক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d3-inactive-count">0</div>
        <div class="status-label">ইনএক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d3-warning-count">0</div>
        <div class="status-label">সতর্কতা</div>
      </div>
      <div class="status-item">
        <div class="status-count">16</div>
        <div class="status-label">মোট লোড</div>
      </div>
    </section>
    
    <section class="device-cards">
      <!-- ডিভাইস ৩ এর ১৬টি লোডের জন্য কার্ড -->
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 1</span>
          <span class="card-status status-inactive" id="d3-load1-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load1">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load1', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load1', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load1', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 2</span>
          <span class="card-status status-inactive" id="d3-load2-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load2">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load2', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load2', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load2', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 3</span>
          <span class="card-status status-inactive" id="d3-load3-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load3">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load3', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load3', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load3', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 4</span>
          <span class="card-status status-inactive" id="d3-load4-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load4">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load4', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load4', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load4', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 5</span>
          <span class="card-status status-inactive" id="d3-load5-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load5">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load5', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load5', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load5', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 6</span>
          <span class="card-status status-inactive" id="d3-load6-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load6">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load6', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load6', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load6', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 7</span>
          <span class="card-status status-inactive" id="d3-load7-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load7">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load7', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load7', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load7', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 8</span>
          <span class="card-status status-inactive" id="d3-load8-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load8">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load8', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load8', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load8', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 9</span>
          <span class="card-status status-inactive" id="d3-load9-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load9">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load9', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load9', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load9', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 10</span>
          <span class="card-status status-inactive" id="d3-load10-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load10">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load10', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load10', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load10', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 11</span>
          <span class="card-status status-inactive" id="d3-load11-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load11">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load11', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load11', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load11', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 12</span>
          <span class="card-status status-inactive" id="d3-load12-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load12">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load12', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load12', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load12', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 13</span>
          <span class="card-status status-inactive" id="d3-load13-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load13">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load13', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load13', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load13', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 14</span>
          <span class="card-status status-inactive" id="d3-load14-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load14">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load14', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load14', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load14', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 15</span>
          <span class="card-status status-inactive" id="d3-load15-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load15">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load15', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load15', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load15', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 16</span>
          <span class="card-status status-inactive" id="d3-load16-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d3-load16">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device3', 'Load16', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device3', 'Load16', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device3', 'Load16', 0)">OFF</button>
        </div>
      </div>
    </section>

    <!-- এনালিটিক্স সেকশন -->
    <section class="analytics-section">
      <div class="chart-container">
        <h3 class="section-title">ডিভাইস ৩ স্ট্যাটাস গ্রাফ</h3>
        <canvas id="device3-chart"></canvas>
      </div>
      
      <div class="log-container">
        <h3 class="section-title">ডিভাইস ৩ লগ</h3>
        <div class="log-list" id="device3-logs">
          <!-- লগ আইটেমগুলো এখানে যোগ হবে -->
        </div>
      </div>
    </section>
  </main>
  
  <!-- ডিভাইস ৪ পেইজ -->
  <main id="page4" class="device-page">
    <section class="device-status-summary" id="device4-summary">
      <div class="status-item">
        <div class="status-count" id="d4-active-count">0</div>
        <div class="status-label">এক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d4-inactive-count">0</div>
        <div class="status-label">ইনএক্টিভ</div>
      </div>
      <div class="status-item">
        <div class="status-count" id="d4-warning-count">0</div>
        <div class="status-label">সতর্কতা</div>
      </div>
      <div class="status-item">
        <div class="status-count">16</div>
        <div class="status-label">মোট লোড</div>
      </div>
    </section>
    
    <section class="device-cards">
      <!-- ডিভাইস ৪ এর ১৬টি লোডের জন্য কার্ড -->
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 1</span>
          <span class="card-status status-inactive" id="d4-load1-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load1">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load1', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load1', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load1', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 2</span>
          <span class="card-status status-inactive" id="d4-load2-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load2">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load2', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load2', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load2', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 3</span>
          <span class="card-status status-inactive" id="d4-load3-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load3">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load3', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load3', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load3', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 4</span>
          <span class="card-status status-inactive" id="d4-load4-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load4">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load4', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load4', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load4', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 5</span>
          <span class="card-status status-inactive" id="d4-load5-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load5">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load5', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load5', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load5', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 6</span>
          <span class="card-status status-inactive" id="d4-load6-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load6">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load6', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load6', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load6', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 7</span>
          <span class="card-status status-inactive" id="d4-load7-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load7">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load7', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load7', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load7', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 8</span>
          <span class="card-status status-inactive" id="d4-load8-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load8">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load8', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load8', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load8', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 9</span>
          <span class="card-status status-inactive" id="d4-load9-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load9">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load9', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load9', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load9', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 10</span>
          <span class="card-status status-inactive" id="d4-load10-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load10">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load10', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load10', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load10', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 11</span>
          <span class="card-status status-inactive" id="d4-load11-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load11">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load11', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load11', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load11', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 12</span>
          <span class="card-status status-inactive" id="d4-load12-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load12">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load12', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load12', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load12', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 13</span>
          <span class="card-status status-inactive" id="d4-load13-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load13">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load13', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load13', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load13', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 14</span>
          <span class="card-status status-inactive" id="d4-load14-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load14">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load14', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load14', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load14', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 15</span>
          <span class="card-status status-inactive" id="d4-load15-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load15">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load15', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load15', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load15', 0)">OFF</button>
        </div>
      </div>
      <div class="device-card">
        <div class="card-header">
          <span class="card-title">লোড 16</span>
          <span class="card-status status-inactive" id="d4-load16-status">ইনএক্টিভ</span>
        </div>
        <div class="card-value" id="d4-load16">--</div>
        <div class="card-footer">
          <button class="pro-btn card-btn btn-on" onclick="controlDevice('device4', 'Load16', 1)">ON</button>
          <button class="pro-btn card-btn btn-warning" onclick="controlDevice('device4', 'Load16', 2)">WARN</button>
          <button class="pro-btn card-btn btn-off" onclick="controlDevice('device4', 'Load16', 0)">OFF</button>
        </div>
      </div>
    </section>

    <!-- এনালিটিক্স সেকশন -->
    <section class="analytics-section">
      <div class="chart-container">
        <h3 class="section-title">ডিভাইস ৪ স্ট্যাটাস গ্রাফ</h3>
        <canvas id="device4-chart"></canvas>
      </div>
      
      <div class="log-container">
        <h3 class="section-title">ডিভাইস ৪ লগ</h3>
        <div class="log-list" id="device4-logs">
          <!-- লগ আইটেমগুলো এখানে যোগ হবে -->
        </div>
      </div>
    </section>
  </main>
  
  <!-- এনার্জি মনিটরিং পেইজ -->
  <main id="page5" class="device-page">
    <section class="energy-metrics">
      <div class="energy-card voltage-card">
        <div class="energy-title">⚡ ভোল্টেজ</div>
        <div class="energy-value" id="voltage-value">-- <span class="energy-unit">V</span></div>
      </div>

      <div class="energy-card current-card">
        <div class="energy-title">🔌 কারেন্ট</div>
        <div class="energy-value" id="current-value">-- <span class="energy-unit">A</span></div>
      </div>

      <div class="energy-card power-card">
        <div class="energy-title">💡 পাওয়ার</div>
        <div class="energy-value" id="power-value">-- <span class="energy-unit">W</span></div>
      </div>

      <div class="energy-card energy-card-main">
        <div class="energy-title">🔋 এনার্জি</div>
        <div class="energy-value" id="energy-value">-- <span class="energy-unit">kWh</span></div>
      </div>

      <div class="energy-card frequency-card">
        <div class="energy-title">⏱️ ফ্রিকোয়েন্সি</div>
        <div class="energy-value" id="frequency-value">-- <span class="energy-unit">Hz</span></div>
      </div>

      <div class="energy-card power-factor-card">
        <div class="energy-title">📊 পাওয়ার ফ্যাক্টর</div>
        <div class="energy-value" id="power-factor-value">-- <span class="energy-unit"></span></div>
      </div>

      <div class="energy-card active-power-card">
        <div class="energy-title">🔆 অ্যাক্টিভ পাওয়ার</div>
        <div class="energy-value" id="active-power-value">-- <span class="energy-unit">W</span></div>
      </div>

      <div class="energy-card reactive-power-card">
        <div class="energy-title">🌀 রিঅ্যাক্টিভ পাওয়ার</div>
        <div class="energy-value" id="reactive-power-value">-- <span class="energy-unit">VAR</span></div>
      </div>

      <div class="energy-card units-card">
        <div class="energy-title">✔️ ব্যবহৃত ইউনিট</div>
        <div class="energy-value" id="units-value">-- <span class="energy-unit">Units</span></div>
      </div>

      <div class="energy-card cost-card">
        <div class="energy-title">💰 দৈনিক খরচ</div>
        <div class="energy-value" id="daily-cost-value">-- <span class="energy-unit">BDT</span></div>
      </div>

      <div class="energy-card timestamp-card">
        <div class="energy-title">🕒 টাইমস্ট্যাম্প</div>
        <div class="energy-value" id="timestamp-value" style="font-size: 1.2rem; font-weight: 500;">--</div>
      </div>
    </section>

    <section class="energy-graphs">
      <div class="graph-container">
        <h3 class="graph-title">ভোল্টেজ ট্রেন্ড</h3>
        <canvas id="voltage-chart"></canvas>
      </div>
      <div class="graph-container">
        <h3 class="graph-title">কারেন্ট ট্রেন্ড</h3>
        <canvas id="current-chart"></canvas>
      </div>
      <div class="graph-container">
        <h3 class="graph-title">পাওয়ার ট্রেন্ড</h3>
        <canvas id="power-chart"></canvas>
      </div>
      <div class="graph-container">
        <h3 class="graph-title">এনার্জি কনজাম্পশন</h3>
        <canvas id="energy-chart"></canvas>
      </div>
    </section>
  </main>

  <!-- এডভান্সড এনার্জি মনিটরিং পেইজ -->
  <main id="page6" class="device-page">
    <div class="time-selection">
      <button class="time-btn active" onclick="changeTimeRange(30)">৩০ মিনিট</button>
      <button class="time-btn" onclick="changeTimeRange(60)">১ ঘন্টা</button>
      <button class="time-btn" onclick="changeTimeRange(180)">৩ ঘন্টা</button>
      <button class="time-btn" onclick="changeTimeRange(360)">৬ ঘন্টা</button>
      <button class="time-btn" onclick="changeTimeRange(720)">১২ ঘন্টা</button>
    </div>

    <div class="metric-selection">
      <div class="metric-card selected" onclick="selectMetric('voltage')">
        <div class="metric-title"><span class="metric-icon">⚡</span> ভোল্টেজ</div>
        <div class="metric-description">ভোল্টেজের পরিবর্তন পর্যবেক্ষণ করুন</div>
      </div>
      <div class="metric-card" onclick="selectMetric('current')">
        <div class="metric-title"><span class="metric-icon">🔌</span> কারেন্ট</div>
        <div class="metric-description">কারেন্টের প্রবাহ বিশ্লেষণ করুন</div>
      </div>
      <div class="metric-card" onclick="selectMetric('power')">
        <div class="metric-title"><span class="metric-icon">💡</span> পাওয়ার</div>
        <div class="metric-description">পাওয়ার ব্যবহারের ট্রেন্ড দেখুন</div>
      </div>
      <div class="metric-card" onclick="selectMetric('energy')">
        <div class="metric-title"><span class="metric-icon">🔋</span> এনার্জি</div>
        <div class="metric-description">এনার্জি খরচের হিসাব দেখুন</div>
      </div>
      <div class="metric-card" onclick="selectMetric('frequency')">
        <div class="metric-title"><span class="metric-icon">⏱️</span> ফ্রিকোয়েন্সি</div>
        <div class="metric-description">ফ্রিকোয়েন্সির স্থিতিশীলতা পরীক্ষা করুন</div>
      </div>
      <div class="metric-card" onclick="selectMetric('powerFactor')">
        <div class="metric-title"><span class="metric-icon">📊</span> পাওয়ার ফ্যাক্টর</div>
        <div class="metric-description">পাওয়ার ফ্যাক্টরের মান বিশ্লেষণ করুন</div>
      </div>
      <div class="metric-card" onclick="selectMetric('activePower')">
        <div class="metric-title"><span class="metric-icon">🔆</span> অ্যাক্টিভ পাওয়ার</div>
        <div class="metric-description">রিয়েল পাওয়ার ব্যবহার দেখুন</div>
      </div>
      <div class="metric-card" onclick="selectMetric('reactivePower')">
        <div class="metric-title"><span class="metric-icon">🌀</span> রিঅ্যাক্টিভ পাওয়ার</div>
        <div class="metric-description">রিঅ্যাক্টিভ পাওয়ার ট্রেন্ড</div>
      </div>
    </div>

    <section class="advanced-graph-container">
      <div class="graph-header">
        <h3 class="graph-title" id="advanced-graph-title">ভোল্টেজ ট্রেন্ড (৩০ মিনিট)</h3>
        <div class="graph-controls">
          <button class="graph-btn" onclick="downloadGraphData()">ডাটা ডাউনলোড</button>
          <button class="graph-btn" onclick="printGraph()">প্রিন্ট</button>
        </div>
      </div>
      <canvas id="advanced-energy-chart"></canvas>
      <div class="no-data-message" id="no-data-message" style="display: none;">
        নির্বাচিত সময় রেঞ্জে কোনো ডাটা পাওয়া যায়নি
      </div>
    </section>
  </main>
  
  <!-- Diagram Note File পেইজ -->
  <main id="page7" class="device-page">
    <section class="notes-container">
      <h2 class="note-title">Diagram Note File</h2>
      
      <p class="note-paragraph">
        এই পৃষ্ঠাটি আমাদের প্রকল্পের জন্য গুরুত্বপূর্ণ নোট এবং ডকুমেন্টেশন সংরক্ষণ করতে ব্যবহৃত হবে।
         এখানে আপনি প্রকল্পের বিভিন্ন ডায়াগ্রাম, নোট এবং গুরুত্বপূর্ণ তথ্য পাবেন যা প্রকল্পের উন্নয়ন এবং রক্ষণাবেক্ষণের জন্য প্রয়োজনীয়।
      </p>
      
      <div class="note-letter">
        <div class="note-letter-title">গুরুত্বপূর্ণ নোট #1</div>
        <div class="note-letter-content">
          প্রকল্পের সার্কিট ডায়াগ্রামটি নিচে দেওয়া হয়েছে। দয়া করে নিশ্চিত করুন যে সমস্ত সংযোগ সঠিকভাবে করা হয়েছে এবং প্রতিটি কম্পোনেন্ট সঠিকভাবে স্থাপন করা হয়েছে।
           সার্কিট ডায়াগ্রামে কোন পরিবর্তন প্রয়োজন হলে দয়া করে টিম লিডারকে জানান।
        </div>
      </div>
      
      <div class="note-images">
        <div class="note-image" onclick="openImageModal('electrical-single-line-diagram-4.jpg', 'প্রকল্পের সার্কিট ডায়াগ্রাম')">
          <img src="electrical-single-line-diagram-4.jpg" alt="সার্কিট ডায়াগ্রাম">
          <div class="note-image-caption">প্রকল্পের সার্কিট ডায়াগ্রাম</div>
        </div>

        <div class="note-image" onclick="openImageModal('6005990.jpg', 'সিস্টেম ফ্লো চার্ট')">
          <img src="6005990.jpg" alt="ফ্লো চার্ট">
          <div class="note-image-caption">সিস্টেম ফ্লো চার্ট</div>
        </div>
      </div>
      
      <h3 class="note-subtitle">প্রকল্পের মূল বৈশিষ্ট্য</h3>
      <p class="note-paragraph">
        1. রিয়েল-টাইম ডিভাইস মনিটরিং<br>
        2. এনার্জি কনজাম্পশন ট্র্যাকিং<br>
        3. রিমোট কন্ট্রোল সক্ষমতা<br>
        4. ডেটা ভিজুয়ালাইজেশন<br>
        5. মাল্টি-ডিভাইস সাপোর্ট
      </p>
      
      <div class="note-letter">
        <div class="note-letter-title">গুরুত্বপূর্ণ নোট #2</div>
        <div class="note-letter-content">
          সিস্টেম আপডেটের সময় নিচের সতর্কতাগুলো মেনে চলুন:<br>
          - আপডেট করার আগে ব্যাকআপ নিন<br>
          - প্রোডাকশন সিস্টেমে সরাসরি আপডেট করবেন না<br>
          - পরিবর্তন করার আগে টিমের সাথে আলোচনা করুন<br>
          - সমস্ত পরিবর্তন ডকুমেন্ট করুন
        </div>
      </div>
      
      <h3 class="note-subtitle">সিস্টেম আর্কিটেকচার</h3>
      <p class="note-paragraph">
        আমাদের সিস্টেমটি তিনটি মূল অংশ নিয়ে গঠিত:<br>
        1. IoT ডিভাইস - ডাটা কালেকশন এবং একচুয়েশন<br>
        2. ক্লাউড সার্ভার - ডাটা প্রসেসিং এবং স্টোরেজ<br>
        3. ওয়েব ইন্টারফেস - ইউজার ইন্টারঅ্যাকশন
      </p>
      
      <div class="note-images">
        <div class="note-image" onclick="openImageModal('https://i.ibb.co/5KJZ0Lm/system-architecture.jpg', 'সিস্টেম আর্কিটেকচার ডায়াগ্রাম')">
          <img src="https://i.ibb.co/5KJZ0Lm/system-architecture.jpg" alt="সিস্টেম আর্কিটেকচার">
          <div class="note-image-caption">সিস্টেম আর্কিটেকচার ডায়াগ্রাম</div>
        </div>
      </div>
      
      <h3 class="note-subtitle">ভবিষ্যতের উন্নয়ন পরিকল্পনা</h3>
      <p class="note-paragraph">
        - মোবাইল অ্যাপ্লিকেশন সংযোজন<br>
        - AI-ভিত্তিক এনার্জি অপ্টিমাইজেশন<br>
        - মাল্টি-ইউজার সাপোর্ট<br>
        - অ্যাডভান্সড রিপোর্টিং সিস্টেম<br>
        - থার্ড-পার্টি ইন্টিগ্রেশন
      </p>
    </section>
  </main>

  <!-- কন্ট্রোল প্যানেল পেইজ -->
  <main id="page8" class="device-page">
    <section class="control-section">
      <h2 class="control-section-title">ডিভাইস ১ কন্ট্রোল</h2>
      <div class="toggle-switch-grid">
        <!-- রিলে ১ থেকে ৮ এর জন্য নতুন কন্টেইনার -->
        <div class="toggle-switch-container">
          <div class="toggle-switch-header">
            <span class="toggle-switch-label">রিলে ১</span>
            <div class="device-time-info">
              <span class="current-date">--</span>
              <span class="current-time">--</span>
            </div>
          </div>
          <div class="toggle-switch-body">
            <div class="timer-status" id="timer-status-relay1">টাইমার সেট করা নেই</div>
          </div>

          <div class="toggle-switch-footer">
            <button class="pro-btn timer-btn" onclick="openTimerModal('relay1')">⏲️ টাইমার</button>
            <label class="toggle-switch">
              <input type="checkbox" id="d1-relay1-toggle" onchange="promptForRelayPassword('device1', 'relay1', this)">
              <span class="slider"></span>
            </label>
          </div>
        </div>
<div class="toggle-switch-container">
    <div class="toggle-switch-header">
        <span class="toggle-switch-label">রিলে ২</span>
        <div class="device-time-info">
            <span class="current-date">--</span>
            <span class="current-time">--</span>
        </div>
    </div>
    <div class="toggle-switch-body">
        <div class="timer-status" id="timer-status-relay2">টাইমার সেট করা নেই</div>
    </div>
    <div class="toggle-switch-footer">
        <button class="pro-btn timer-btn" onclick="openTimerModal('relay2')">⏲️ টাইমার</button>
        <label class="toggle-switch">
            <input type="checkbox" id="d1-relay2-toggle" onchange="promptForRelayPassword('device1', 'relay2', this)">
            <span class="slider"></span>
        </label>
    </div>
</div>

<div class="toggle-switch-container">
    <div class="toggle-switch-header">
        <span class="toggle-switch-label">রিলে ৩</span>
        <div class="device-time-info">
            <span class="current-date">--</span>
            <span class="current-time">--</span>
        </div>
    </div>
    <div class="toggle-switch-body">
        <div class="timer-status" id="timer-status-relay3">টাইমার সেট করা নেই</div>
    </div>
    <div class="toggle-switch-footer">
        <button class="pro-btn timer-btn" onclick="openTimerModal('relay3')">⏲️ টাইমার</button>
        <label class="toggle-switch">
            <input type="checkbox" id="d1-relay3-toggle" onchange="promptForRelayPassword('device1', 'relay3', this)">
            <span class="slider"></span>
        </label>
    </div>
</div>

<div class="toggle-switch-container">
    <div class="toggle-switch-header">
        <span class="toggle-switch-label">রিলে ৪</span>
        <div class="device-time-info">
            <span class="current-date">--</span>
            <span class="current-time">--</span>
        </div>
    </div>
    <div class="toggle-switch-body">
        <div class="timer-status" id="timer-status-relay4">টাইমার সেট করা নেই</div>
    </div>
    <div class="toggle-switch-footer">
        <button class="pro-btn timer-btn" onclick="openTimerModal('relay4')">⏲️ টাইমার</button>
        <label class="toggle-switch">
            <input type="checkbox" id="d1-relay4-toggle" onchange="promptForRelayPassword('device1', 'relay4', this)">
            <span class="slider"></span>
        </label>
    </div>
</div>

<div class="toggle-switch-container">
    <div class="toggle-switch-header">
        <span class="toggle-switch-label">রিলে ৫</span>
        <div class="device-time-info">
            <span class="current-date">--</span>
            <span class="current-time">--</span>
        </div>
    </div>
    <div class="toggle-switch-body">
        <div class="timer-status" id="timer-status-relay5">টাইমার সেট করা নেই</div>
    </div>
    <div class="toggle-switch-footer">
        <button class="pro-btn timer-btn" onclick="openTimerModal('relay5')">⏲️ টাইমার</button>
        <label class="toggle-switch">
            <input type="checkbox" id="d1-relay5-toggle" onchange="promptForRelayPassword('device1', 'relay5', this)">
            <span class="slider"></span>
        </label>
    </div>
</div>

<div class="toggle-switch-container">
    <div class="toggle-switch-header">
        <span class="toggle-switch-label">রিলে ৬</span>
        <div class="device-time-info">
            <span class="current-date">--</span>
            <span class="current-time">--</span>
        </div>
    </div>
    <div class="toggle-switch-body">
        <div class="timer-status" id="timer-status-relay6">টাইমার সেট করা নেই</div>
    </div>
    <div class="toggle-switch-footer">
        <button class="pro-btn timer-btn" onclick="openTimerModal('relay6')">⏲️ টাইমার</button>
        <label class="toggle-switch">
            <input type="checkbox" id="d1-relay6-toggle" onchange="promptForRelayPassword('device1', 'relay6', this)">
            <span class="slider"></span>
        </label>
    </div>
</div>

<div class="toggle-switch-container">
    <div class="toggle-switch-header">
        <span class="toggle-switch-label">রিলে ৭</span>
        <div class="device-time-info">
            <span class="current-date">--</span>
            <span class="current-time">--</span>
        </div>
    </div>
    <div class="toggle-switch-body">
        <div class="timer-status" id="timer-status-relay7">টাইমার সেট করা নেই</div>
    </div>
    <div class="toggle-switch-footer">
        <button class="pro-btn timer-btn" onclick="openTimerModal('relay7')">⏲️ টাইমার</button>
        <label class="toggle-switch">
            <input type="checkbox" id="d1-relay7-toggle" onchange="promptForRelayPassword('device1', 'relay7', this)">
            <span class="slider"></span>
        </label>
    </div>
</div>

<div class="toggle-switch-container">
    <div class="toggle-switch-header">
        <span class="toggle-switch-label">রিলে ৮</span>
        <div class="device-time-info">
            <span class="current-date">--</span>
            <span class="current-time">--</span>
        </div>
    </div>
    <div class="toggle-switch-body">
        <div class="timer-status" id="timer-status-relay8">টাইমার সেট করা নেই</div>
    </div>
    <div class="toggle-switch-footer">
        <button class="pro-btn timer-btn" onclick="openTimerModal('relay8')">⏲️ টাইমার</button>
        <label class="toggle-switch">
            <input type="checkbox" id="d1-relay8-toggle" onchange="promptForRelayPassword('device1', 'relay8', this)">
            <span class="slider"></span>
        </label>
    </div>
</div>
</div>
</section>

<section class="control-section">
    <h2 class="control-section-title">ডিভাইস ২ কন্ট্রোল</h2>
    <div class="toggle-switch-grid">
        <!-- ডিভাইস ২ এর রিলে কন্টেইনার -->
        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে ১</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d2-relay1">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d2-relay1')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d2-relay1-toggle" onchange="promptForRelayPassword('device2', 'relay1', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে ২</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d2-relay2">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d2-relay2')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d2-relay2-toggle" onchange="promptForRelayPassword('device2', 'relay2', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে ৩</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d2-relay3">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d2-relay3')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d2-relay3-toggle" onchange="promptForRelayPassword('device2', 'relay3', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে ৪</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d2-relay4">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d2-relay4')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d2-relay4-toggle" onchange="promptForRelayPassword('device2', 'relay4', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে ৫</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d2-relay5">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d2-relay5')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d2-relay5-toggle" onchange="promptForRelayPassword('device2', 'relay5', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>
</section>

<!-- ////////////////////////////////////////////////// -->

<section class="control-section">
    <h2 class="control-section-title">ডিভাইস ৩ কন্ট্রোল</h2>
    <div class="toggle-switch-grid">

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে 1</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d3-relay1">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d3-relay1')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d3-relay1-toggle" onchange="promptForRelayPassword('device3', 'relay1', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে 2</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d3-relay2">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d3-relay2')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d3-relay2-toggle" onchange="promptForRelayPassword('device3', 'relay2', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>
</section>
<!-- ////////////////////////////////////////////////// -->

<section class="control-section">
    <h2 class="control-section-title">ডিভাইস 4 কন্ট্রোল</h2>
    <div class="toggle-switch-grid">

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে 1</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d4-relay1">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d4-relay1')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d4-relay1-toggle" onchange="promptForRelayPassword('device4', 'relay1', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="toggle-switch-container">
            <div class="toggle-switch-header">
                <span class="toggle-switch-label">রিলে 2</span>
                <div class="device-time-info">
                    <span class="current-date">--</span>
                    <span class="current-time">--</span>
                </div>
            </div>
            <div class="toggle-switch-body">
                <div class="timer-status" id="timer-status-d4-relay2">টাইমার সেট করা নেই</div>
            </div>
            <div class="toggle-switch-footer">
                <button class="pro-btn timer-btn" onclick="openTimerModal('d4-relay2')">⏲️ টাইমার</button>
                <label class="toggle-switch">
                    <input type="checkbox" id="d4-relay2-toggle" onchange="promptForRelayPassword('device4', 'relay2', this)">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>
</section>

<!-- ////////////////////////////////////////////////// -->
</main>
</div>

<!-- ইমেজ ভিউয়ার মোডাল -->
<div id="imageModal" class="image-modal">
  <span class="close-modal" onclick="closeImageModal()">&times;</span>
  <div class="modal-content">
    <img id="modalImage" class="modal-image" src="" alt="">
    <div id="modalCaption" class="modal-caption"></div>
  </div>
</div>

<!-- রিলে পাসওয়ার্ড ভেরিফিকেশন মোডাল -->
<div id="relayPasswordModal" class="password-modal-container">
  <div class="password-modal-box">
    <h3>অপারেশন নিশ্চিত করুন</h3>
    <p>এই রিলেটি অপারেট করতে দয়া করে পাসওয়ার্ড দিন।</p>
    <div class="password-input-group">
      <input type="password" id="relayPasswordInput" placeholder="অপারেটিং পাসওয়ার্ড" autocomplete="off">
    </div>
    <div class="password-error-message" id="relayPasswordError"></div>
    <div class="password-modal-buttons">
      <button class="pro-btn modal-btn cancel-btn" onclick="cancelRelayOperation()">বাতিল</button>
      <button class="pro-btn modal-btn confirm-btn" onclick="verifyAndOperateRelay()">নিশ্চিত করুন</button>
    </div>
  </div>
</div>

<!-- টাইমার সেটিং মোডাল -->
<div id="timerModal" class="password-modal-container">
  <div class="timer-modal-box">
    <h3 id="timer-modal-title">টাইমার সেটিংস</h3>
    <div class="timer-form">
      <div class="timer-row">
        <label>টাইমার স্ট্যাটাস</label>
        <button id="timer-enabled-btn" class="modal-btn disabled" onclick="toggleTimerEnabled()">নিষ্ক্রিয়</button>
      </div>
      <div class="timer-row">
        <label for="timer-online-time">অনলাইন হওয়ার সময়</label>
        <input type="time" id="timer-online-time" class="timer-time-input" step="1">
      </div>
      <div class="timer-row">
        <label for="timer-offline-time">অফলাইন হওয়ার সময়</label>
        <input type="time" id="timer-offline-time" class="timer-time-input" step="1">
      </div>
      <div class="timer-row">
        <label for="timer-relay-select">কোন রিলে কন্ট্রোল হবে?</label>
        <select id="timer-relay-select" class="timer-select">
            <option value="relay1">ডিভাইস ১ - রিলে ১</option>
            <option value="relay2">ডিভাইস ১ - রিলে ২</option>
            <option value="relay3">ডিভাইস ১ - রিলে ৩</option>
            <option value="relay4">ডিভাইস ১ - রিলে ৪</option>
            <option value="relay5">ডিভাইস ১ - রিলে ৫</option>
            <option value="relay6">ডিভাইস ১ - রিলে ৬</option>
            <option value="relay7">ডিভাইস ১ - রিলে ৭</option>
            <option value="relay8">ডিভাইস ১ - রিলে ৮</option>
        </select>
      </div>
    </div>
    <p class="timer-note">পরিবর্তনগুলো সংরক্ষণ করতে আপনার অপারেটিং পাসওয়ার্ড প্রয়োজন হবে।</p>
    <div class="password-input-group">
      <input type="password" id="timerPasswordInput" placeholder="অপারেটিং পাসওয়ার্ড" autocomplete="off">
    </div>
    <div class="password-error-message" id="timerPasswordError"></div>
    <div class="password-modal-buttons">
      <button class="pro-btn modal-btn cancel-btn" onclick="closeTimerModal()">বাতিল</button>
      <button class="pro-btn modal-btn confirm-btn" onclick="saveTimerSettings()">সংরক্ষণ করুন</button>
    </div>
  </div>
</div>


<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>



<script>
  // Firebase কনফিগারেশন
const firebaseConfig = {
  apiKey: "AIzaSyATDfnefdyPAzBNKZY4VM5ja8K2-63PC-U",
  authDomain: "home-server-346b6.firebaseapp.com",
  databaseURL: "https://home-server-346b6-default-rtdb.firebaseio.com",
  projectId: "home-server-346b6",
  storageBucket: "home-server-346b6.firebasestorage.app",
  messagingSenderId: "531234227336",
  appId: "1:531234227336:web:f57f700dd6baaed4358b3d",
  measurementId: "G-QDWVP34FSX"
};


  // Firebase ইনিশিয়ালাইজ করুন
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  // সঠিক পাসওয়ার্ড
  const correctPassword = "#u n*S*ibg u@";
  const correctOperatingPassword = "123";

  // চার্ট ইনস্ট্যান্স স্টোর করার অবজেক্ট
  const deviceCharts = {};
  let energyCharts = {};
  let advancedEnergyChart = null;
  let selectedMetric = 'voltage';
  let selectedTimeRange = 30; // মিনিট
  let historicalData = {};
  
  // রিলে অপারেশন কনটেক্সট সংরক্ষণের জন্য ভেরিয়েবল
  let relayOperationContext = null;
  // টাইমার অপারেশন কনটেক্সট এবং ডেটা সংরক্ষণের জন্য ভেরিয়েবল
  let timerOperationContext = null;
  let allTimersData = {};
  
  // ব্যাকগ্রাউন্ড ম্যানেজমেন্টের জন্য ভেরিয়েবল
  let currentBackgroundIndex = 0;
  const totalBackgrounds = 11; // ১০টি ইমেজ + ১টি অ্যানিমেটেড গ্রেডিয়েন্ট


  // ইমেজ মোডাল ফাংশন
  function openImageModal(imageSrc, caption) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    const modalCaption = document.getElementById('modalCaption');
    
    modal.style.display = "flex";
    modalImg.src = imageSrc;
    modalCaption.innerHTML = caption;
    
    document.addEventListener('keydown', function(event) {
      if (event.key === "Escape") {
        closeImageModal();
      }
    });
  }

  function closeImageModal() {
    document.getElementById('imageModal').style.display = "none";
    document.removeEventListener('keydown', function(event) {
      if (event.key === "Escape") {
        closeImageModal();
      }
    });
  }

  window.onclick = function(event) {
    const modal = document.getElementById('imageModal');
    if (event.target === modal) {
      closeImageModal();
    }
  }

  // পার্টিকল এনিমেশন তৈরি
  function createParticles() {
    const particlesContainer = document.getElementById('particles');
    if(particlesContainer.children.length > 0) return;
    const particleCount = 30;
    
    for (let i = 0; i < particleCount; i++) {
      const particle = document.createElement('div');
      particle.classList.add('particle');
      
      const size = Math.random() * 10 + 5;
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      particle.style.left = `${Math.random() * 100}%`;
      particle.style.top = `${Math.random() * 100}%`;
      particle.style.animationDelay = `${Math.random() * 15}s`;
      particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
      particle.style.opacity = Math.random() * 0.5 + 0.1;
      
      particlesContainer.appendChild(particle);
    }
  }

  // পাসওয়ার্ড চেক করার ফাংশন
  function checkPassword() {
    const input = document.getElementById("password").value;
    const loginContainer = document.getElementById("login");
    const appContainer = document.getElementById("app");

    if(input === correctPassword) {
      loginContainer.style.animation = "fadeOut 0.5s ease forwards";
      setTimeout(() => {
        loginContainer.style.display = "none";
        appContainer.style.display = "block";
        appContainer.style.animation = "fadeIn 0.5s ease forwards";
        loadDataRealtime();
        initializeCharts();
        loadThemePreference();
        loadBackgroundPreference();
        initEnergyCharts();
        loadEnergyData();
        initAdvancedEnergyChart();
        loadHistoricalData();
        loadRelayStates();
        loadDateTimeData();
        loadTimersData();
        setInterval(updateAllTimerDisplays, 1000);
      }, 500);
    } else {
      document.getElementById("error").innerText = "❌ ভুল পাসওয়ার্ড! দয়া করে আবার চেষ্টা করুন";
      const loginBox = document.querySelector(".login-box");
      // ★★★ ভাইব্রেশন অ্যানিমেশন ক্লাস যোগ করা হচ্ছে ★★★
      loginBox.classList.add('shake-animation');
      // অ্যানিমেশন শেষ হলে ক্লাসটি সরিয়ে ফেলা হচ্ছে
      setTimeout(() => {
        loginBox.classList.remove('shake-animation');
      }, 500);
    }
  }

  // লগআউট ফাংশন
  function logout() {
    const appContainer = document.getElementById("app");
    const loginContainer = document.getElementById("login");

    appContainer.style.animation = "fadeOut 0.5s ease forwards";
    setTimeout(() => {
      appContainer.style.display = "none";
      loginContainer.style.display = "flex";
      document.getElementById("password").value = "";
      document.getElementById("error").innerText = "";
      loginContainer.style.animation = "fadeIn 0.5s ease forwards";
    }, 500);
  }

  // পেইজ পরিবর্তন ফাংশন
  function showPage(pageNum) {
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.classList.remove('active');
    });
    
    document.querySelectorAll('.nav-tab')[pageNum-1].classList.add('active');
    
    document.querySelectorAll('.device-page').forEach(page => {
      page.classList.remove('active');
    });
    
    document.getElementById('page'+pageNum).classList.add('active');

    if(pageNum === 6 && advancedEnergyChart) {
      updateAdvancedChart();
    }
  }
  
  // রিলে কন্ট্রোল ফাংশন (পাসওয়ার্ড ভেরিফিকেশনের পর কল হবে)
  function controlRelay(device, relay, element) {
    const state = element.checked;
    console.log(`Controlling ${device}/${relay} to ${state}`);
    database.ref('devices/' + device).update({
        [relay]: state
    });
    const logMessage = `${device} এর ${relay} ${state ? 'চালু' : 'বন্ধ'} করা হয়েছে`;
    addLogEntry(device, logMessage, state ? 'success' : 'error');
  }

  // ডিভাইস কন্ট্রোল ফাংশন (for pages 1-4)
  function controlDevice(device, load, state) {
    const timestamp = new Date().toISOString();
    const logMessage = `${device} এর ${load} ${state === 1 ? 'চালু' : state === 2 ? 'সতর্কতা মোডে' : 'বন্ধ'} করা হয়েছে`;
    
    database.ref('devices/' + device).update({
      [load]: state
    });
    
    addLogEntry(device, logMessage, state === 1 ? 'success' : state === 2 ? 'warning' : 'error');
    updateChart(device);
  }

  // লগ এন্ট্রি যোগ করার ফাংশন
  function addLogEntry(device, message, type) {
    const logIdMap = {
      'device1': 'device1-logs',
      'device2': 'device2-logs',
      'device3': 'device3-logs',
      'device4': 'device4-logs',
    };
    const logElementId = logIdMap[device];
    if (!logElementId) return;

    const logElement = document.getElementById(logElementId);
    if (!logElement) return;

    const timestamp = new Date().toLocaleString('bn-BD');
    const logClass = `log-${type}`;
    
    const logItem = document.createElement('div');
    logItem.className = 'log-item';
    logItem.innerHTML = `
      <div class="log-time">${timestamp}</div>
      <div class="log-message ${logClass}">${message}</div>
    `;
    
    logElement.insertBefore(logItem, logElement.firstChild);
    
    if(logElement.children.length > 50) {
      logElement.removeChild(logElement.lastChild);
    }
  }

  // ডিভাইস চার্ট ইনিশিয়ালাইজ করার ফাংশন
  function initializeCharts() {
    for(let i = 1; i <= 4; i++) {
      const ctx = document.getElementById(`device${i}-chart`).getContext('2d');
      if (deviceCharts[`device${i}`]) {
          deviceCharts[`device${i}`].destroy();
      }
      deviceCharts[`device${i}`] = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['এক্টিভ', 'সতর্কতা', 'ইনএক্টিভ'],
          datasets: [{
            data: [0, 0, 16],
            backgroundColor: [ 'rgba(46, 204, 113, 0.8)', 'rgba(243, 156, 18, 0.8)', 'rgba(231, 76, 60, 0.8)' ],
            borderColor: 'rgba(255, 255, 255, 0.1)',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              labels: { color: 'var(--text-color)' }
            }
          }
        }
      });
    }
  }

  // ডিভাইস চার্ট আপডেট করার ফাংশন
  function updateChart(device) {
    const activeCount = parseInt(document.getElementById(`${device}-active-count`).textContent);
    const warningCount = parseInt(document.getElementById(`${device}-warning-count`).textContent);
    const inactiveCount = parseInt(document.getElementById(`${device}-inactive-count`).textContent);
    
    if(deviceCharts[device]) {
      deviceCharts[device].data.datasets[0].data = [activeCount, warningCount, inactiveCount];
      deviceCharts[device].update();
    }
  }

  // থিম টগল ফাংশন
  function toggleTheme() {
    const body = document.body;
    const themeToggle = document.getElementById('theme-toggle');
    
    if(themeToggle.checked) {
      body.classList.add('light-theme');
      localStorage.setItem('theme', 'light');
    } else {
      body.classList.remove('light-theme');
      localStorage.setItem('theme', 'dark');
    }
  }

  // থিম প্রিফারেন্স লোড করার ফাংশন
  function loadThemePreference() {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    const themeToggle = document.getElementById('theme-toggle');
    
    if(savedTheme === 'light') {
      document.body.classList.add('light-theme');
      themeToggle.checked = true;
    } else {
      document.body.classList.remove('light-theme');
      themeToggle.checked = false;
    }
    
    themeToggle.addEventListener('change', toggleTheme);
  }
  
  // --- ব্যাকগ্রাউন্ড ম্যানেজমেন্ট ফাংশন ---

  // ব্যাকগ্রাউন্ড পরিবর্তন করার ফাংশন
  function changeBackground() {
    currentBackgroundIndex = (currentBackgroundIndex + 1) % totalBackgrounds;
    applyBackground(currentBackgroundIndex);
    localStorage.setItem('backgroundIndex', currentBackgroundIndex);
  }

  // নির্বাচিত ব্যাকগ্রাউন্ড প্রয়োগ করার ফাংশন
  function applyBackground(index) {
    const body = document.body;
    for (let i = 0; i < totalBackgrounds; i++) {
      body.classList.remove(`bg-${i}`);
    }
    body.classList.add(`bg-${index}`);
    currentBackgroundIndex = index;
  }

  // ব্যাকগ্রাউন্ড প্রিফারেন্স লোড করার ফাংশন
  function loadBackgroundPreference() {
    const savedIndex = localStorage.getItem('backgroundIndex');
    const indexToApply = savedIndex ? parseInt(savedIndex, 10) : 0;
    applyBackground(indexToApply);
  }

  // এনার্জি চার্ট ইনিশিয়ালাইজ করার ফাংশন
  function initEnergyCharts() {
    const chartsToInit = {
        'voltageChart': 'voltage-chart',
        'currentChart': 'current-chart',
        'powerChart': 'power-chart',
        'energyChart': 'energy-chart'
    };
    Object.keys(chartsToInit).forEach(chartKey => {
        if (energyCharts[chartKey]) {
            energyCharts[chartKey].destroy();
        }
    });

    const voltageCtx = document.getElementById('voltage-chart').getContext('2d');
    energyCharts.voltageChart = new Chart(voltageCtx, {
      type: 'line', data: { labels: Array(12).fill(''), datasets: [{ label: 'ভোল্টেজ (V)', data: [], borderColor: 'rgba(230, 126, 34, 1)', backgroundColor: 'rgba(230, 126, 34, 0.2)', borderWidth: 2, tension: 0.4, fill: true }] }, options: getChartOptions('ভোল্টেজ ট্রেন্ড (V)')
    });
    const currentCtx = document.getElementById('current-chart').getContext('2d');
    energyCharts.currentChart = new Chart(currentCtx, {
      type: 'line', data: { labels: Array(12).fill(''), datasets: [{ label: 'কারেন্ট (A)', data: [], borderColor: 'rgba(26, 188, 156, 1)', backgroundColor: 'rgba(26, 188, 156, 0.2)', borderWidth: 2, tension: 0.4, fill: true }] }, options: getChartOptions('কারেন্ট ট্রেন্ড (A)')
    });
    const powerCtx = document.getElementById('power-chart').getContext('2d');
    energyCharts.powerChart = new Chart(powerCtx, {
      type: 'line', data: { labels: Array(12).fill(''), datasets: [{ label: 'পাওয়ার (W)', data: [], borderColor: 'rgba(52, 152, 219, 1)', backgroundColor: 'rgba(52, 152, 219, 0.2)', borderWidth: 2, tension: 0.4, fill: true }] }, options: getChartOptions('পাওয়ার ট্রেন্ড (W)')
    });
    const energyCtx = document.getElementById('energy-chart').getContext('2d');
    energyCharts.energyChart = new Chart(energyCtx, {
      type: 'bar', data: { labels: ['সকাল', 'দুপুর', 'বিকাল', 'রাত'], datasets: [{ label: 'এনার্জি (kWh)', data: [0, 0, 0, 0], backgroundColor: 'rgba(155, 89, 182, 0.7)', borderColor: 'rgba(155, 89, 182, 1)', borderWidth: 1 }] }, options: getChartOptions('এনার্জি কনজাম্পশন (kWh)')
    });
  }

  function getChartOptions(title) {
    return {
      responsive: true,
      plugins: { legend: { labels: { color: 'var(--text-color)' } } },
      scales: { x: { grid: { color: 'rgba(255, 255, 255, 0.1)' }, ticks: { color: 'var(--text-color)' } }, y: { grid: { color: 'rgba(255, 255, 255, 0.1)' }, ticks: { color: 'var(--text-color)' } } }
    };
  }

  // এনার্জি ডাটা আপডেট করার ফাংশন
  function updateEnergyData(data) {
    document.getElementById('voltage-value').innerHTML = data.voltage ? data.voltage.toFixed(2) + ' <span class="energy-unit">V</span>' : '-- V';
    document.getElementById('current-value').innerHTML = data.current ? data.current.toFixed(2) + ' <span class="energy-unit">A</span>' : '-- A';
    document.getElementById('power-value').innerHTML = data.power ? data.power.toFixed(2) + ' <span class="energy-unit">W</span>' : '-- W';
    document.getElementById('energy-value').innerHTML = data.energy ? data.energy.toFixed(2) + ' <span class="energy-unit">kWh</span>' : '-- kWh';
    document.getElementById('frequency-value').innerHTML = data.frequency ? data.frequency.toFixed(2) + ' <span class="energy-unit">Hz</span>' : '-- Hz';
    document.getElementById('power-factor-value').innerHTML = data.powerFactor ? data.powerFactor.toFixed(2) : '--';
    document.getElementById('active-power-value').innerHTML = data.activePower ? data.activePower.toFixed(2) + ' <span class="energy-unit">W</span>' : '-- W';
    document.getElementById('reactive-power-value').innerHTML = data.reactivePower ? data.reactivePower.toFixed(2) + ' <span class="energy-unit">VAR</span>' : '-- VAR';
    document.getElementById('units-value').innerHTML = data.units ? data.units.toFixed(2) + ' <span class="energy-unit">Units</span>' : '-- Units';
    document.getElementById('daily-cost-value').innerHTML = data.dailyCost ? data.dailyCost.toFixed(2) + ' <span class="energy-unit">BDT</span>' : '-- BDT';
    
    if (data.timestamp) {
      const timestampInMs = data.timestamp.toString().length === 10 ? data.timestamp * 1000 : data.timestamp;
      const date = new Date(timestampInMs);
      document.getElementById('timestamp-value').textContent = date.toLocaleString('bn-BD', {
        year: 'numeric', month: 'short', day: 'numeric',
        hour: '2-digit', minute: '2-digit'
      });
    } else {
      document.getElementById('timestamp-value').textContent = '--';
    }

    updateEnergyChartData(energyCharts.voltageChart, data.voltage);
    updateEnergyChartData(energyCharts.currentChart, data.current);
    updateEnergyChartData(energyCharts.powerChart, data.power);
    
    if(data.energy) {
      const hours = new Date().getHours();
      let period = (hours >= 6 && hours < 12) ? 0 : (hours >= 12 && hours < 16) ? 1 : (hours >= 16 && hours < 20) ? 2 : 3;
      energyCharts.energyChart.data.datasets[0].data[period] = data.energy;
      energyCharts.energyChart.update();
    }

    const timestamp = new Date().getTime();
    if(!historicalData[timestamp]) {
      historicalData[timestamp] = data;
      const cutoffTime = timestamp - (selectedTimeRange * 60 * 1000 * 2);
      Object.keys(historicalData).forEach(key => {
        if(parseInt(key) < cutoffTime) delete historicalData[key];
      });
      if(document.getElementById('page6').classList.contains('active')) {
          updateAdvancedChart();
      }
    }
  }

  function updateEnergyChartData(chart, newValue) {
    if(!newValue || !chart) return;
    chart.data.labels.push('');
    if(chart.data.labels.length > 12) chart.data.labels.shift();
    chart.data.datasets[0].data.push(newValue);
    if(chart.data.datasets[0].data.length > 12) chart.data.datasets[0].data.shift();
    chart.update();
  }


  function loadEnergyData() {
    database.ref('energymonitoring').on('value', (snapshot) => {    
      const data = snapshot.val();
      if(data) updateEnergyData(data);
    });
  }

  function loadDataRealtime() {
    for(let deviceNum = 1; deviceNum <= 4; deviceNum++) {
      const devicePath = 'devices/device' + deviceNum;
      const deviceKey = 'device' + deviceNum;
      
      database.ref(devicePath).on('value', snapshot => {
        const data = snapshot.val();
        if(data) {
          let activeCount = 0, inactiveCount = 0, warningCount = 0;
          for(let loadNum = 1; loadNum <= 16; loadNum++) {
            const key = 'Load' + loadNum;
            const value = data[key] !== undefined ? data[key] : 0;
            const el = document.getElementById(`d${deviceNum}-load${loadNum}`);
            if(el) el.innerText = value === 1 ? 'ON' : value === 2 ? 'WARN' : 'OFF';
            
            const statusEl = document.getElementById(`d${deviceNum}-load${loadNum}-status`);
            if(statusEl) {
              if(value === 1) {
                statusEl.textContent = 'এক্টিভ';
                statusEl.className = 'card-status status-active';
                activeCount++;
              } else if(value === 2) {
                statusEl.textContent = 'সতর্কতা';
                statusEl.className = 'card-status status-warning';
                warningCount++;
              } else {
                statusEl.textContent = 'ইনএক্টিভ';
                statusEl.className = 'card-status status-inactive';
                inactiveCount++;
              }
            }
          }
          
          document.getElementById(`d${deviceNum}-active-count`).textContent = activeCount;
          document.getElementById(`d${deviceNum}-inactive-count`).textContent = inactiveCount;
          document.getElementById(`d${deviceNum}-warning-count`).textContent = warningCount;
          
          if(deviceCharts[deviceKey]) {
            deviceCharts[deviceKey].data.datasets[0].data = [activeCount, warningCount, inactiveCount];
            deviceCharts[deviceKey].update();
          }
        }
      });
    }
  }
  
  // টগল সুইচের স্ট্যাটাস লোড করার ফাংশন
  function loadRelayStates() {
    for(let i = 1; i <= 8; i++) {
        const relayName = 'relay' + i;
        database.ref('devices/device1/' + relayName).on('value', snapshot => {
            const state = snapshot.val();
            const toggle = document.getElementById('d1-' + relayName + '-toggle');
            if (toggle) toggle.checked = !!state;
        });
    }
    for(let i = 1; i <= 5; i++) {
        const relayName = 'relay' + i;
        database.ref('devices/device2/' + relayName).on('value', snapshot => {
            const state = snapshot.val();
            const toggle = document.getElementById('d2-' + relayName + '-toggle');
            if (toggle) toggle.checked = !!state;
        });
    }
    for(let i = 1; i <= 1; i++) {
        const relayName = 'relay' + i;
        database.ref('devices/device3/' + relayName).on('value', snapshot => {
            const state = snapshot.val();
            const toggle = document.getElementById('d3-' + relayName + '-toggle');
            if (toggle) toggle.checked = !!state;
        });
    }
  }

  // --- রিলে অপারেশনের জন্য পাসওয়ার্ড ফাংশন ---
  function promptForRelayPassword(device, relay, element) {
    const currentState = !element.checked;
    element.checked = currentState; 
    relayOperationContext = { device, relay, element, targetState: !currentState };
    document.getElementById('relayPasswordModal').style.display = 'flex';
    document.getElementById('relayPasswordInput').focus();
    document.getElementById('relayPasswordError').innerText = '';
  }

  function verifyAndOperateRelay() {
    const inputPassword = document.getElementById('relayPasswordInput').value;
    if (inputPassword === correctOperatingPassword) {
      if (relayOperationContext) {
        const { device, relay, element, targetState } = relayOperationContext;
        element.checked = targetState;
        controlRelay(device, relay, element);
        closeRelayModal();
      }
    } else {
      const errorEl = document.getElementById('relayPasswordError');
      errorEl.innerText = '❌ ভুল পাসওয়ার্ড!';
      const modalBox = document.querySelector('#relayPasswordModal .password-modal-box');
      modalBox.style.animation = 'shake 0.5s ease-in-out';
      setTimeout(() => { modalBox.style.animation = ''; }, 500);
    }
    document.getElementById('relayPasswordInput').value = '';
  }

  function cancelRelayOperation() {
    closeRelayModal();
  }

  function closeRelayModal() {
    document.getElementById('relayPasswordModal').style.display = 'none';
    document.getElementById('relayPasswordInput').value = '';
    relayOperationContext = null;
  }
  
  // --- টাইমার ফাংশন ---
  
  // ফায়ারবেস থেকে তারিখ ও সময় লোড করে UI তে দেখানোর ফাংশন
  function loadDateTimeData() {
      database.ref('devices/device1').on('value', (snapshot) => {
          const data = snapshot.val();
          if(data && data.currentDate && data.currentTime) {
              const dateElements = document.querySelectorAll('#page8 .current-date');
              const timeElements = document.querySelectorAll('#page8 .current-time');
              dateElements.forEach(el => el.textContent = `📅 ${data.currentDate}`);
              timeElements.forEach(el => el.textContent = `⏰ ${data.currentTime}`);
          }
      });
  }

  // ফায়ারবেস থেকে সব টাইমারের ডেটা লোড করার ফাংশন
  function loadTimersData() {
      database.ref('timers').on('value', (snapshot) => {
          allTimersData = snapshot.val() || {};
          updateAllTimerDisplays();
      });
  }
  
  // টাইমার স্ট্যাটাস এবং কাউন্টডাউন UI তে আপডেট করার ফাংশন
  function updateAllTimerDisplays() {
      for (const relayKey in allTimersData) {
          const timerData = allTimersData[relayKey];
          const statusElement = document.getElementById(`timer-status-${relayKey}`);
          if (statusElement) {
              if (timerData.enabled) {
                  const countdown = calculateCountdown(timerData.online, timerData.offline);
                  statusElement.innerHTML = `টাইমার সক্রিয়। ${countdown.nextState} ${countdown.timeLeft} পর।`;
              } else {
                  statusElement.textContent = 'টাইমার নিষ্ক্রিয় আছে।';
              }
          }
      }
  }
  
  // কাউন্টডাউন হিসাব করার ফাংশন
  function calculateCountdown(onlineTimeStr, offlineTimeStr) {
      const now = new Date();
      const onlineTime = new Date(now.toDateString() + ' ' + onlineTimeStr);
      const offlineTime = new Date(now.toDateString() + ' ' + offlineTimeStr);

      let nextEvent, nextState;

      if (onlineTime < offlineTime) { // স্বাভাবিক ক্রম: দিনে অন, রাতে অফ
          if (now >= onlineTime && now < offlineTime) {
              nextEvent = offlineTime;
              nextState = 'অফ হবে';
          } else {
              nextEvent = now < onlineTime ? onlineTime : new Date(onlineTime.getTime() + 24 * 60 * 60 * 1000);
              nextState = 'অন হবে';
          }
      } else { // বিপরীত ক্রম: রাতে অন, দিনে অফ
          if (now >= offlineTime && now < onlineTime) {
              nextEvent = onlineTime;
              nextState = 'অন হবে';
          } else {
              nextEvent = now < offlineTime ? offlineTime : new Date(offlineTime.getTime() + 24 * 60 * 60 * 1000);
              nextState = 'অফ হবে';
          }
      }

      const diff = nextEvent - now;
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);

      return {
          timeLeft: `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`,
          nextState: nextState
      };
  }

  // টাইমার মোডাল খোলার ফাংশন
  function openTimerModal(relayKey) {
      timerOperationContext = relayKey;
      const timerData = allTimersData[relayKey] || {};
      
      document.getElementById('timer-modal-title').textContent = `${relayKey.toUpperCase()} - টাইমার সেটিংস`;
      document.getElementById('timer-online-time').value = timerData.online || '00:00:00';
      document.getElementById('timer-offline-time').value = timerData.offline || '00:00:00';
      document.getElementById('timer-relay-select').value = timerData.relay || 'relay1';

      const enabledBtn = document.getElementById('timer-enabled-btn');
      updateEnabledButton(enabledBtn, !!timerData.enabled);

      document.getElementById('timerModal').style.display = 'flex';
  }

  // মোডালের 'enabled' বাটন আপডেট করার ফাংশন
  function updateEnabledButton(btn, isEnabled) {
      btn.textContent = isEnabled ? 'সক্রিয়' : 'নিষ্ক্রিয়';
      btn.classList.toggle('enabled', isEnabled);
      btn.classList.toggle('disabled', !isEnabled);
  }

  // মোডালের 'enabled' বাটন টগল করার ফাংশন
  function toggleTimerEnabled() {
      const btn = document.getElementById('timer-enabled-btn');
      const isCurrentlyEnabled = btn.classList.contains('enabled');
      updateEnabledButton(btn, !isCurrentlyEnabled);
  }

  // টাইমার মোডাল বন্ধ করার ফাংশন
  function closeTimerModal() {
      document.getElementById('timerModal').style.display = 'none';
      document.getElementById('timerPasswordInput').value = '';
      document.getElementById('timerPasswordError').textContent = '';
      timerOperationContext = null;
  }

  // টাইমারের সেটিংস সংরক্ষণ করার ফাংশন
  function saveTimerSettings() {
      const password = document.getElementById('timerPasswordInput').value;
      if (password !== correctOperatingPassword) {
          const errorEl = document.getElementById('timerPasswordError');
          errorEl.textContent = '❌ ভুল অপারেটিং পাসওয়ার্ড!';
          const modalBox = document.querySelector('#timerModal .timer-modal-box');
          modalBox.style.animation = 'shake 0.5s ease-in-out';
          setTimeout(() => { modalBox.style.animation = ''; }, 500);
          return;
      }
      
      if (timerOperationContext) {
          const updates = {
              enabled: document.getElementById('timer-enabled-btn').classList.contains('enabled'),
              online: document.getElementById('timer-online-time').value,
              offline: document.getElementById('timer-offline-time').value,
              relay: document.getElementById('timer-relay-select').value
          };
          
          database.ref('timers/' + timerOperationContext).update(updates)
              .then(() => {
                  console.log('Timer settings saved successfully!');
                  closeTimerModal();
              })
              .catch(error => {
                  console.error('Error saving timer settings: ', error);
                  document.getElementById('timerPasswordError').textContent = 'ত্রুটি: সংরক্ষণ করা যায়নি।';
              });
      }
  }


  function initAdvancedEnergyChart() {
    const ctx = document.getElementById('advanced-energy-chart').getContext('2d');
    if (advancedEnergyChart) {
        advancedEnergyChart.destroy();
    }
    advancedEnergyChart = new Chart(ctx, {
      type: 'line', data: { labels: [], datasets: [{ label: 'ভোল্টেজ (V)', data: [], borderColor: 'rgba(230, 126, 34, 1)', backgroundColor: 'rgba(230, 126, 34, 0.2)', borderWidth: 2, tension: 0.4, fill: true }] },
      options: getChartOptions('Advanced Trend')
    });
  }

  function changeTimeRange(minutes) {
    selectedTimeRange = minutes;
    document.querySelectorAll('.time-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    updateAdvancedChart();
  }

  function selectMetric(metric) {
    selectedMetric = metric;
    document.querySelectorAll('.metric-card').forEach(card => card.classList.remove('selected'));
    event.target.closest('.metric-card').classList.add('selected');
    updateAdvancedChart();
  }

  function getMetricName(metric) {
    const names = { 'voltage': 'ভোল্টেজ', 'current': 'কারেন্ট', 'power': 'পাওয়ার', 'energy': 'এনার্জি', 'frequency': 'ফ্রিকোয়েন্সি', 'powerFactor': 'পাওয়ার ফ্যাক্টর', 'activePower': 'অ্যাক্টিভ পাওয়ার', 'reactivePower': 'রিঅ্যাক্টিভ পাওয়ার' };
    return names[metric] || metric;
  }

  function getTimeRangeText(minutes) {
    if(minutes < 60) return `${minutes} মিনিট`;
    return `${Math.floor(minutes/60)} ঘন্টা`;
  }

  function updateAdvancedChart() {
    if(!advancedEnergyChart) return;
    const now = new Date().getTime();
    const cutoffTime = now - (selectedTimeRange * 60 * 1000);
    const timestamps = Object.keys(historicalData).filter(ts => parseInt(ts) >= cutoffTime).sort();
    
    const labels = timestamps.map(ts => new Date(parseInt(ts)).toLocaleTimeString('bn-BD'));
    const data = timestamps.map(ts => historicalData[ts][selectedMetric]);
    
    document.getElementById('advanced-graph-title').textContent = `${getMetricName(selectedMetric)} ট্রেন্ড (${getTimeRangeText(selectedTimeRange)})`;
    advancedEnergyChart.data.labels = labels;
    advancedEnergyChart.data.datasets[0].data = data;
    advancedEnergyChart.data.datasets[0].label = `${getMetricName(selectedMetric)} (${getUnit(selectedMetric)})`;
    advancedEnergyChart.update();
    
    document.getElementById('no-data-message').style.display = data.length === 0 ? 'block' : 'none';
  }

  function getUnit(metric) {
    const units = { 'voltage': 'V', 'current': 'A', 'power': 'W', 'energy': 'kWh', 'frequency': 'Hz', 'powerFactor': '', 'activePower': 'W', 'reactivePower': 'VAR' };
    return units[metric] || '';
  }

  function loadHistoricalData() {
    database.ref('energyHistory').limitToLast(1000).on('value', (snapshot) => {
      const data = snapshot.val();
      if(data) {
        historicalData = data;
        updateAdvancedChart();
      }
    });
  }

  function downloadGraphData() {
    const timestamps = Object.keys(historicalData).sort();
    let csvContent = "data:text/csv;charset=utf-8,সময়,ভোল্টেজ (V),কারেন্ট (A),পাওয়ার (W),এনার্জি (kWh),ফ্রিকোয়েন্সি (Hz),পাওয়ার ফ্যাক্টর,অ্যাক্টিভ পাওয়ার (W),রিঅ্যাক্টিভ পাওয়ার (VAR)\n";
    
    timestamps.forEach(ts => {
      const data = historicalData[ts];
      const row = [ new Date(parseInt(ts)).toLocaleString(), data.voltage || '', data.current || '', data.power || '', data.energy || '', data.frequency || '', data.powerFactor || '', data.activePower || '', data.reactivePower || '' ];
      csvContent += row.join(",") + "\n";
    });
    
    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", `energy_data_${new Date().toLocaleDateString()}.csv`);
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }

  function printGraph() {
    const canvas = document.getElementById('advanced-energy-chart');
    const win = window.open('', 'Print Chart');
    win.document.write(`<html><head><title>Print Chart</title></head><body><h1>${document.getElementById('advanced-graph-title').textContent}</h1><img src="${canvas.toDataURL()}"/></body></html>`);
    win.document.close();
    win.focus();
    setTimeout(() => { win.print(); win.close(); }, 500);
  }

  // এন্টার কী প্রেস ইভেন্ট লিসেনার
  document.getElementById("password").addEventListener("keypress", function(event) {
    if (event.key === "Enter") checkPassword();
  });
  document.getElementById("relayPasswordInput").addEventListener("keypress", function(event) {
    if (event.key === "Enter") verifyAndOperateRelay();
  });
  document.getElementById("timerPasswordInput").addEventListener("keypress", function(event) {
    if (event.key === "Enter") saveTimerSettings();
  });

  window.onload = function() {
    createParticles();
  };
</script>
</body>
</html>
```
